(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{pKmL:function(t,e,n){"use strict";n.r(e),n.d(e,"CoreModule",function(){return sv});var r=n("ofXK"),i=n("tyNb"),o=n("XNiG"),s=n("fXoL"),u=n("+Rhh"),a=n("99NH"),c=n("l7P3");const h=Object(c.o)("myRouter"),{selectQueryParam:l,selectRouteParam:f}=a.b(h);var p=n("Q3uk");const d={EntitiesOnly:0,Both:1,None:2};function b(t){return function(e,n){const r={ids:[...n.ids],entities:Object.assign({},n.entities)},i=t(e,r);return i===d.Both?Object.assign({},n,r):i===d.EntitiesOnly?Object.assign(Object.assign({},n),{entities:r.entities}):n}}function v(t,e){const n=e(t);return Object(s.Y)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),n}function g(t){function e(e,n){const r=v(e,t);return r in n.entities?d.None:(n.ids.push(r),n.entities[r]=e,d.Both)}function n(t,n){let r=!1;for(const i of t)r=e(i,n)!==d.None||r;return r?d.Both:d.None}function r(t,e){return e.ids=[],e.entities={},n(t,e),d.Both}function i(t,e){const n=(t instanceof Array?t:e.ids.filter(n=>t(e.entities[n]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return n&&(e.ids=e.ids.filter(t=>t in e.entities)),n?d.Both:d.None}function o(t,e){return s([t],e)}function s(e,n){const r={};return(e=e.filter(t=>t.id in n.entities)).length>0?e.filter(e=>function(e,n,r){const i=Object.assign({},r.entities[n.id],n.changes),o=v(i,t),s=o!==n.id;return s&&(e[n.id]=o,delete r.entities[n.id]),r.entities[o]=i,s}(r,e,n)).length>0?(n.ids=n.ids.map(t=>r[t]||t),d.Both):d.EntitiesOnly:d.None}function u(e,r){const i=[],o=[];for(const n of e){const e=v(n,t);e in r.entities?o.push({id:e,changes:n}):i.push(n)}const u=s(o,r),a=n(i,r);switch(!0){case a===d.None&&u===d.None:return d.None;case a===d.Both||u===d.Both:return d.Both;default:return d.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:b(e),addMany:b(n),addAll:b(r),setAll:b(r),setOne:b(function(e,n){const r=v(e,t);return r in n.entities?(n.entities[r]=e,d.EntitiesOnly):(n.ids.push(r),n.entities[r]=e,d.Both)}),updateOne:b(o),updateMany:b(s),upsertOne:b(function(t,e){return u([t],e)}),upsertMany:b(u),removeOne:b(function(t,e){return i([t],e)}),removeMany:b(i),map:b(function(t,e){return s(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]).filter(({id:t})=>t in e.entities),e)}),mapOne:b(function({map:t,id:e},n){const r=n.entities[e];return r?o({id:e,changes:t(r)},n):d.None})}}d[d.EntitiesOnly]="EntitiesOnly",d[d.Both]="Both",d[d.None]="None";const y=function(t={}){const{selectId:e,sortComparer:n}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),r={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},i={getSelectors:function(t){const e=t=>t.ids,n=t=>t.entities,r=Object(c.q)(e,n,(t,e)=>t.map(t=>e[t])),i=Object(c.q)(e,t=>t.length);return t?{selectIds:Object(c.q)(t,e),selectEntities:Object(c.q)(t,n),selectAll:Object(c.q)(t,r),selectTotal:Object(c.q)(t,i)}:{selectIds:e,selectEntities:n,selectAll:r,selectTotal:i}}},o=n?function(t,e){const{removeOne:n,removeMany:r,removeAll:i}=g(t);function o(t,e){return s([t],e)}function s(e,n){const r=e.filter(e=>!(v(e,t)in n.entities));return 0===r.length?d.None:(l(r,n),d.Both)}function u(t,e){return e.entities={},e.ids=[],s(t,e),d.Both}function a(t,e){return c([t],e)}function c(e,n){const r=[],i=e.filter(e=>function(e,n,r){if(!(n.id in r.entities))return!1;const i=Object.assign({},r.entities[n.id],n.changes),o=v(i,t);return delete r.entities[n.id],e.push(i),o!==n.id}(r,e,n)).length>0;if(0===r.length)return d.None;{const t=n.ids,e=[];return n.ids=n.ids.filter((t,r)=>t in n.entities||(e.push(r),!1)),l(r,n),!i&&e.every(e=>n.ids[e]===t[e])?d.EntitiesOnly:d.Both}}function h(e,n){const r=[],i=[];for(const s of e){const e=v(s,t);e in n.entities?i.push({id:e,changes:s}):r.push(s)}const o=c(i,n),u=s(r,n);switch(!0){case u===d.None&&o===d.None:return d.None;case u===d.Both||o===d.Both:return d.Both;default:return d.EntitiesOnly}}function l(n,r){n.sort(e);const i=[];let o=0,s=0;for(;o<n.length&&s<r.ids.length;){const u=n[o],a=v(u,t),c=r.ids[s];e(u,r.entities[c])<=0?(i.push(a),o++):(i.push(c),s++)}r.ids=i.concat(o<n.length?n.slice(o).map(t):r.ids.slice(s)),n.forEach((e,n)=>{r.entities[t(e)]=e})}return{removeOne:n,removeMany:r,removeAll:i,addOne:b(o),updateOne:b(a),upsertOne:b(function(t,e){return h([t],e)}),addAll:b(u),setAll:b(u),setOne:b(function(e,n){const r=v(e,t);return r in n.entities?(n.ids=n.ids.filter(t=>t!==r),l([e],n),d.Both):o(e,n)}),addMany:b(s),updateMany:b(c),upsertMany:b(h),map:b(function(t,e){return c(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]),e)}),mapOne:b(function({map:t,id:e},n){const r=n.entities[e];return r?a({id:e,changes:t(r)},n):d.None})}}(e,n):g(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:n},r),i),o)}({selectId:function(t){return t.id}}),m=y.getInitialState({loading:!1,fbError:!1,allIssuesLastFetched:0}),w=Object(c.p)(m,Object(c.r)(p.g,(t,{data:e})=>y.addOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.h,(t,{data:e})=>y.updateOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.f,(t,{data:e,errMsg:n})=>y.removeOne(e.id,Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.e,t=>Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null})),Object(c.r)(p.d,(t,{errorMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:e})),Object(c.r)(p.p,(t,{searchTerm:e,showLoadMask:n})=>{let r;return r=n,Object.assign(Object.assign({},t),{issuesRefreshingLoading:r,searchTerm:e,loading:!0,fbError:!1,fbErrorMsg:null})}),Object(c.r)(p.q,(t,{data:e,updatedTime:n})=>y.setAll(e,Object.assign(Object.assign({},t),{allIssuesLastFetched:n,issuesRefreshingLoading:!1,loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.o,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{issuesRefreshingLoading:!1,loading:!1,fbError:!0,fbErrorMsg:e})),Object(c.r)(p.b,(t,{data:e})=>y.updateOne({id:e.id,changes:{open:!1,loading:!0}},Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.c,(t,{data:e})=>y.updateOne({id:e.id,changes:{loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.a,(t,{data:e,errMsg:n})=>y.updateOne({id:e.id,changes:{open:!0,loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.s,(t,{data:e})=>y.updateOne({id:e.id,changes:{open:!0,loading:!0}},Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.t,(t,{data:e})=>y.updateOne({id:e.id,changes:{loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.r,(t,{data:e,errMsg:n})=>y.updateOne({id:e.id,changes:{open:!1,loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.v,(t,{issueId:e})=>Object.assign(Object.assign({},t),{selectedIssueId:e})),Object(c.r)(p.w,(t,{inEditMode:e})=>Object.assign(Object.assign({},t),{issueEditMode:e})),Object(c.r)(p.j,(t,{issue:e})=>(console.log(e),y.removeOne(e.id,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null})))),Object(c.r)(p.k,(t,{})=>Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null})),Object(c.r)(p.i,(t,{issue:e,errMsg:n})=>y.addOne(e,Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.m,(t,{updates:e})=>y.updateOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.n,(t,{issue:e})=>{const n={id:e.id+"",changes:Object.assign(Object.assign({},e.changes),{loading:!1})};return y.updateOne(n,Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))}),Object(c.r)(p.u,(t,{time:e})=>Object.assign(Object.assign({},t),{lastRefreshAllRequest:e})));function O(t,e){return w(t,e)}const I=Object(c.o)("issues"),E=(Object(c.q)(I,y.getSelectors().selectIds),Object(c.q)(I,y.getSelectors().selectEntities)),_=Object(c.q)(I,y.getSelectors().selectAll),T=Object(c.q)(I,y.getSelectors().selectTotal),j=(Object(c.q)(I,t=>t.ids?t.ids.length:0),t=>Object(c.q)(E,e=>t?e[t]:void 0)),C=Object(c.q)(_,t=>t.reduce((t,e)=>{let n=t;return e.open&&(n+=1),n},0)),A=Object(c.q)(T,C,(t,e)=>t-e),N=Object(c.q)(I,t=>t.loading),k=Object(c.q)(I,t=>t.selectedIssueId),D=Object(c.q)(k,E,(t,e)=>{if(t)return e[t]}),x=Object(c.q)(I,t=>t.issueEditMode),P=Object(c.q)(I,t=>t.lastRefreshAllRequest),S=Object(c.q)(I,t=>t.issuesRefreshingLoading),M=Object(c.q)(I,t=>t.searchTerm&&""===t.searchTerm.trim()?null:t.searchTerm),R="issues";let U=(()=>{class t{constructor(t,e,n){this.store=t,this.router=e,this.route=n,this.getQueryParamById$=this.store.select(l("newIssuePane")),this.getAllIssues$=this.store.select(_),this.openIssueCount$=this.store.select(C),this.closedIssueCount$=this.store.select(A),this.totalIssueCount$=this.store.select(T),this.getIssueCounterNumber=t=>this.store.select((t=>Object(c.q)(j(t),t=>null==t?void 0:t.issueNumber))(t)),this.getIssueById=t=>this.store.select(j(t)),this.getIssueByParamId=t=>this.store.select((t=>Object(c.q)(f(t),E,(t,e)=>{if(t)return e[t]}))(t)),this.getIssueBySelectedId$=this.store.select(D),this.issueOverallLoading$=this.store.select(N),this.getIssueEditMode$=this.store.select(x),this.refreshAllIssuesRequest$=this.store.select(P),this.issuesRefreshLoading$=this.store.select(S),this.getUserSearchTerm$=this.store.select(M),this.currentIssueCounter=1,this.totalIssueCount$.subscribe(t=>{this.currentIssueCounter=t+1}),this.refreshAllIssuesRequest$.subscribe(t=>{t&&(console.log("refreshing all issues:",t),this.getAllIssues(null,!0))})}toggleNewIssuePane(t){this.store.dispatch(u.a({open:t}))}getAllIssues(t,e=!1){this.store.dispatch(p.p({url:R,searchTerm:t,showLoadMask:e}))}toggleOpenCloseIssue(t){this.store.dispatch(t.open?p.b({data:t}):p.s({data:t}))}setSelectedIssueId(t){this.store.dispatch(p.v({issueId:t}))}toggleIssueEditMode(t){this.store.dispatch(p.w({inEditMode:t}))}deleteIssue(t,e){this.store.dispatch(p.j({issue:t,url:e}))}goBackToIssuesPage(){this.router.navigate(["/","issues"])}goToIssueDetailView(t){this.router.navigate(["/issues",t])}editIssue(t,e){this.store.dispatch(p.m({updates:t,url:"issues/"+t.id,issue:e}))}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(c.h),s.Yb(i.f),s.Yb(i.a))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),L=(()=>{class t{constructor(t,e,n,r){this.cs=t,this.router=e,this.route=n,this.store=r,this.compDest$=new o.a}ngOnInit(){this.cs.getAllIssues(null,!0)}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(U),s.Ob(i.f),s.Ob(i.a),s.Ob(c.h))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core"]],decls:2,vars:0,consts:[[1,"container","mb-3"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Pb(1,"router-outlet"),s.Tb())},directives:[i.j],styles:[""]}),t})();var V=n("1G5W"),q=n("ooqH"),F=n("0IaG"),B=n("bTqV");let z=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}ngOnInit(){}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(F.f),s.Ob(F.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-shared-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,e){1&t&&(s.Ub(0,"h1",0),s.Ec(1,"Confirmation"),s.Tb(),s.Ub(2,"div",1),s.Ub(3,"p"),s.Ec(4),s.Tb(),s.Tb(),s.Ub(5,"div",2),s.Ub(6,"button",3),s.bc("click",function(){return e.onNoClick()}),s.Ec(7,"No"),s.Tb(),s.Ub(8,"button",4),s.bc("click",function(){return e.onYesClick()}),s.Ec(9,"Yes"),s.Tb(),s.Tb()),2&t&&(s.Cb(4),s.Gc("Are you sure you want to ",null==e.data?null:e.data.actionName,""))},directives:[F.g,F.d,F.c,B.a],styles:[""]}),t})();var G=n("D0XW"),K=n("HDdC"),$=n("Cfvw"),W=n("LRne"),Y=n("lJxs"),H=n("Kqap"),Q=n("pLZG"),X=n("pxpQ"),J=n("spgP"),Z=n("30Go"),tt=n("zIRd"),et=n("q/0M"),nt=n("qOnz"),rt=function(t,e){return(rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function it(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var ot,st="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ut=ut||{},at=st||self;function ct(){}function ht(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function lt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ft="closure_uid_"+(1e9*Math.random()>>>0),pt=0;function dt(t,e,n){return t.call.apply(t.bind,arguments)}function bt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function vt(t,e,n){return(vt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?dt:bt).apply(null,arguments)}function gt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function yt(){return Date.now()}function mt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function wt(){this.j=this.j,this.i=this.i}wt.prototype.j=!1,wt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ft)&&t[ft]||(t[ft]=++pt)}(this)},wt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Ot=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},It=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Et(t){return Array.prototype.concat.apply([],arguments)}function _t(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Tt(t){return/^[\s\xa0]*$/.test(t)}var jt,Ct=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function At(t,e){return-1!=t.indexOf(e)}function Nt(t,e){return t<e?-1:t>e?1:0}t:{var kt=at.navigator;if(kt){var Dt=kt.userAgent;if(Dt){jt=Dt;break t}}jt=""}function xt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Pt(t){var e={};for(var n in t)e[n]=t[n];return e}var St="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<St.length;o++)n=St[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Rt(t){return Rt[" "](t),t}Rt[" "]=ct;var Ut,Lt,Vt=At(jt,"Opera"),qt=At(jt,"Trident")||At(jt,"MSIE"),Ft=At(jt,"Edge"),Bt=Ft||qt,zt=At(jt,"Gecko")&&!(At(jt.toLowerCase(),"webkit")&&!At(jt,"Edge"))&&!(At(jt,"Trident")||At(jt,"MSIE"))&&!At(jt,"Edge"),Gt=At(jt.toLowerCase(),"webkit")&&!At(jt,"Edge");function Kt(){var t=at.document;return t?t.documentMode:void 0}t:{var $t="",Wt=(Lt=jt,zt?/rv:([^\);]+)(\)|;)/.exec(Lt):Ft?/Edge\/([\d\.]+)/.exec(Lt):qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Lt):Gt?/WebKit\/(\S+)/.exec(Lt):Vt?/(?:Version)[ \/]?(\S+)/.exec(Lt):void 0);if(Wt&&($t=Wt?Wt[1]:""),qt){var Yt=Kt();if(null!=Yt&&Yt>parseFloat($t)){Ut=String(Yt);break t}}Ut=$t}var Ht={};function Qt(t){return function(t,e){var n=Ht;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Ct(String(Ut)).split("."),r=Ct(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Nt(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Nt(0==s[2].length,0==u[2].length)||Nt(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var Xt=at.document&&qt&&(Kt()||parseInt(Ut,10))||void 0,Jt=!qt||9<=Number(Xt),Zt=qt&&!Qt("9"),te=function(){if(!at.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{at.addEventListener("test",ct,e),at.removeEventListener("test",ct,e)}catch(n){}return t}();function ee(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ne(t,e){if(ee.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(zt){t:{try{Rt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:re[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ee.prototype.b=function(){this.defaultPrevented=!0},mt(ne,ee);var re={2:"touch",3:"pen",4:"mouse"};ne.prototype.b=function(){ne.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Zt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var ie="closure_listenable_"+(1e6*Math.random()|0),oe=0;function se(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++oe,this.Y=this.Z=!1}function ue(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ae(t){this.src=t,this.a={},this.b=0}function ce(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Ot(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ue(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function he(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ae.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=he(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new se(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var le="closure_lm_"+(1e6*Math.random()|0),fe={};function pe(t,e,n,r,i){if(r&&r.once)return be(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)pe(t,e[o],n,r,i);return null}return n=Ee(n),t&&t[ie]?t.va(e,n,lt(r)?!!r.capture:!!r,i):de(t,e,n,!1,r,i)}function de(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=lt(i)?!!i.capture:!!i;if(s&&!Jt)return null;var u=Oe(t);if(u||(t[le]=u=new ae(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=we,e=Jt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)te||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ye(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function be(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)be(t,e[o],n,r,i);return null}return n=Ee(n),t&&t[ie]?t.wa(e,n,lt(r)?!!r.capture:!!r,i):de(t,e,n,!0,r,i)}function ve(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ve(t,e[o],n,r,i);else r=lt(r)?!!r.capture:!!r,n=Ee(n),t&&t[ie]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=he(o=t.a[e],n,r,i))&&(ue(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Oe(t))&&(e=t.a[e.toString()],t=-1,e&&(t=he(e,n,r,i)),(n=-1<t?e[t]:null)&&ge(n))}function ge(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ie])ce(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ye(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Oe(e))?(ce(n,t),0==n.b&&(n.src=null,e[le]=null)):ue(t)}}}function ye(t){return t in fe?fe[t]:fe[t]="on"+t}function me(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&ge(t),n.call(r,e)}function we(t,e){if(t.Y)return!0;if(!Jt){if(!e)t:{e=["window","event"];for(var n=at,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return me(t,e=new ne(e,this))}return me(t,new ne(e,this))}function Oe(t){return(t=t[le])instanceof ae?t:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(t){return"function"==typeof t?t:(t[Ie]||(t[Ie]=function(e){return t.handleEvent(e)}),t[Ie])}function _e(){wt.call(this),this.c=new ae(this),this.J=this,this.C=null}function Te(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new ee(e,t);else if(e instanceof ee)e.target=e.target||t;else{var i=e;Mt(e=new ee(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=je(s,r,!0,e)&&i}if(i=je(s=e.a=t,r,!0,e)&&i,i=je(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=je(s=e.a=n[o],r,!1,e)&&i}function je(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&ce(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}mt(_e,wt),_e.prototype[ie]=!0,(ot=_e.prototype).addEventListener=function(t,e,n,r){pe(this,t,e,n,r)},ot.removeEventListener=function(t,e,n,r){ve(this,t,e,n,r)},ot.G=function(){if(_e.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ue(n[r]);delete e.a[t],e.b--}}this.C=null},ot.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ot.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ce=at.JSON.stringify;function Ae(){this.b=this.a=null}var Ne,ke=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new xe},function(t){t.reset()});function De(){var t=Re,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function xe(){this.next=this.b=this.a=null}function Pe(t){at.setTimeout(function(){throw t},0)}function Se(t,e){Ne||function(){var t=at.Promise.resolve(void 0);Ne=function(){t.then(Ue)}}(),Me||(Ne(),Me=!0),Re.add(t,e)}Ae.prototype.add=function(t,e){var n=ke.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},xe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},xe.prototype.reset=function(){this.next=this.b=this.a=null};var Me=!1,Re=new Ae;function Ue(){for(var t;t=De();){try{t.a.call(t.b)}catch(n){Pe(n)}var e=ke;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Me=!1}function Le(t,e){_e.call(this),this.b=t||1,this.a=e||at,this.f=vt(this.Za,this),this.g=yt()}function Ve(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function qe(t,e,n){if("function"==typeof t)n&&(t=vt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=vt(t.handleEvent,t)}return 2147483647<Number(e)?-1:at.setTimeout(t,e||0)}function Fe(t){t.a=qe(function(){t.a=null,t.c&&(t.c=!1,Fe(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}mt(Le,_e),(ot=Le.prototype).aa=!1,ot.M=null,ot.Za=function(){if(this.aa){var t=yt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Te(this,"tick"),this.aa&&(Ve(this),this.start()))}},ot.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=yt())},ot.G=function(){Le.X.G.call(this),Ve(this),delete this.a};var Be=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}rt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Fe(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(at.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(wt);function ze(t){wt.call(this),this.b=t,this.a={}}mt(ze,wt);var Ge=[];function Ke(t,e,n,r){Array.isArray(n)||(n&&(Ge[0]=n.toString()),n=Ge);for(var i=0;i<n.length;i++){var o=pe(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function $e(t){xt(t.a,function(t,e){this.a.hasOwnProperty(e)&&ge(t)},t),t.a={}}function We(){this.a=!0}function Ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ce(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}ze.prototype.G=function(){ze.X.G.call(this),$e(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},We.prototype.info=function(){};var He={},Qe=null;function Xe(){return Qe=Qe||new _e}function Je(t){ee.call(this,He.Fa,t)}function Ze(t){var e=Xe();Te(e,new Je(e,t))}function tn(t,e){ee.call(this,He.STAT_EVENT,t),this.stat=e}function en(t){var e=Xe();Te(e,new tn(e,t))}function nn(t){ee.call(this,He.Ga,t)}function rn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return at.setTimeout(function(){t()},e)}He.Fa="serverreachability",mt(Je,ee),He.STAT_EVENT="statevent",mt(tn,ee),He.Ga="timingevent",mt(nn,ee);var on={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},sn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function un(){}function an(){}un.prototype.a=null;var cn,hn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ln(){ee.call(this,"d")}function fn(){ee.call(this,"c")}function pn(){}function dn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ze(this),this.P=bn,this.R=new Le(t=Bt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}mt(ln,ee),mt(fn,ee),mt(pn,un),cn=new pn;var bn=45e3,vn={},gn={};function yn(t,e,n){t.H=1,t.i=qn(Sn(e)),t.j=n,t.I=!0,mn(t,null)}function mn(t,e){t.u=yt(),In(t),t.l=Sn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Zn(n.b,"t",r),t.D=0,t.a=Wr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Be(vt(t.Ca,t,t.a),t.O)),Ke(t.J,t.a,"readystatechange",t.Xa),e=t.B?Pt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ze(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function wn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=On(t,n);if(i==gn){4==e&&(t.h=4,en(14),r=!1),Ye(t.c,t.f,null,"[Incomplete Response]");break}if(i==vn){t.h=4,en(15),Ye(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Ye(t.c,t.f,i,null),Cn(t,i)}4==e&&0==n.length&&(t.h=1,en(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vr(e),e.F=!0,en(11))):(Ye(t.c,t.f,n,"[Invalid Chunked Response]"),jn(t),Tn(t))}function On(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?gn:(n=Number(e.substring(n,r)),isNaN(n)?vn:(r+=1)+n>e.length?gn:(e=e.substr(r,n),t.D=r+n,e))}function In(t){t.T=yt()+t.P,En(t,t.P)}function En(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=rn(vt(t.Va,t),e)}function _n(t){t.o&&(at.clearTimeout(t.o),t.o=null)}function Tn(t){0==t.g.v||t.A||Br(t.g,t)}function jn(t){_n(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ve(t.R),$e(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Cn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||sr(n.b,t)))if(n.I=t.N,!t.C&&sr(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Up){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Fr(n),kr(n)}Lr(n),en(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=rn(vt(n.Sa,n),6e3));if(1>=or(n.b)&&n.ea){try{n.ea()}catch(Up){}n.ea=void 0}}else Gr(n,11)}else if((t.C||n.a==t)&&Fr(n),!Tt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=a.b;!l.a&&(At(h,"spdy")||At(h,"quic")||At(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(ur(l,l.b),l.b=null))}if(a.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(a.na=f,Vn(a.B,a.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=yt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=$r(a,a.C?a.ga:null,a.fa),p.C){ar(a.b,p);var d=p,b=a.D;b&&d.setTimeout(b),d.o&&(_n(d),In(d)),a.a=p}else Ur(a);0<n.g.length&&Pr(n)}else"stop"!=i[0]&&"close"!=i[0]||Gr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Gr(n,7):Nr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Ze(4)}catch(Up){}}function An(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ht(t)||"string"==typeof t)It(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(ht(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(ht(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Nn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Nn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function kn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Dn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ot=dn.prototype).setTimeout=function(t){this.P=t},ot.Xa=function(t){t=t.target;var e=this.F;e&&3==Tr(t)?e.f():this.Ca(t)},ot.Ca=function(t){try{if(t==this.a)t:{var e=Tr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Bt&&!this.a.$())){this.A||4!=e||7==n||Ze(8==n||0>=r?3:2),_n(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,en(12),jn(this),Tn(this);break t}Ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Cn(this,a)}this.I?(wn(this,e,o),Bt&&this.b&&3==e&&(Ke(this.J,this.R,"tick",this.Wa),this.R.start())):(Ye(this.c,this.f,o,null),Cn(this,o)),4==e&&jn(this),this.b&&!this.A&&(4==e?Br(this.g,this):(this.b=!1,In(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,en(12)):(this.h=0,en(13)),jn(this),Tn(this)}}}catch(c){}},ot.Wa=function(){if(this.a){var t=Tr(this.a),e=this.a.$();this.D<e.length&&(_n(this),wn(this,t,e),this.b&&4!=t&&In(this))}},ot.cancel=function(){this.A=!0,jn(this)},ot.Va=function(){this.o=null;var t=yt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Ze(3),en(17)),jn(this),this.h=2,Tn(this)):En(this,this.T-t)},(ot=Nn.prototype).K=function(){kn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ot.L=function(){return kn(this),this.a.concat()},ot.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},ot.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ot.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Pn){this.a=void 0!==e?e:t.a,Mn(this,t.f),this.j=t.j,Rn(this,t.c),Un(this,t.h),this.g=t.g,e=t.b;var n=new Hn;n.c=e.c,e.a&&(n.a=new Nn(e.a),n.b=e.b),Ln(this,n),this.i=t.i}else t&&(n=String(t).match(xn))?(this.a=!!e,Mn(this,n[1]||"",!0),this.j=Fn(n[2]||""),Rn(this,n[3]||"",!0),Un(this,n[4]),this.g=Fn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.i=Fn(n[7]||"")):(this.a=!!e,this.b=new Hn(null,this.a))}function Sn(t){return new Pn(t)}function Mn(t,e,n){t.f=n?Fn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Rn(t,e,n){t.c=n?Fn(e,!0):e}function Un(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ln(t,e,n){e instanceof Hn?(t.b=e,function(t,e){e&&!t.f&&(Qn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Xn(this,e),Zn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=Bn(e,Wn)),t.b=new Hn(e,t.a))}function Vn(t,e,n){t.b.set(e,n)}function qn(t){return Vn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^yt()).toString(36)),t}function Fn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,zn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function zn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Bn(e,Gn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Bn(e,Gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?$n:Kn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Bn(n,Yn)),t.join("")};var Gn=/[#\/\?@]/g,Kn=/[#\?:]/g,$n=/[#\?]/g,Wn=/[#\?@]/g,Yn=/#/g;function Hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Qn(t){t.a||(t.a=new Nn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Xn(t,e){Qn(t),e=tr(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Dn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&kn(t)))}function Jn(t,e){return Qn(t),e=tr(t,e),Dn(t.a.b,e)}function Zn(t,e,n){Xn(t,e),0<n.length&&(t.c=null,t.a.set(tr(t,e),_t(n)),t.b+=n.length)}function tr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ot=Hn.prototype).add=function(t,e){Qn(this),this.c=null,t=tr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ot.forEach=function(t,e){Qn(this),this.a.forEach(function(n,r){It(n,function(n){t.call(e,n,r,this)},this)},this)},ot.L=function(){Qn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ot.K=function(t){Qn(this);var e=[];if("string"==typeof t)Jn(this,t)&&(e=Et(e,this.a.get(tr(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Et(e,t[n])}return e},ot.set=function(t,e){return Qn(this),this.c=null,Jn(this,t=tr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ot.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ot.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var er=function(){return function(t,e){this.b=t,this.a=e}}();function nr(t){this.g=t||rr,t=at.PerformanceNavigationTiming?0<(t=at.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(at.ia&&at.ia.ya&&at.ia.ya()&&at.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var rr=10;function ir(t){return!!t.b||!!t.a&&t.a.size>=t.f}function or(t){return t.b?1:t.a?t.a.size:0}function sr(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function ur(t,e){t.a?t.a.add(e):t.b=e}function ar(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function cr(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=it(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return _t(t.c)}function hr(){}function lr(){this.a=new hr}function fr(t,e,n){var r=n||"";try{An(t,function(t,n){var i=t;lt(t)&&(i=Ce(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function pr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}nr.prototype.cancel=function(){var t,e;if(this.c=cr(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=it(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},hr.prototype.stringify=function(t){return at.JSON.stringify(t,void 0)},hr.prototype.parse=function(t){return at.JSON.parse(t,void 0)};var dr=at.JSON.parse;function br(t){_e.call(this),this.headers=new Nn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=vr,this.D=this.F=!1}mt(br,_e);var vr="",gr=/^https?$/i,yr=["POST","PUT"];function mr(t){return"content-type"==t.toLowerCase()}function wr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Or(t),Er(t)}function Or(t){t.u||(t.u=!0,Te(t,"complete"),Te(t,"error"))}function Ir(t){if(t.b&&void 0!==ut&&(!t.s[1]||4!=Tr(t)||2!=t.W()))if(t.l&&4==Tr(t))qe(t.za,0,t);else if(Te(t,"readystatechange"),4==Tr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(xn)[1]||null;if(!o&&at.self&&at.self.location){var s=at.self.location.protocol;o=s.substr(0,s.length-1)}i=!gr.test(o?o.toLowerCase():"")}e=i}if(e)Te(t,"complete"),Te(t,"success");else{t.h=6;try{var u=2<Tr(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Or(t)}}finally{Er(t)}}}function Er(t,e){if(t.a){_r(t);var n=t.a,r=t.s[0]?ct:null;t.a=null,t.s=null,e||Te(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function _r(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(at.clearTimeout(t.m),t.m=null)}function Tr(t){return t.a?t.a.readyState:0}function jr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return xt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Vn(t,e,n))}function Cr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ar(t){this.pa=0,this.g=[],this.c=new We,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Cr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Cr("baseRetryDelayMs",5e3,t),this.Ra=Cr("retryDelaySeedMs",1e4,t),this.Ma=Cr("forwardChannelMaxRetries",2,t),this.ma=Cr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new nr(t&&t.concurrentRequestLimit),this.ka=new lr,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Nr(t){if(Dr(t),3==t.v){var e=t.R++,n=Sn(t.B);Vn(n,"SID",t.J),Vn(n,"RID",e),Vn(n,"TYPE","terminate"),Mr(t,n),(e=new dn(t,t.c,e,void 0)).H=2,e.i=qn(Sn(n)),n=!1,at.navigator&&at.navigator.sendBeacon&&(n=at.navigator.sendBeacon(e.i.toString(),"")),!n&&at.Image&&((new Image).src=e.i,n=!0),n||(e.a=Wr(e.g,null),e.a.ba(e.i)),e.u=yt(),In(e)}Kr(t)}function kr(t){t.a&&(Vr(t),t.a.cancel(),t.a=null)}function Dr(t){kr(t),t.j&&(at.clearTimeout(t.j),t.j=null),Fr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&at.clearTimeout(t.h),t.h=null)}function xr(t,e){t.g.push(new er(t.Oa++,e)),3==t.v&&Pr(t)}function Pr(t){ir(t.b)||t.h||(t.h=!0,Se(t.Ba,t),t.u=0)}function Sr(t,e){var n;n=e?e.f:t.R++;var r=Sn(t.B);Vn(r,"SID",t.J),Vn(r,"RID",n),Vn(r,"AID",t.P),Mr(t,r),t.i&&t.l&&jr(r,t.i,t.l),n=new dn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),ur(t.b,n),yn(n,r,e)}function Mr(t,e){t.f&&An({},function(t,n){Vn(e,n,t)})}function Rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?vt(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{fr(h,s,"req"+c+"_")}catch(ji){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Ur(t){t.a||t.j||(t.T=1,Se(t.Aa,t),t.o=0)}function Lr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=rn(vt(t.Aa,t),zr(t,t.o)),t.o++,0))}function Vr(t){null!=t.s&&(at.clearTimeout(t.s),t.s=null)}function qr(t){t.a=new dn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Sn(t.la);Vn(e,"RID","rpc"),Vn(e,"SID",t.J),Vn(e,"CI",t.H?"0":"1"),Vn(e,"AID",t.P),Mr(t,e),Vn(e,"TYPE","xmlhttp"),t.i&&t.l&&jr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=qn(Sn(e)),n.j=null,n.I=!0,mn(n,t)}function Fr(t){null!=t.m&&(at.clearTimeout(t.m),t.m=null)}function Br(t,e){var n=null;if(t.a==e){Fr(t),Vr(t),t.a=null;var r=2}else{if(!sr(t.b,e))return;n=e.s,ar(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=yt()-e.u;var i=t.u;Te(r=Xe(),new nn(r,n,e,i)),Pr(t)}else Ur(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(or(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=rn(vt(t.Ba,t,e),zr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Lr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Gr(t,5);break;case 4:Gr(t,10);break;case 3:Gr(t,6);break;default:Gr(t,2)}}function zr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Gr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=vt(t.Ya,t);n||(n=new Pn("//www.google.com/images/cleardot.gif"),at.location&&"http"==at.location.protocol||Mn(n,"https"),qn(n)),function(t,e){var n=new We;if(at.Image){var r=new Image;r.onload=gt(pr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=gt(pr,n,r,"TestLoadImage: error",!1,e),r.onabort=gt(pr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=gt(pr,n,r,"TestLoadImage: timeout",!1,e),at.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else en(2);t.v=0,t.f&&t.f.ra(e),Kr(t),Dr(t)}function Kr(t){t.v=0,t.I=-1,t.f&&(0==cr(t.b).length&&0==t.g.length||(t.b.c.length=0,_t(t.g),t.g.length=0),t.f.qa())}function $r(t,e,n){var r=function(t){return t instanceof Pn?Sn(t):new Pn(t,void 0)}(n);if(""!=r.c)e&&Rn(r,e+"."+r.c),Un(r,r.h);else{var i=at.location;r=function(t,e,n,r){var i=new Pn(null,void 0);return t&&Mn(i,t),e&&Rn(i,e),n&&Un(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&xt(t.V,function(t,e){Vn(r,e,t)}),n=t.na,(e=t.A)&&n&&Vn(r,e,n),Vn(r,"VER",t.ha),Mr(t,r),r}function Wr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new br(t.Na)).F=t.C,e}function Yr(){}function Hr(){if(qt&&!(10<=Number(Xt)))throw Error("Environmental error: no available transport.")}function Qr(t,e){_e.call(this),this.a=new Ar(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Tt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Tt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Zr(this)}function Xr(t){ln.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Jr(){fn.call(this),this.status=1}function Zr(t){this.a=t}(ot=br.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:cn),this.a.onreadystatechange=vt(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void wr(this,o)}t=n||"";var i=new Nn(this.headers);r&&An(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=mr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=at.FormData&&t instanceof at.FormData,!(0<=Ot(yr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{_r(this),0<this.o&&((this.D=function(t){return qt&&Qt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=vt(this.xa,this)):this.m=qe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){wr(this,o)}},ot.xa=function(){void 0!==ut&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Te(this,"timeout"),this.abort(8))},ot.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Te(this,"complete"),Te(this,"abort"),Er(this))},ot.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Er(this,!0)),br.X.G.call(this)},ot.za=function(){this.j||(this.A||this.l||this.g?Ir(this):this.Ua())},ot.Ua=function(){Ir(this)},ot.W=function(){try{return 2<Tr(this)?this.a.status:-1}catch(Lt){return-1}},ot.$=function(){try{return this.a?this.a.responseText:""}catch(Lt){return""}},ot.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),dr(e)}},ot.ua=function(){return this.h},ot.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ot=Ar.prototype).ha=8,ot.v=1,ot.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new dn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Mt(r=Pt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Rr(this,n,e),Vn(i=Sn(this.B),"RID",t),Vn(i,"CVER",22),this.A&&Vn(i,"X-HTTP-Session-Id",this.A),Mr(this,i),this.i&&r&&jr(i,this.i,r),ur(this.b,n),this.Ia&&Vn(i,"TYPE","init"),this.da?(Vn(i,"$req",e),Vn(i,"SID","null"),n.U=!0,yn(n,i,null)):yn(n,i,e),this.v=2}}else 3==this.v&&(t?Sr(this,t):0==this.g.length||ir(this.b)||Sr(this))},ot.Aa=function(){if(this.j=null,qr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=rn(vt(this.Ta,this),t)}},ot.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,en(10),kr(this),qr(this))},ot.Sa=function(){null!=this.m&&(this.m=null,kr(this),Lr(this),en(19))},ot.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),en(2)):(this.c.info("Failed to ping google.com"),en(1))},(ot=Yr.prototype).ta=function(){},ot.sa=function(){},ot.ra=function(){},ot.qa=function(){},ot.Ja=function(){},Hr.prototype.a=function(t,e){return new Qr(t,e)},mt(Qr,_e),Qr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;en(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=$r(t,null,t.fa),Pr(t)},Qr.prototype.close=function(){Nr(this.a)},Qr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,xr(this.a,e)}else this.l?((e={}).__data__=Ce(t),xr(this.a,e)):xr(this.a,t)},Qr.prototype.G=function(){this.a.f=null,delete this.f,Nr(this.a),delete this.a,Qr.X.G.call(this)},mt(Xr,ln),mt(Jr,fn),mt(Zr,Yr),Zr.prototype.ta=function(){Te(this.a,"a")},Zr.prototype.sa=function(t){Te(this.a,new Xr(t))},Zr.prototype.ra=function(t){Te(this.a,new Jr(t))},Zr.prototype.qa=function(){Te(this.a,"b")},Hr.prototype.createWebChannel=Hr.prototype.a,Qr.prototype.send=Qr.prototype.h,Qr.prototype.open=Qr.prototype.g,Qr.prototype.close=Qr.prototype.close,on.NO_ERROR=0,on.TIMEOUT=8,on.HTTP_ERROR=6,sn.COMPLETE="complete",an.EventType=hn,hn.OPEN="a",hn.CLOSE="b",hn.ERROR="c",hn.MESSAGE="d",_e.prototype.listen=_e.prototype.va,br.prototype.listenOnce=br.prototype.wa,br.prototype.getLastError=br.prototype.Qa,br.prototype.getLastErrorCode=br.prototype.ua,br.prototype.getStatus=br.prototype.W,br.prototype.getResponseJson=br.prototype.Pa,br.prototype.getResponseText=br.prototype.$,br.prototype.send=br.prototype.ba;var ti=on,ei=sn,ni=He,ri=an,ii=br,oi=n("/6Yf"),si=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},ui=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ai=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();ai.UNAUTHENTICATED=new ai(null),ai.l=new ai("google-credentials-uid"),ai._=new ai("first-party-uid");var ci=new et.b("@firebase/firestore");function hi(){return ci.logLevel}function li(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ci.logLevel<=et.a.DEBUG){var r=e.map(di);ci.debug.apply(ci,Object(Z.g)(["Firestore (8.1.1): "+t],r))}}function fi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ci.logLevel<=et.a.ERROR){var r=e.map(di);ci.error.apply(ci,Object(Z.g)(["Firestore (8.1.1): "+t],r))}}function pi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ci.logLevel<=et.a.WARN){var r=e.map(di);ci.warn.apply(ci,Object(Z.g)(["Firestore (8.1.1): "+t],r))}}function di(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function bi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw fi(e),new Error(e)}function vi(t,e){t||bi()}function gi(t,e){return t}var yi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},mi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Z.c)(e,t),e}(Error),wi=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},Oi=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(ai.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),Ii=function(){function t(t){var e=this;this.P=null,this.currentUser=ai.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.V!==e?(li("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(vi("string"==typeof n.accessToken),new wi(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return vi(null===t||"string"==typeof t),new ai(t)},t}(),Ei=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=ai._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),_i=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new Ei(this.v,this.S))},t.prototype.A=function(t){t(ai._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function Ti(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var ji=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ti(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Ci(t,e){return t<e?-1:t>e?1:0}function Ai(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Ni(t){return t+"\0"}var ki=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new mi(yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new mi(yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new mi(yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new mi(yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?Ci(this.nanoseconds,t.nanoseconds):Ci(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Di=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new ki(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),xi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&bi(),void 0===n?n=t.length-e:n>t.length-e&&bi(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return this.L(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new mi(yi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.X=function(){return new e([])},e}(xi),Si=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return Si.test(t)},e.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.Z(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new mi(yi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new mi(yi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new mi(yi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new mi(yi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}(xi),Ri=function(){function t(t){this.path=t}return t.st=function(e){return new t(Pi.Y(e))},t.it=function(e){return new t(Pi.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Pi.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return Pi.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new Pi(e.slice()))},t}();function Ui(t){return null==t}function Li(t){return 0===t&&1/t==-1/0}function Vi(t){return"number"==typeof t&&Number.isInteger(t)&&!Li(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var qi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function Fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new qi(t,e,n,r,i,o,s)}function Bi(t){var e=gi(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.J()+t.op.toString()+Lo(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.J()+t.dir}(t)}).join(","),Ui(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=qu(e.startAt)),e.endAt&&(n+="|ub:",n+=qu(e.endAt)),e.ut=n}return e.ut}function zi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ku(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!So(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function Gi(t){return Ri.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ki=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.at)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return Ci(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();Ki.lt=new Ki("");var $i,Wi,Yi=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Di.min()),void 0===o&&(o=Di.min()),void 0===s&&(s=Ki.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),Hi=function(t){this.count=t};function Qi(t){switch(t){case yi.OK:return bi();case yi.CANCELLED:case yi.UNKNOWN:case yi.DEADLINE_EXCEEDED:case yi.RESOURCE_EXHAUSTED:case yi.INTERNAL:case yi.UNAVAILABLE:case yi.UNAUTHENTICATED:return!1;case yi.INVALID_ARGUMENT:case yi.NOT_FOUND:case yi.ALREADY_EXISTS:case yi.PERMISSION_DENIED:case yi.FAILED_PRECONDITION:case yi.ABORTED:case yi.OUT_OF_RANGE:case yi.UNIMPLEMENTED:case yi.DATA_LOSS:return!0;default:return bi()}}function Xi(t){if(void 0===t)return fi("GRPC error has no .code"),yi.UNKNOWN;switch(t){case $i.OK:return yi.OK;case $i.CANCELLED:return yi.CANCELLED;case $i.UNKNOWN:return yi.UNKNOWN;case $i.DEADLINE_EXCEEDED:return yi.DEADLINE_EXCEEDED;case $i.RESOURCE_EXHAUSTED:return yi.RESOURCE_EXHAUSTED;case $i.INTERNAL:return yi.INTERNAL;case $i.UNAVAILABLE:return yi.UNAVAILABLE;case $i.UNAUTHENTICATED:return yi.UNAUTHENTICATED;case $i.INVALID_ARGUMENT:return yi.INVALID_ARGUMENT;case $i.NOT_FOUND:return yi.NOT_FOUND;case $i.ALREADY_EXISTS:return yi.ALREADY_EXISTS;case $i.PERMISSION_DENIED:return yi.PERMISSION_DENIED;case $i.FAILED_PRECONDITION:return yi.FAILED_PRECONDITION;case $i.ABORTED:return yi.ABORTED;case $i.OUT_OF_RANGE:return yi.OUT_OF_RANGE;case $i.UNIMPLEMENTED:return yi.UNIMPLEMENTED;case $i.DATA_LOSS:return yi.DATA_LOSS;default:return bi()}}(Wi=$i||($i={}))[Wi.OK=0]="OK",Wi[Wi.CANCELLED=1]="CANCELLED",Wi[Wi.UNKNOWN=2]="UNKNOWN",Wi[Wi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wi[Wi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wi[Wi.NOT_FOUND=5]="NOT_FOUND",Wi[Wi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wi[Wi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wi[Wi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wi[Wi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wi[Wi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wi[Wi.ABORTED=10]="ABORTED",Wi[Wi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wi[Wi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wi[Wi.INTERNAL=13]="INTERNAL",Wi[Wi.UNAVAILABLE=14]="UNAVAILABLE",Wi[Wi.DATA_LOSS=15]="DATA_LOSS";var Ji=function(){function t(t,e){this.$=t,this.root=e||to.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,to.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,to.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Pt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new Zi(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new Zi(this.root,t,this.$,!1)},t.prototype.vt=function(){return new Zi(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new Zi(this.root,t,this.$,!0)},t}(),Zi=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),to=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw bi();if(this.right.Mt())throw bi();var t=this.left.Qt();if(t!==this.right.Qt())throw bi();return t+(this.Mt()?0:1)},t}();to.EMPTY=null,to.RED=!0,to.It=!1,to.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw bi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw bi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw bi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw bi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw bi()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new to(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var eo=function(){function t(t){this.$=t,this.data=new Ji(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt(function(e,n){return t(e),!1})},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new no(this.data.yt())},t.prototype.Vt=function(t){return new no(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),no=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),ro=new Ji(Ri.$);function io(){return ro}function oo(){return io()}var so=new Ji(Ri.$);function uo(){return so}var ao=new Ji(Ri.$),co=new eo(Ri.$);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=co,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var lo=new eo(Ci);function fo(){return lo}var po=function(){function t(t){this.$=t?function(e,n){return t(e,n)||Ri.$(e.key,n.key)}:function(t,e){return Ri.$(t.key,e.key)},this.Ht=uo(),this.Jt=new Ji(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),bo=function(){function t(){this.Xt=new Ji(Ri.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):bi():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt(function(e,n){t.push(n)}),t},t}(),vo=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}return t.ie=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,po.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),go=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,yo.he(e,n)),new t(Di.min(),r,fo(),io(),ho())},t}(),yo=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(Ki.lt,n,ho(),ho(),ho())},t}(),mo=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},wo=function(t,e){this.targetId=t,this.Te=e},Oo=function(t,e,n,r){void 0===n&&(n=Ki.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Io=function(){function t(){this.Ie=0,this.me=To(),this.Ae=Ki.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=ho(),e=ho(),n=ho();return this.me.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:bi()}}),new yo(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=To()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),Eo=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=io(),this.Me=_o(),this.ke=new eo(Ci)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof lu?this.Le(r,t.Ee):t.Ee instanceof fu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Be(o[i],t.key,t.Ee)},t.prototype.qe=function(t){var e=this;this.Ue(t,function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:bi()}})},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach(function(t,r){n.Ke(r)&&e(r)})},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(Gi(i))if(0===n){var o=new Ri(i.path);this.Be(e,o,new fu(o,Di.min()))}else vi(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach(function(r,i){var o=e.Ge(i);if(o){if(r.le&&Gi(o.target)){var s=new Ri(o.target.path);null!==e.Oe.get(s)||e.Je(i,s)||e.Be(i,s,new fu(s,t))}r.ye&&(n.set(i,r.pe()),r.ve())}});var r=ho();this.Me.forEach(function(t,n){var i=!0;n.Wt(function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)}),i&&(r=r.add(t))});var i=new go(t,n,this.ke,this.Oe,r);return this.Oe=io(),this.Me=_o(),this.ke=new eo(Ci),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Io,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new eo(Ci),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||li("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Io),this.xe.Xe(t).forEach(function(n){e.Be(t,n,null)})},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function _o(){return new Ji(Ri.$)}function To(){return new Ji(Ri.$)}function jo(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Co(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ao(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function No(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ko(t){var e=t.mapValue.fields.__previous_value__;return No(e)?ko(e):e}function Do(t){var e=qo(t.mapValue.fields.__local_write_time__.timestampValue);return new ki(e.seconds,e.nanos)}var xo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?No(t)?4:10:bi()}function So(t,e){var n=Po(t);if(n!==Po(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Do(t).isEqual(Do(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=qo(t.timestampValue),r=qo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bo(t.bytesValue).isEqual(Bo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Fo(t.geoPointValue.latitude)===Fo(e.geoPointValue.latitude)&&Fo(t.geoPointValue.longitude)===Fo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Fo(t.integerValue)===Fo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Fo(t.doubleValue),r=Fo(e.doubleValue);return n===r?Li(n)===Li(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ai(t.arrayValue.values||[],e.arrayValue.values||[],So);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(jo(n)!==jo(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!So(n[i],r[i])))return!1;return!0}(t,e);default:return bi()}}function Mo(t,e){return void 0!==(t.values||[]).find(function(t){return So(t,e)})}function Ro(t,e){var n=Po(t),r=Po(e);if(n!==r)return Ci(n,r);switch(n){case 0:return 0;case 1:return Ci(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Fo(t.integerValue||t.doubleValue),r=Fo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Uo(t.timestampValue,e.timestampValue);case 4:return Uo(Do(t),Do(e));case 5:return Ci(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Bo(t),r=Bo(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ci(n[i],r[i]);if(0!==o)return o}return Ci(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ci(Fo(t.latitude),Fo(e.latitude));return 0!==n?n:Ci(Fo(t.longitude),Fo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ro(n[i],r[i]);if(o)return o}return Ci(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ci(r[s],o[s]);if(0!==u)return u;var a=Ro(n[r[s]],i[o[s]]);if(0!==a)return a}return Ci(r.length,o.length)}(t.mapValue,e.mapValue);default:throw bi()}}function Uo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ci(t,e);var n=qo(t),r=qo(e),i=Ci(n.seconds,r.seconds);return 0!==i?i:Ci(n.nanos,r.nanos)}function Lo(t){return Vo(t)}function Vo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=qo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bo(t.bytesValue).toBase64():"referenceValue"in t?Ri.it(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Vo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Vo(t.fields[o])}return e+"}"}(t.mapValue):bi();var e}function qo(t){if(vi(!!t),"string"==typeof t){var e=0,n=xo.exec(t);if(vi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Fo(t.seconds),nanos:Fo(t.nanos)}}function Fo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?Ki.fromBase64String(t):Ki.fromUint8Array(t)}function zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Go(t){return!!t&&"integerValue"in t}function Ko(t){return!!t&&"arrayValue"in t}function $o(t){return!!t&&"nullValue"in t}function Wo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return!!t&&"mapValue"in t}var Ho={asc:"ASCENDING",desc:"DESCENDING"},Qo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Xo=function(t,e){this.t=t,this.tn=e};function Jo(t){return{integerValue:""+t}}function Zo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Li(e)?"-0":e}}function ts(t,e){return Vi(e)?Jo(e):Zo(t,e)}function es(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ns(t,e){return t.tn?e.toBase64():e.toUint8Array()}function rs(t,e){return es(t,e.M())}function is(t){return vi(!!t),Di.N(function(t){var e=qo(t);return new ki(e.seconds,e.nanos)}(t))}function os(t,e){return function(t){return new Pi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function ss(t){var e=Pi.Y(t);return vi(Ns(e)),e}function us(t,e){return os(t.t,e.path)}function as(t,e){var n=ss(e);if(n.get(1)!==t.t.projectId)throw new mi(yi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new mi(yi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Ri(fs(n))}function cs(t,e){return os(t.t,e)}function hs(t){var e=ss(t);return 4===e.length?Pi.X():fs(e)}function ls(t){return new Pi(["projects",t.t.projectId,"databases",t.t.database]).J()}function fs(t){return vi(t.length>4&&"documents"===t.get(4)),t.B(5)}function ps(t,e,n){return{name:us(t,e),fields:n.proto.mapValue.fields}}function ds(t,e){var n;if(e instanceof Zs)n={update:ps(t,e.key,e.value)};else if(e instanceof ou)n={delete:us(t,e.key)};else if(e instanceof tu)n={update:ps(t,e.key,e.data),updateMask:As(e.en)};else if(e instanceof nu)n={transform:{document:us(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Ss)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ms)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof Us)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof Vs)return{fieldPath:e.field.J(),increment:n.nn};throw bi()}(0,t)})}};else{if(!(e instanceof su))return bi();n={verify:us(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:rs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:bi()}(t,e.rn)),n}function bs(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ks.updateTime(is(t.updateTime)):void 0!==t.exists?Ks.exists(t.exists):Ks.on()}(e.currentDocument):Ks.on();if(e.update){var r=as(t,e.update.name),i=new uu({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new Bs((t.fieldPaths||[]).map(function(t){return Mi.nt(t)}))}(e.updateMask);return new tu(r,i,o,n)}return new Zs(r,i,n)}if(e.delete){var s=as(t,e.delete);return new ou(s,n)}if(e.transform){var u=as(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(vi("REQUEST_TIME"===e.setToServerValue),n=new Ss):"appendMissingElements"in e?n=new Ms(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Us(e.removeAllFromArray.values||[]):"increment"in e?n=new Vs(t,e.increment):bi();var r=Mi.nt(e.fieldPath);return new zs(r,n)}(t,e)});return vi(!0===n.exists),new nu(u,a)}if(e.verify){var c=as(t,e.verify);return new su(c,n)}return bi()}function vs(t,e){return{documents:[cs(t,e.path)]}}function gs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=cs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cs(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:_s(t.field),op:"IS_NAN"}};if($o(t.value))return{unaryFilter:{field:_s(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:_s(t.field),op:"IS_NOT_NAN"}};if($o(t.value))return{unaryFilter:{field:_s(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_s(t.field),op:Es(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:_s(t.field),direction:Is(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.tn||Ui(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ws(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ws(e.endAt)),n}function ys(t){var e=hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){vi(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ms(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new zu(Ts(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return Ui(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Os(n.startAt));var h=null;return n.endAt&&(h=Os(n.endAt)),bu(e,i,u,s,a,"F",c,h)}function ms(t){return t?void 0!==t.unaryFilter?[Cs(t)]:void 0!==t.fieldFilter?[js(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return ms(t)}).reduce(function(t,e){return t.concat(e)}):bi():[]}function ws(t){return{before:t.before,values:t.position}}function Os(t){return new Vu(t.values||[],!!t.before)}function Is(t){return Ho[t]}function Es(t){return Qo[t]}function _s(t){return{fieldPath:t.J()}}function Ts(t){return Mi.nt(t.fieldPath)}function js(t){return ku.create(Ts(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return bi()}}(t.fieldFilter.op),t.fieldFilter.value)}function Cs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ts(t.unaryFilter.field);return ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ts(t.unaryFilter.field);return ku.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ts(t.unaryFilter.field);return ku.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ts(t.unaryFilter.field);return ku.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return bi()}}function As(t){var e=[];return t.fields.forEach(function(t){return e.push(t.J())}),{fieldPaths:e}}function Ns(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ks=function(){this.cn=void 0};function Ds(t,e,n){return t instanceof Ss?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ms?Rs(t,e):t instanceof Us?Ls(t,e):function(t,e){var n=Ps(t,e),r=qs(n)+qs(t.nn);return Go(n)&&Go(t.nn)?Jo(r):Zo(t.serializer,r)}(t,e)}function xs(t,e,n){return t instanceof Ms?Rs(t,e):t instanceof Us?Ls(t,e):n}function Ps(t,e){return t instanceof Vs?Go(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ss=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e}(ks),Ms=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Z.c)(e,t),e}(ks);function Rs(t,e){for(var n=Fs(e),r=function(t){n.some(function(e){return So(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Us=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Z.c)(e,t),e}(ks);function Ls(t,e){for(var n=Fs(e),r=function(t){n=n.filter(function(e){return!So(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return Object(Z.c)(e,t),e}(ks);function qs(t){return Fo(t.integerValue||t.doubleValue)}function Fs(t){return Ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Bs=function(){function t(t){this.fields=t,t.sort(Mi.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return Ai(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),zs=function(t,e){this.field=t,this.transform=e},Gs=function(t,e){this.version=t,this.transformResults=e},Ks=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function $s(t,e){return void 0!==t.updateTime?e instanceof lu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof lu}var Ws=function(){};function Ys(t,e,n){return t instanceof Zs?function(t,e,n){return new lu(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof tu?function(t,e,n){if(!$s(t.rn,e))return new pu(t.key,n.version);var r=eu(t,e);return new lu(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof nu?function(t,e,n){if(vi(null!=n.transformResults),!$s(t.rn,e))return new pu(t.key,n.version);var r=ru(0,e),i=function(t,e,n){var r=[];vi(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof lu&&(u=e.field(o.field)),r.push(xs(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=iu(t,r.data(),i);return new lu(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new fu(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Hs(t,e,n,r){return t instanceof Zs?function(t,e){if(!$s(t.rn,e))return e;var n=Js(e);return new lu(t.key,n,t.value,{an:!0})}(t,e):t instanceof tu?function(t,e){if(!$s(t.rn,e))return e;var n=Js(e),r=eu(t,e);return new lu(t.key,n,r,{an:!0})}(t,e):t instanceof nu?function(t,e,n,r){if(!$s(t.rn,e))return e;var i=ru(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof lu&&(c=n.field(u.field)),null===c&&r instanceof lu&&(c=r.field(u.field)),i.push(Ds(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=iu(t,i.data(),o);return new lu(t.key,i.version,s,{an:!0})}(t,e,r,n):function(t,e){return $s(t.rn,e)?new fu(t.key,Di.min()):e}(t,e)}function Qs(t,e){return t instanceof nu?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof lu?e.field(o.field):void 0,u=Ps(o.transform,s||null);null!=u&&(n=null==n?(new au).set(o.field,u):n.set(o.field,u))}return n?n.hn():null}(t,e):null}function Xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||Ai(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ms&&e instanceof Ms||t instanceof Us&&e instanceof Us?Ai(t.elements,e.elements,So):t instanceof Vs&&e instanceof Vs?So(t.nn,e.nn):t instanceof Ss&&e instanceof Ss}(t.transform,e.transform)}(t,e)}))}function Js(t){return t instanceof lu?t.version:Di.min()}var Zs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return Object(Z.c)(e,t),e}(Ws),tu=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return Object(Z.c)(e,t),e}(Ws);function eu(t,e){return function(t,e){var n=new au(e);return t.en.fields.forEach(function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,e instanceof lu?e.data():uu.empty())}var nu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=Ks.exists(!0),r}return Object(Z.c)(e,t),e}(Ws);function ru(t,e){return e}function iu(t,e,n){for(var r=new au(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.hn()}var ou=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return Object(Z.c)(e,t),e}(Ws),su=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return Object(Z.c)(e,t),e}(Ws),uu=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return So(this.proto,t.proto)},t}(),au=function(){function t(t){void 0===t&&(t=uu.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Po(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(Mi.X(),this._n);return null!=t?new uu(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=Yo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.dn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function cu(t){var e=[];return Co(t.fields||{},function(t,n){var r=new Mi([t]);if(Yo(n)){var i=cu(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Bs(e)}var hu=function(t,e){this.key=t,this.version=e},lu=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(Z.c)(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(hu),fu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(Z.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(hu),pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(hu),du=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null};function bu(t,e,n,r,i,o,s,u){return new du(t,e,n,r,i,o,s,u)}function vu(t){return new du(t)}function gu(t){return!Ui(t.limit)&&"F"===t.limitType}function yu(t){return!Ui(t.limit)&&"L"===t.limitType}function mu(t){return t.Tn.length>0?t.Tn[0].field:null}function wu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Ou(t){return null!==t.collectionGroup}function Iu(t){var e=gi(t);if(null===e.In){e.In=[];var n=wu(e),r=mu(e);if(null!==n&&null===r)n.tt()||e.In.push(new zu(n)),e.In.push(new zu(Mi.et(),"asc"));else{for(var i=!1,o=0,s=e.Tn;o<s.length;o++){var u=s[o];e.In.push(u),u.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new zu(Mi.et(),a))}}}return e.In}function Eu(t){var e=gi(t);if(!e.mn)if("F"===e.limitType)e.mn=Fi(e.path,e.collectionGroup,Iu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Iu(e);r<i.length;r++){var o=i[r];n.push(new zu(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Vu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Vu(e.startAt.position,!e.startAt.before):null;e.mn=Fi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.mn}function _u(t,e,n){return new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tu(t,e){return zi(Eu(t),Eu(e))&&t.limitType===e.limitType}function ju(t){return Bi(Eu(t))+"|lt:"+t.limitType}function Cu(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.J()+" "+e.op+" "+Lo(e.value);var e}).join(", ")+"]"),Ui(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+qu(t.startAt)),t.endAt&&(e+=", endAt: "+qu(t.endAt)),"Target("+e+")"}(Eu(t))+"; limitType="+t.limitType+")"}function Au(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):Ri.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Fu(t.startAt,Iu(t),e)||t.endAt&&Fu(t.endAt,Iu(t),e))}(t,e)}function Nu(t){return function(e,n){for(var r=!1,i=0,o=Iu(t);i<o.length;i++){var s=o[i],u=Gu(s,e,n);if(0!==u)return u;r=r||s.field.tt()}return 0}}var ku=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Z.c)(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new Du(t,n,r):"array-contains"===n?new Mu(t,r):"in"===n?new Ru(t,r):"not-in"===n?new Uu(t,r):"array-contains-any"===n?new Lu(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new xu(t,n):new Pu(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(Ro(e,this.value)):null!==e&&Po(this.value)===Po(e)&&this.Pn(Ro(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return bi()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Du=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ri.it(r.referenceValue),i}return Object(Z.c)(e,t),e.prototype.matches=function(t){var e=Ri.$(t.key,this.key);return this.Pn(e)},e}(ku),xu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Su(0,n),r}return Object(Z.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(ku),Pu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Su(0,n),r}return Object(Z.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(ku);function Su(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Ri.it(t.referenceValue)})}var Mu=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Z.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Ko(e)&&Mo(e.arrayValue,this.value)},e}(ku),Ru=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Z.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Mo(this.value.arrayValue,e)},e}(ku),Uu=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Z.c)(e,t),e.prototype.matches=function(t){if(Mo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Mo(this.value.arrayValue,e)},e}(ku),Lu=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Z.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Mo(e.value.arrayValue,t)})},e}(ku),Vu=function(t,e){this.position=t,this.before=e};function qu(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Lo(t)}).join(",")}function Fu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.tt()?Ri.$(Ri.it(s.referenceValue),n.key):Ro(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!So(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Gu(t,e,n){var r=t.field.tt()?Ri.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ro(r,i):bi()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return bi()}}function Ku(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var $u=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ys(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Hs(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Hs(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ai(this.mutations,t.mutations,function(t,e){return Xs(t,e)})&&Ai(this.baseMutations,t.baseMutations,function(t,e){return Xs(t,e)})},t}(),Wu=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){vi(e.mutations.length===r.length);for(var i=ao,o=e.mutations,s=0;s<o.length;s++)i=i.Tt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Yu=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.Cn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Co(this.Nn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.W=function(){return Ao(this.Nn)},t}(),Hu=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&bi(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t(function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}})},t.prototype.Ln=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn(function(){return e(n)}):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.qn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.qn(r)},t}(),Qu=function(){function t(){this.Qn=new Yu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:Di.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?Hu.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),Xu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};function Ju(t){return new Xo(t,!0)}function Zu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var ta="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ea=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach(function(t){return t()})},t}(),na=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next(function(r){return n.hs(t,e,r)})},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t})},t.prototype.ls=function(t,e,n){var r=oo();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)}),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next(function(e){return n.fs(t,e)})},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next(function(r){var i=n.ls(t,e,r),o=io();return i.forEach(function(t,e){e||(e=new fu(t,Di.min())),o=o.Tt(t,e)}),o})},t.prototype.ws=function(t,e,n){return function(t){return Ri.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Ou(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new Ri(e)).next(function(t){var e=uo();return t instanceof lu&&(e=e.Tt(t.key,t)),e})},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=uo();return this.os.As(t,i).next(function(s){return Hu.forEach(s,function(s){var u=function(t,e){return new du(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Is(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Tt(t,e)})})}).next(function(){return o})})},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next(function(n){return r=n,o.rs.Rs(t,e)}).next(function(e){return o.Ps(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),l=Hs(a,h,h,o.gn);r=l instanceof lu?r.Tt(c,l):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Au(e,n)||(r=r.remove(t))}),r})},t.prototype.Ps=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof tu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof lu&&(c=c.Tt(t,e))}),c})},t}(),ra=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=ho(),i=ho(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ia=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();ia.Ds=-1;var oa=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&li("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),sa=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js(Object(nt.g)())&&fi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return li("SimpleDb","Removing database:",t),fa(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=Object(nt.g)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n=this;return Object(Z.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(li("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new aa(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new mi(yi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new aa(t,n))},i.onupgradeneeded=function(t){li("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Ws.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){li("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}})})},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Z.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(Z.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(Z.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,u.Xs(t)];case 2:return u.db=l.sent(),e=ha.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Hu.reject(t)}).Ln(),a={},s.catch(function(){}),[4,e.ei];case 3:return[2,(a.value=(l.sent(),s),a)];case 4:return li("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ua=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return fa(this.ni.delete())},t}(),aa=function(t){function e(e,n){var r=this;return(r=t.call(this,yi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Z.c)(e,t),e}(mi);function ca(t){return"IndexedDbTransactionError"===t.name}var ha=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new Xu,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new aa(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=da(e.target.error);n.ci.reject(new aa(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new aa(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(li("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new la(e)},t}(),la=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(li("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(li("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),fa(n)},t.prototype.add=function(t){return li("SimpleDb","ADD",this.store.name,t,t),fa(this.store.add(t))},t.prototype.get=function(t){var e=this;return fa(this.store.get(t)).next(function(n){return void 0===n&&(n=null),li("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return li("SimpleDb","DELETE",this.store.name,t),fa(this.store.delete(t))},t.prototype.count=function(){return li("SimpleDb","COUNT",this.store.name),fa(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.hi=function(t,e){li("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,function(t,e,n){return n.delete()})},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new Hu(function(n,r){e.onerror=function(t){var e=da(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ai=function(t,e){var n=[];return new Hu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ua(i),s=e(i.primaryKey,i.value,o);if(s instanceof Hu){var u=s.catch(function(t){return o.done(),Hu.reject(t)});n.push(u)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}}).next(function(){return Hu.qn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function fa(t){return new Hu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=da(t.target.error);n(e)}})}var pa=!1;function da(t){var e=sa.js(Object(nt.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new mi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return pa||(pa=!0,setTimeout(function(){throw r},0)),r}}return t}function ba(){return"undefined"!=typeof window?window:null}function va(){return"undefined"!=typeof document?document:null}var ga=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new Xu,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}return t.Ii=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new mi(yi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri(function(){return null!==t.mi?(t.clearTimeout(),t.op().then(function(e){return t.Ti.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),ya=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new oa(this,"async_queue_retry"),this.Di=function(){var e=va();e&&li("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=va();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=va();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},t.prototype.ki=function(){return Object(Z.b)(this,void 0,void 0,function(){var t,e=this;return Object(Z.d)(this,function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!ca(t=n.sent()))throw t;return li("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs(function(){return e.ki()}),n.label=5;case 5:return[2]}})})},t.prototype.Fi=function(t){var e=this,n=this.Pi.then(function(){return e.vi=!0,t().catch(function(t){throw e.pi=t,e.vi=!1,fi("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.vi=!1,t})});return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=ga.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&bi()},t.prototype.Li=function(){},t.prototype.Bi=function(){return Object(Z.b)(this,void 0,void 0,function(){var t;return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then(function(){e.Vi.sort(function(t,e){return t.wi-e.wi});for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()})},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function ma(t,e){if(fi("AsyncQueue",e+": "+t),ca(t))return new mi(yi.UNAVAILABLE,e+": "+t);throw t}function wa(t,e){var n=t[1],r=e[1],i=Ci(t[0],e[0]);return 0===i?Ci(n,r):i}var Oa=function(){function t(t){this.Ki=t,this.buffer=new eo(wa),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();wa(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ia={zi:!1,Hi:0,Ji:0,Yi:0},Ea=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Ea.nr=10,Ea.sr=1e3,Ea.ir=new Ea(41943040,Ea.nr,Ea.sr),Ea.rr=new Ea(-1,0,0);var _a=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;li("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,function(){return Object(Z.b)(e,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return ca(e=n.sent())?(li("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Xc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}})})})},t}(),Ta=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Tr=function(t,e){var n=this;if(0===e)return Hu.resolve(ia.Ds);var r=new Oa(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(li("LruGarbageCollector","Garbage collection skipped; disabled"),Hu.resolve(Ia)):this.Pr(t).next(function(r){return r<n.params.Xi?(li("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),Ia):n.gr(t,e)})},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.wr(t,this.params.Zi).next(function(e){return e>c.params.tr?(li("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.tr+" from "+e),r=c.params.tr):r=e,o=Date.now(),c.Tr(t,r)}).next(function(r){return n=r,s=Date.now(),c.mr(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Ar(t,n)}).next(function(t){return a=Date.now(),hi()<=et.a.DEBUG&&li("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Hu.resolve({zi:!0,Hi:r,Ji:i,Yi:t})})},t}();function ja(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Aa(e)),e=Ca(t.get(n),e);return Aa(e)}function Ca(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Aa(t){return t+"\x01\x01"}function Na(t){var e=t.length;if(vi(e>=2),2===e)return vi("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Pi.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&bi(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:bi()}o=s+2}return new Pi(r)}var ka=function(t){this.yr=t};function Da(t,e){if(e.document)return function(t,e,n){var r=as(t,e.name),i=is(e.updateTime),o=new uu({mapValue:{fields:e.fields}});return new lu(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ri.ct(e.noDocument.path),r=Ra(e.noDocument.readTime);return new fu(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Ri.ct(e.unknownDocument.path),o=Ra(e.unknownDocument.version);return new pu(i,o)}return bi()}function xa(t,e,n){var r=Pa(n),i=e.key.path.q().H();if(e instanceof lu){var o=function(t,e){return{name:us(t,e.key),fields:e.En().mapValue.fields,updateTime:es(t,e.version.M())}}(t.yr,e);return new cc(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof fu){var s=e.key.path.H(),u=Ma(e.version),a=e.hasCommittedMutations;return new cc(null,new uc(s,u),null,a,r,i)}if(e instanceof pu){var c=e.key.path.H(),h=Ma(e.version);return new cc(new ac(c,h),null,null,!0,r,i)}return bi()}function Pa(t){var e=t.M();return[e.seconds,e.nanoseconds]}function Sa(t){var e=new ki(t[0],t[1]);return Di.N(e)}function Ma(t){var e=t.M();return new nc(e.seconds,e.nanoseconds)}function Ra(t){var e=new ki(t.seconds,t.nanoseconds);return Di.N(e)}function Ua(t,e){var n=(e.baseMutations||[]).map(function(e){return bs(t.yr,e)}),r=e.mutations.map(function(e){return bs(t.yr,e)}),i=ki.fromMillis(e.localWriteTimeMs);return new $u(e.batchId,i,n,r)}function La(t){var e,n,r=Ra(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ra(t.lastLimboFreeSnapshotVersion):Di.min();return void 0!==t.query.documents?(vi(1===(n=t.query).documents.length),e=Eu(vu(hs(n.documents[0])))):e=function(t){return Eu(ys(t))}(t.query),new Yi(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ki.fromBase64String(t.resumeToken))}function Va(t,e){var n,r=Ma(e.ft),i=Ma(e.lastLimboFreeSnapshotVersion);n=Gi(e.target)?vs(t.yr,e.target):gs(t.yr,e.target);var o=e.resumeToken.toBase64();return new lc(e.targetId,Bi(e.target),r,o,e.sequenceNumber,i,n)}function qa(t){var e=ys({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?_u(e,e.limit,"L"):e}var Fa=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return vi(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ga(t)._i({index:oc.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Sr=function(t,e,n,r){var i=this,o=Ka(t),s=Ga(t);return s.add({}).next(function(u){vi("number"==typeof u);for(var a=new $u(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ds(t.yr,e)}),i=n.mutations.map(function(e){return ds(t.yr,e)});return new oc(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],l=new eo(function(t,e){return Ci(t.J(),e.J())}),f=0,p=r;f<p.length;f++){var d=p[f],b=sc.key(i.userId,d.key.path,u);l=l.add(d.key.path.q()),h.push(s.put(c)),h.push(o.put(b,sc.PLACEHOLDER))}return l.forEach(function(e){h.push(i.os.Dr(t,e))}),t.es(function(){i.pr[u]=a.keys()}),Hu.qn(h).next(function(){return a})})},t.prototype.Cr=function(t,e){var n=this;return Ga(t).get(e).next(function(t){return t?(vi(t.userId===n.userId),Ua(n.serializer,t)):null})},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?Hu.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null})},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ga(t)._i({index:oc.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(vi(e.batchId>=r),o=Ua(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ga(t)._i({index:oc.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ga(t).ui(oc.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ua(e.serializer,t)})})},t.prototype.us=function(t,e){var n=this,r=sc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ka(t)._i({range:i},function(r,i,s){var u=r[0],a=r[2],c=Na(r[1]);if(u===n.userId&&e.path.isEqual(c))return Ga(t).get(a).next(function(t){if(!t)throw bi();vi(t.userId===n.userId),o.push(Ua(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.ds=function(t,e){var n=this,r=new eo(Ci),i=[];return e.forEach(function(e){var o=sc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Ka(t)._i({range:s},function(t,i,o){var s=t[0],u=t[2],a=Na(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),Hu.qn(i).next(function(){return n.kr(t,r)})},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=sc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new eo(Ci);return Ka(t)._i({range:s},function(t,e,o){var s=t[0],a=t[2],c=Na(t[1]);s===n.userId&&r.j(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.kr(t,u)})},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ga(t).get(e).next(function(t){if(null===t)throw bi();vi(t.userId===n.userId),r.push(Ua(n.serializer,t))}))}),Hu.qn(i).next(function(){return r})},t.prototype.$r=function(t,e){var n=this;return za(t.Lr,this.userId,e).next(function(r){return t.es(function(){n.Br(e.batchId)}),Hu.forEach(r,function(e){return n.Vr.qr(t,e)})})},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next(function(n){if(!n)return Hu.resolve();var r=IDBKeyRange.lowerBound(sc.prefixForUser(e.userId)),i=[];return Ka(t)._i({range:r},function(t,n,r){if(t[0]===e.userId){var o=Na(t[1]);i.push(o)}else r.done()}).next(function(){vi(0===i.length)})})},t.prototype.Qr=function(t,e){return Ba(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return $a(t).get(this.userId).next(function(t){return t||new ic(e.userId,-1,"")})},t}();function Ba(t,e,n){var r=sc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ka(t)._i({range:o,li:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function za(t,e,n){var r=t.store(oc.store),i=t.store(sc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r._i({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){vi(1===u)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=sc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Hu.qn(o).next(function(){return c})}function Ga(t){return xc.Ys(t,oc.store)}function Ka(t){return xc.Ys(t,sc.store)}function $a(t){return xc.Ys(t,ic.store)}var Wa=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return Qa(t).put(Xa(e),n)},t.prototype.Hn=function(t,e){var n=Qa(t),r=Xa(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Wr(t,r)})},t.prototype.Jn=function(t,e){var n=this;return Qa(t).get(Xa(e)).next(function(t){return n.jr(t)})},t.prototype.Gr=function(t,e){var n=this;return Qa(t).get(Xa(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Ja(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=oo();return this.zr(t,e,function(t,e){var i=n.jr(e);r=r.Tt(t,i)}).next(function(){return r})},t.prototype.Hr=function(t,e){var n=this,r=oo(),i=new Ji(Ri.$);return this.zr(t,e,function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,Ja(e))):(r=r.Tt(t,null),i=i.Tt(t,0))}).next(function(){return{Jr:r,Yr:i}})},t.prototype.zr=function(t,e,n){if(e.W())return Hu.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return Qa(t)._i({range:r},function(t,e,r){for(var s=Ri.ct(t);o&&Ri.$(o,s)<0;)n(o,null),o=i.Ct();o&&o.isEqual(s)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null})},t.prototype.ws=function(t,e,n){var r=this,i=uo(),o=e.path.length+1,s={};if(n.isEqual(Di.min())){var u=e.path.H();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.H(),c=Pa(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=cc.collectionReadTimeIndex}return Qa(t)._i(s,function(t,n,s){if(t.length===o){var u=Da(r.serializer,n);e.path.j(u.key.path)?u instanceof lu&&Au(e,u)&&(i=i.Tt(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Xr=function(t){return new Ya(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ha(t).get(hc.key).next(function(t){return vi(!!t),t})},t.prototype.Wr=function(t,e){return Ha(t).put(hc.key,e)},t.prototype.jr=function(t){if(t){var e=Da(this.serializer,t);return e instanceof fu&&e.version.isEqual(Di.min())?null:e}return null},t}(),Ya=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new Yu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Z.c)(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new eo(function(t,e){return Ci(t.J(),e.J())});return this.Qn.forEach(function(o,s){var u=e.so.get(o);if(s.zn){var a=xa(e.no.serializer,s.zn,e.Wn(o));i=i.add(o.path.q());var c=Ja(a);r+=c-u,n.push(e.no.jn(t,o,a))}else if(r-=u,e.Zr){var h=xa(e.no.serializer,new fu(o,Di.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))}),i.forEach(function(r){n.push(e.no.os.Dr(t,r))}),n.push(this.no.updateMetadata(t,r)),Hu.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},e.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},e}(Qu);function Ha(t){return xc.Ys(t,hc.store)}function Qa(t){return xc.Ys(t,cc.store)}function Xa(t){return t.path.H()}function Ja(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw bi();e=t.noDocument}return JSON.stringify(e).length}var Za=function(){function t(){this.io=new tc}return t.prototype.Dr=function(t,e){return this.io.add(e),Hu.resolve()},t.prototype.As=function(t,e){return Hu.resolve(this.io.getEntries(e))},t}(),tc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new eo(Pi.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new eo(Pi.$)).H()},t}(),ec=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;vi(n<r&&n>=0&&r<=11);var o=new ha("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(rc.store)}(t),function(t){t.createObjectStore(ic.store,{keyPath:ic.keyPath}),t.createObjectStore(oc.store,{keyPath:oc.keyPath,autoIncrement:!0}).createIndex(oc.userMutationsIndex,oc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(sc.store)}(t),bc(t),function(t){t.createObjectStore(cc.store)}(t));var s=Hu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(fc.store),t.deleteObjectStore(lc.store),t.deleteObjectStore(pc.store)}(t),bc(t)),s=s.next(function(){return function(t){var e=t.store(pc.store),n=new pc(0,0,Di.min().M(),0);return e.put(pc.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(oc.store).ui().next(function(n){t.deleteObjectStore(oc.store),t.createObjectStore(oc.store,{keyPath:oc.keyPath,autoIncrement:!0}).createIndex(oc.userMutationsIndex,oc.userMutationsKeyPath,{unique:!0});var r=e.store(oc.store),i=n.map(function(t){return r.put(t)});return Hu.qn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(vc.store,{keyPath:vc.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(hc.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(cc.store);e.createIndex(cc.readTimeIndex,cc.readTimeIndexPath,{unique:!1}),e.createIndex(cc.collectionReadTimeIndex,cc.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(gc.store,{keyPath:gc.keyPath})}(t),function(t){t.createObjectStore(yc.store,{keyPath:yc.keyPath})}(t)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(cc.store)._i(function(t,n){e+=Ja(n)}).next(function(){var n=new hc(e);return t.store(hc.store).put(hc.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(ic.store),r=t.store(oc.store);return n.ui().next(function(n){return Hu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(oc.userMutationsIndex,i).next(function(r){return Hu.forEach(r,function(r){vi(r.userId===n.userId);var i=Ua(e.serializer,r);return za(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(fc.store),n=t.store(cc.store);return t.store(pc.store).get(pc.key).next(function(t){var r=[];return n._i(function(n,i){var o=new Pi(n),s=function(t){return[0,ja(t)]}(o);r.push(e.get(s).next(function(n){return n?Hu.resolve():function(n){return e.put(new fc(0,ja(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Hu.qn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(dc.store,{keyPath:dc.keyPath});var n=e.store(dc.store),r=new tc,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:ja(i)})}};return e.store(cc.store)._i({li:!0},function(t,e){var n=new Pi(t);return i(n.q())}).next(function(){return e.store(sc.store)._i({li:!0},function(t,e){var n=Na(t[1]);return i(n.q())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(lc.store);return n._i(function(t,r){var i=La(r),o=Va(e.serializer,i);return n.put(o)})},t}(),nc=function(t,e){this.seconds=t,this.nanoseconds=e},rc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};rc.store="owner",rc.key="owner";var ic=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ic.store="mutationQueues",ic.keyPath="userId";var oc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};oc.store="mutations",oc.keyPath="batchId",oc.userMutationsIndex="userMutationsIndex",oc.userMutationsKeyPath=["userId","batchId"];var sc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ja(e)]},t.key=function(t,e,n){return[t,ja(e),n]},t}();sc.store="documentMutations",sc.PLACEHOLDER=new sc;var uc=function(t,e){this.path=t,this.readTime=e},ac=function(t,e){this.path=t,this.version=e},cc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};cc.store="remoteDocuments",cc.readTimeIndex="readTimeIndex",cc.readTimeIndexPath="readTime",cc.collectionReadTimeIndex="collectionReadTimeIndex",cc.collectionReadTimeIndexPath=["parentPath","readTime"];var hc=function(t){this.byteSize=t};hc.store="remoteDocumentGlobal",hc.key="remoteDocumentGlobalKey";var lc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};lc.store="targets",lc.keyPath="targetId",lc.queryTargetsIndexName="queryTargetsIndex",lc.queryTargetsKeyPath=["canonicalId","targetId"];var fc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};fc.store="targetDocuments",fc.keyPath=["targetId","path"],fc.documentTargetsIndex="documentTargetsIndex",fc.documentTargetsKeyPath=["path","targetId"];var pc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};pc.key="targetGlobalKey",pc.store="targetGlobal";var dc=function(t,e){this.collectionId=t,this.parent=e};function bc(t){t.createObjectStore(fc.store,{keyPath:fc.keyPath}).createIndex(fc.documentTargetsIndex,fc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(lc.store,{keyPath:lc.keyPath}).createIndex(lc.queryTargetsIndexName,lc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(pc.store)}dc.store="collectionParents",dc.keyPath=["collectionId","parent"];var vc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};vc.store="clientMetadata",vc.keyPath="clientId";var gc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};gc.store="bundles",gc.keyPath="bundleId";var yc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};yc.store="namedQueries",yc.keyPath="name";var mc=Object(Z.g)(Object(Z.g)(Object(Z.g)(Object(Z.g)([ic.store,oc.store,sc.store,cc.store,lc.store,rc.store,pc.store,fc.store],[vc.store]),[hc.store]),[dc.store]),[gc.store,yc.store]),wc=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return Oc(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Ra(e.createTime),version:e.version};var e})},t.prototype.oo=function(t,e){return Oc(t).put({bundleId:(n=e).id,createTime:Ma(is(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return Ic(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:qa(e.bundledQuery),readTime:Ra(e.readTime)};var e})},t.prototype.uo=function(t,e){return Ic(t).put(function(t){return{name:t.name,readTime:Ma(is(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Oc(t){return xc.Ys(t,gc.store)}function Ic(t){return xc.Ys(t,yc.store)}var Ec=function(){function t(){this.ao=new tc}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});var o={collectionId:r,parent:ja(i)};return _c(t).put(o)}return Hu.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ni(e),""],!1,!0);return _c(t).ui(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Na(o.parent))}return n})},t}();function _c(t){return xc.Ys(t,dc.store)}var Tc=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),jc=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next(function(n){var r=new Tc(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next(function(){return n.highestTargetId})})},t.prototype.To=function(t){return this.wo(t).next(function(t){return Di.N(new ki(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)})},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next(function(){return n.wo(t).next(function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)})})},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next(function(){return Cc(t).delete(e.targetId)}).next(function(){return n.wo(t)}).next(function(e){return vi(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)})},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return Cc(t)._i(function(s,u){var a=La(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))}).next(function(){return Hu.qn(o)}).next(function(){return i})},t.prototype.Ue=function(t,e){return Cc(t)._i(function(t,n){var r=La(n);e(r)})},t.prototype.wo=function(t){return Ac(t).get(pc.key).next(function(t){return vi(null!==t),t})},t.prototype.Eo=function(t,e){return Ac(t).put(pc.key,e)},t.prototype.Ro=function(t,e){return Cc(t).put(Va(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},t.prototype.bo=function(t,e){var n=Bi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Cc(t)._i({range:r,index:lc.queryTargetsIndexName},function(t,n,r){var o=La(n);zi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.So=function(t,e,n){var r=this,i=[],o=Nc(t);return e.forEach(function(e){var s=ja(e.path);i.push(o.put(new fc(n,s))),i.push(r.Vr.Do(t,n,e))}),Hu.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=Nc(t);return Hu.forEach(e,function(e){var o=ja(e.path);return Hu.qn([i.delete([n,o]),r.Vr.No(t,n,e)])})},t.prototype.po=function(t,e){var n=Nc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Nc(t),i=ho();return r._i({range:n,li:!0},function(t,e,n){var r=Na(t[1]),o=new Ri(r);i=i.add(o)}).next(function(){return i})},t.prototype.Qr=function(t,e){var n=ja(e.path),r=IDBKeyRange.bound([n],[Ni(n)],!1,!0),i=0;return Nc(t)._i({index:fc.documentTargetsIndex,li:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Ze=function(t,e){return Cc(t).get(e).next(function(t){return t?La(t):null})},t}();function Cc(t){return xc.Ys(t,lc.store)}function Ac(t){return xc.Ys(t,pc.store)}function Nc(t){return xc.Ys(t,fc.store)}var kc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Dc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return Object(Z.c)(e,t),e}(ea),xc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=s,this.document=u,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new mi(yi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new Mc(this,i),this.Ko=n+"main",this.serializer=new ka(a),this.Wo=new sa(this.Ko,11,new ec(this.serializer)),this.jo=new jc(this.Vr,this.serializer),this.os=new Ec,this.ss=function(t,e){return new Wa(t,e)}(this.serializer,this.os),this.Go=new wc(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&fi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof Dc)return sa.Ys(t.Lr,e);throw bi()},t.prototype.start=function(){var t=this;return this.Ho().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new mi(yi.FAILED_PRECONDITION,kc);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.jo.Io(e)})}).then(function(e){t.ko=new ia(e,t.Oo)}).then(function(){t.$o=!0}).catch(function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)})},t.prototype.Zo=function(t){var e=this;return this.Qo=function(n){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){return this.lr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.tc=function(t){var e=this;this.Wo.ti(function(n){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Sc(e).put(new vc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.nc(e).next(function(e){e||(t.isPrimary=!1,t.Cs.Mi(function(){return t.Qo(!1)}))})}).next(function(){return t.sc(e)}).next(function(n){return t.isPrimary&&!n?t.ic(e).next(function(){return!1}):!!n&&t.rc(e).next(function(){return!0})})}).catch(function(e){if(ca(e))return li("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return li("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Cs.Mi(function(){return t.Qo(e)}),t.isPrimary=e})},t.prototype.nc=function(t){var e=this;return Pc(t).get(rc.key).next(function(t){return Hu.resolve(e.oc(t))})},t.prototype.cc=function(t){return Sc(t).delete(this.clientId)},t.prototype.uc=function(){return Object(Z.b)(this,void 0,void 0,function(){var e,n,r,i=this;return Object(Z.d)(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ys(e,vc.store);return n.ui().next(function(t){var e=i.hc(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return Hu.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=o.sent(),this.zo)for(n=0,r=e;n<r.length;n++)this.zo.removeItem(this.lc(r[n].clientId));o.label=2;case 2:return[2]}})})},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?Hu.resolve(!0):Pc(t).get(rc.key).next(function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new mi(yi.FAILED_PRECONDITION,kc);return!1}}return!(!e.networkEnabled||!e.inForeground)||Sc(t).ui().next(function(t){return void 0===e.hc(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&li("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.fc=function(){return Object(Z.b)(this,void 0,void 0,function(){var t=this;return Object(Z.d)(this,function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[rc.store,vc.store],function(e){var n=new Dc(e,ia.Ds);return t.ic(n).next(function(){return t.cc(n)})})];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}})})},t.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Sc(e).ui().next(function(e){return t.hc(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return Fa.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r,i=this;return li("IndexedDbPersistence","Starting transaction:",t),this.Wo.runTransaction(t,"readonly"===e?"readonly":"readwrite",mc,function(o){return r=new Dc(o,i.ko?i.ko.next():ia.Ds),"readwrite-primary"===e?i.nc(r).next(function(t){return!!t||i.sc(r)}).next(function(e){if(!e)throw fi("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new mi(yi.FAILED_PRECONDITION,ta);return n(r)}).next(function(t){return i.rc(r).next(function(){return t})}):i.yc(r).next(function(){return n(r)})}).then(function(t){return r.ns(),t})},t.prototype.yc=function(t){var e=this;return Pc(t).get(rc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new mi(yi.FAILED_PRECONDITION,kc)})},t.prototype.rc=function(t){var e=new rc(this.clientId,this.allowTabSynchronization,Date.now());return Pc(t).put(rc.key,e)},t.Gs=function(){return sa.Gs()},t.prototype.ic=function(t){var e=this,n=Pc(t);return n.get(rc.key).next(function(t){return e.oc(t)?(li("IndexedDbPersistence","Releasing primary lease."),n.delete(rc.key)):Hu.resolve()})},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(fi("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return li("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return fi("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){fi("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Pc(t){return xc.Ys(t,rc.store)}function Sc(t){return xc.Ys(t,vc.store)}var Mc=function(){function t(t,e){this.db=t,this.cr=new Ta(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,function(t,n){return e(n)})},t.prototype.Do=function(t,e,n){return Rc(t,n)},t.prototype.No=function(t,e,n){return Rc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return Rc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return $a(t).fi(function(r){return Ba(t,r,e).next(function(t){return t&&(n=!0),Hu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,function(s,u){if(u<=e){var a=n.bc(t,s).next(function(e){if(!e)return o++,r.Jn(t,s).next(function(){return r.Hn(s),Nc(t).delete([0,ja(s.path)])})});i.push(a)}}).next(function(){return Hu.qn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return Rc(t,e)},t.prototype.vc=function(t,e){var n,r=Nc(t),i=ia.Ds;return r._i({index:fc.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==ia.Ds&&e(new Ri(Na(n)),i),i=s,n=o):i=ia.Ds}).next(function(){i!==ia.Ds&&e(new Ri(Na(n)),i)})},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function Rc(t,e){return Nc(t).put(function(t,e){return new fc(0,ja(t.path),e)}(e,t.Fo))}function Uc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Lc=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Ji(Ci),this.Nc=new Yu(function(t){return Bi(t)},zi),this.xc=Di.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new na(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Rr(n,e.Cc)})},t}();function Vc(t,e,n,r){return new Lc(t,e,n,r)}function qc(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:return n=gi(t),r=n.rs,i=n.Oc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.rs.Mr(t).next(function(s){return o=s,r=n.persistence.mc(e),i=new na(n.Fc,r,n.persistence.Pc()),r.Mr(t)}).next(function(e){for(var n=[],r=[],s=ho(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,p=e;f<p.length;f++){var d=p[f];r.push(d.batchId);for(var b=0,v=d.mutations;b<v.length;b++)s=s.add(v[b].key)}return i._s(t,s).next(function(t){return{kc:t,$c:n,Lc:r}})})})];case 1:return o=s.sent(),[2,(n.rs=r,n.Oc=i,n.Dc.Mc(n.Oc),o)]}})})}function Fc(t,e){var n=gi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Hu.resolve();return o.forEach(function(t){s=s.next(function(){return r.Jn(e,t)}).next(function(e){var o=e,s=n.Sn.get(t);vi(null!==s),(!o||o.version.F(s)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)})}),s.next(function(){return t.rs.$r(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}function Bc(t){var e=gi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function zc(t,e){var n=gi(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var s=[];e.re.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.jo.Co(t,e.de,o).next(function(){return n.jo.So(t,e._e,o)}));var a=e.resumeToken;if(a.ht()>0){var c=u.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return vi(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(u,c,e)&&s.push(n.jo.yo(t,c))}}});var u=io();if(e.ce.forEach(function(r,i){e.ue.has(r)&&s.push(n.persistence.Vr.Sc(t,r))}),s.push(function(t,e,n,r,i){var o=ho();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=io();return n.forEach(function(n,o){var s=t.get(n),u=r;o instanceof fu&&o.version.isEqual(Di.min())?(e.Hn(n,u),i=i.Tt(n,o)):null==s||o.version.F(s.version)>0||0===o.version.F(s.version)&&s.hasPendingWrites?(e.jn(o,u),i=i.Tt(n,o)):li("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),i})}(t,o,e.ce,r).next(function(t){u=t})),!r.isEqual(Di.min())){var a=n.jo.To(t).next(function(e){return n.jo.mo(t,t.Fo,r)});s.push(a)}return Hu.qn(s).next(function(){return o.apply(t)}).next(function(){return n.Oc.fs(t,u)})}).then(function(t){return n.Cc=i,t})}function Gc(t,e){var n=gi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)})}function Kc(t,e){var n=gi(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.jo.bo(t,e).next(function(i){return i?Hu.resolve(r=i):n.jo.fo(t).next(function(i){return r=new Yi(e,i,0,t.Fo),n.jo.Ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t})}function $c(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:r=gi(t),i=r.Cc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Vr.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!ca(s=u.sent()))throw s;return li("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Cc=r.Cc.remove(e),r.Nc.delete(i.target),[2]}})})}function Wc(t,e,n){var r=gi(t),i=Di.min(),o=ho();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=gi(t),i=r.Nc.get(n);return void 0!==i?Hu.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,Eu(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Dc.ws(t,e,n?i:Di.min(),n?o:ho())}).next(function(t){return{documents:t,Bc:o}})})}function Yc(t,e){var n=gi(t),r=gi(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Hc(t){var e=gi(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=gi(t),i=io(),o=Pa(n),s=Qa(e),u=IDBKeyRange.lowerBound(o,!0);return s._i({index:cc.readTimeIndex,range:u},function(t,e){var n=Da(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:Sa(o)}})}(e.Fc,t,e.xc)}).then(function(t){var n=t.qc;return e.xc=t.readTime,n})}function Qc(t){return Object(Z.b)(this,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){return[2,(e=gi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Qa(t),n=Di.min();return e._i({index:cc.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Sa(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.xc=t})]})})}function Xc(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){if(t.code!==yi.FAILED_PRECONDITION||t.message!==ta)throw t;return li("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Jc=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new oa(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,e){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(n){switch(n.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():e&&e.code===yi.RESOURCE_EXHAUSTED?(fi(e.toString()),fi("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===yi.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(e)];case 1:return n.sent(),[2]}})})},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then(function(e){t.Wc===n&&t.iu(e)},function(n){e(function(){var e=new mi(yi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)})})},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return Object(Z.b)(t,void 0,void 0,function(){return Object(Z.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.ru=function(t){return li("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri(function(){return e.Wc===t?n():(li("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Zc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(Z.c)(e,t),e.prototype.ou=function(t){return this.Qc.uu("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:bi()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(vi(void 0===e||"string"==typeof e),Ki.fromBase64String(e||"")):(vi(void 0===e||e instanceof Uint8Array),Ki.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?yi.UNKNOWN:Xi(t.code);return new mi(e,t.message||"")}(s);n=new Oo(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=as(t,a.document.name),h=is(a.document.updateTime),l=new uu({mapValue:{fields:a.document.fields}}),f=new lu(c,h,l,{});n=new mo(a.targetIds||[],a.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){var p=e.documentDelete,d=as(t,p.document),b=p.readTime?is(p.readTime):Di.min(),v=new fu(d,b);n=new mo([],p.removedTargetIds||[],v.key,v)}else if("documentRemove"in e){var g=e.documentRemove,y=as(t,g.document);n=new mo([],g.removedTargetIds||[],y,null)}else{if(!("filter"in e))return bi();var m=e.filter,w=new Hi(m.count||0);n=new wo(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Di.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Di.min():e.readTime?is(e.readTime):Di.min()}(t);return this.listener.au(e,n)},e.prototype.hu=function(t){var e={};e.database=ls(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Gi(r)?{documents:vs(t,r)}:{query:gs(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=ns(t,e.resumeToken):e.ft.F(Di.min())>0&&(n.readTime=es(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return bi()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Zc(e)},e.prototype.lu=function(t){var e={};e.database=ls(this.serializer),e.removeTarget=t,this.Zc(e)},e}(Jc),th=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s._u=!1,s}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.eu=function(){this._u&&this.du([])},e.prototype.ou=function(t){return this.Qc.uu("Write",t)},e.prototype.onMessage=function(t){if(vi(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(vi(void 0!==e),t.map(function(t){return function(t,e){var n=is(t.updateTime?t.updateTime:e);n.isEqual(Di.min())&&(n=is(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Gs(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=is(t.commitTime);return this.listener.wu(n,e)}return vi(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},e.prototype.Tu=function(){var t={};t.database=ls(this.serializer),this.Zc(t)},e.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ds(e.serializer,t)})};this.Zc(n)},e}(Jc),eh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return Object(Z.c)(e,t),e.prototype.mu=function(){if(this.Iu)throw new mi(yi.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Au(t,e,n,i)}).catch(function(t){throw t.code===yi.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Ru(t,e,n,i)}).catch(function(t){throw t.code===yi.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.terminate=function(){this.Iu=!1},e}(function(){}),nh=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(fi(e),this.Vu=!1):li("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),rh=function(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return Object(Z.b)(o,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return fh(this)?(li("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Z.b)(this,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){switch(n.label){case 0:return(e=gi(t)).Mu.add(4),[4,oh(e)];case 1:return n.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,ih(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new nh(n,r)};function ih(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:if(!fh(t))return[3,4];e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oh(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sh(t,e){var n=gi(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),lh(n)?hh(n):Ch(n).zc()&&ah(n,e))}function uh(t,e){var n=gi(t),r=Ch(n);n.Ou.delete(e),r.zc()&&ch(n,e),0===n.Ou.size&&(r.zc()?r.Yc():fh(n)&&n.Bu.set("Unknown"))}function ah(t,e){t.qu.De(e.targetId),Ch(t).hu(e)}function ch(t,e){t.qu.De(e),Ch(t).lu(e)}function hh(t){t.qu=new Eo({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),Ch(t).start(),t.Bu.pu()}function lh(t){return fh(t)&&!Ch(t).Gc()&&t.Ou.size>0}function fh(t){return 0===gi(t).Mu.size}function ph(t){t.qu=void 0}function dh(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){return t.Ou.forEach(function(e,n){ah(t,e)}),[2]})})}function bh(t,e){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(n){return ph(t),lh(t)?(t.Bu.Su(e),hh(t)):t.Bu.set("Unknown"),[2]})})}function vh(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:if(t.Bu.set("Online"),!(e instanceof Oo&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Ou.has(o=i[r])?[4,t.xu.Uu(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Ou.delete(o),t.qu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),li("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,gh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof mo?t.qu.$e(e):e instanceof wo?t.qu.je(e):t.qu.qe(e),n.isEqual(Di.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Bc(t.Cu)];case 8:return i=s.sent(),n.F(i)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach(function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(Ki.lt,n.ft)),ch(t,e);var r=new Yi(n.target,e,1,n.sequenceNumber);ah(t,r)}}),t.xu.Qu(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return li("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,gh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function gh(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r=this;return Object(Z.d)(this,function(i){switch(i.label){case 0:if(!ca(e))throw e;return t.Mu.add(1),[4,oh(t)];case 1:return i.sent(),t.Bu.set("Offline"),n||(n=function(){return Bc(t.Cu)}),t.di.Mi(function(){return Object(Z.b)(r,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return li("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Mu.delete(1),[4,ih(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function yh(t,e){return e().catch(function(n){return gh(t,n,e)})}function mh(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:e=gi(t),n=Ah(e),r=e.Fu.length>0?e.Fu[e.Fu.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return fh(t)&&t.Fu.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Gc(e.Cu,r)];case 3:return null===(i=s.sent())?(0===e.Fu.length&&n.Yc(),[3,7]):(r=i.batchId,function(t,e){t.Fu.push(e);var n=Ah(t);n.zc()&&n.fu&&n.du(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,gh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return wh(e)&&Oh(e),[2]}})})}function wh(t){return fh(t)&&!Ah(t).Gc()&&t.Fu.length>0}function Oh(t){Ah(t).start()}function Ih(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){return Ah(t).Tu(),[2]})})}function Eh(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n,r;return Object(Z.d)(this,function(i){for(e=Ah(t),n=0,r=t.Fu;n<r.length;n++)e.du(r[n].mutations);return[2]})})}function _h(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:return r=t.Fu.shift(),i=Wu.from(r,e,n),[4,yh(t,function(){return t.xu.Ku(i)})];case 1:return o.sent(),[4,mh(t)];case 2:return o.sent(),[2]}})})}function Th(t,e){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(n){switch(n.label){case 0:return e&&Ah(t).fu?[4,function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r;return Object(Z.d)(this,function(i){switch(i.label){case 0:return Qi(r=e.code)&&r!==yi.ABORTED?(n=t.Fu.shift(),Ah(t).Jc(),[4,yh(t,function(){return t.xu.Wu(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,mh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return wh(t)&&Oh(t),[2]}})})}function jh(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n;return Object(Z.d)(this,function(r){switch(r.label){case 0:return n=gi(t),e?(n.Mu.delete(2),[4,ih(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Mu.add(2),[4,oh(n)]);case 3:r.sent(),n.Bu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Ch(t){var e=this;return t.ju||(t.ju=function(t,e,n){var r=gi(t);return r.mu(),new Zc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:dh.bind(null,t),nu:bh.bind(null,t),au:vh.bind(null,t)}),t.ku.push(function(n){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return n?(t.ju.Jc(),lh(t)?hh(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),ph(t),e.label=3;case 3:return[2]}})})})),t.ju}function Ah(t){var e=this;return t.Gu||(t.Gu=function(t,e,n){var r=gi(t);return r.mu(),new th(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Ih.bind(null,t),nu:Th.bind(null,t),Eu:Eh.bind(null,t),wu:_h.bind(null,t)}),t.ku.push(function(n){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return n?(t.Gu.Jc(),[4,mh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(li("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}})})})),t.Gu}var Nh=function(){this.zu=void 0,this.listeners=[]},kh=function(){this.queries=new Yu(function(t){return ju(t)},Tu),this.onlineState="Unknown",this.Hu=new Set};function Dh(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(Z.d)(this,function(c){switch(c.label){case 0:if(n=gi(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Nh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Ju(r)];case 2:return s.zu=c.sent(),[3,4];case 3:return u=c.sent(),a=ma(u,"Initialization of query '"+Cu(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Yu(n.onlineState),o.zu&&e.Xu(o.zu)&&Mh(n),[2]}})})}function xh(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Z.d)(this,function(u){return n=gi(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Zu(r))]:[2]})})}function Ph(t,e){for(var n=gi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&Mh(n)}function Sh(t,e,n){var r=gi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Mh(t){t.Hu.forEach(function(t){t.next()})}var Rh=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vo(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){return!t.fromCache||!(this.options.oa&&"Offline"!==e||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){return t.docChanges.length>0||!!(t.ne||this.na&&this.na.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=vo.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),Uh=function(){function t(){this.ca=new eo(Lh.ua),this.aa=new eo(Lh.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new Lh(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},t.prototype.No=function(t,e){this._a(new Lh(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},t.prototype.da=function(t){var e=this,n=new Ri(new Pi([])),r=new Lh(n,t),i=new Lh(n,t+1),o=[];return this.aa.Kt([r,i],function(t){e._a(t),o.push(t.key)}),o},t.prototype.wa=function(){var t=this;this.ca.forEach(function(e){return t._a(e)})},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new Ri(new Pi([])),n=new Lh(e,t),r=new Lh(e,t+1),i=ho();return this.aa.Kt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Qr=function(t){var e=new Lh(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),Lh=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return Ri.$(t.key,e.key)||Ci(t.Ta,e.Ta)},t.ha=function(t,e){return Ci(t.Ta,e.Ta)||Ri.$(t.key,e.key)},t}();function Vh(t,e){return"firestore_clients_"+t+"_"+e}function qh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function Fh(t,e){return"firestore_targets_"+t+"_"+e}var Bh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new mi(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(fi("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),zh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new mi(r.error.code,r.error.message)),i?new t(e,r.state,o):(fi("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Gh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=fo(),s=0;i&&s<r.activeTargetIds.length;++s)i=Vi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(fi("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Kh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(fi("SharedClientState","Failed to parse online state: "+e),null)},t}(),$h=function(){function t(){this.activeTargetIds=fo()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Wh=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Ji(Ci),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=Vh(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new $h),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Z.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(Z.d)(this,function(l){switch(l.label){case 0:return[4,this.ga.Ic()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(Vh(this.persistenceKey,r)))&&(o=Gh.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)this.Va(c[a]);return this.va=[],this.window.addEventListener("unload",function(){return h.fc()}),this.lr=!0,[2]}})})},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(Fh(this.persistenceKey,t));if(n){var r=zh.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(Fh(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return li("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){li("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){li("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(li("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ba)return void fi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return Object(Z.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Z.d)(this,function(u){if(this.lr){if(null!==n.key)if(this.Da.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.uh(r)]}else if(this.Na.test(n.key)){if(null!==n.newValue&&(i=this.ah(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xa){if(null!==n.newValue&&(o=this.Ma(n.newValue)))return[2,this.ka(o)]}else if(n.key===this.Sa)(s=function(t){var e=ia.Ds;if(null!=t)try{var n=JSON.parse(t);vi("number"==typeof n),e=n}catch(t){fi("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ia.Ds&&this.ps(s);else if(n.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new Bh(this.currentUser,t,e,n),i=qh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=qh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xa,JSON.stringify({clientId:this.Pa,onlineState:t}))},t.prototype.Ya=function(t,e,n){var r=Fh(this.persistenceKey,t),i=new zh(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return Gh.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]);return Bh.Ia(new ai(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return zh.Ia(r,e)},t.prototype.Ma=function(t){return Kh.Ia(t)},t.prototype.uh=function(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(li("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=fo();return t.forEach(function(t,n){e=e.Gt(n.activeTargetIds)}),e},t}(),Yh=function(){function t(){this.wh=new $h,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new $h,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),Hh=function(t){this.key=t},Qh=function(t){this.key=t},Xh=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=ho(),this.ee=ho(),this.Ah=Nu(t),this.Rh=new po(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new bo,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,s=i,u=!1,a=gu(this.query)&&i.size===this.query.limit?i.last():null,c=yu(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt(function(t,e){var h=i.get(t),l=e instanceof lu?e:null;l&&(l=Au(n.query,l)?l:null);var f=!!h&&n.ee.has(h.key),p=!!l&&(l.an||n.ee.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.Vh(h,l)||(r.track({type:2,doc:l}),d=!0,(a&&n.Ah(l,a)>0||c&&n.Ah(l,c)<0)&&(u=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),gu(this.query)||yu(this.query))for(;s.size>this.query.limit;){var h=gu(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,yh:r,ph:u,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bi()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var s=e?this.Sh():[],u=0===this.mh.size&&this.le?1:0,a=u!==this.Ih;return this.Ih=u,0!==o.length||a?{snapshot:new vo(this.query,t.Rh,i,o,t.ee,0===u,a,!1),Dh:s}:{Dh:s}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new bo,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=ho(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new Qh(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new Hh(t))}),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=ho();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return vo.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),Jh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Zh=function(t){this.key=t,this.Fh=!1},tl=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Yu(function(t){return ju(t)},Tu),this.qh=new Map,this.Uh=[],this.Qh=new Ji(Ri.$),this.Kh=new Map,this.Wh=new Uh,this.jh={},this.Gh=new Map,this.zh=Tc._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function el(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:return n=kl(t),(i=n.Bh.get(e))?(n.kh.Wa(i.targetId),r=i.view.xh(),[3,4]):[3,1];case 1:return[4,Kc(n.Cu,Eu(e))];case 2:return o=u.sent(),s=n.kh.Wa(o.targetId),[4,nl(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.Jh&&sh(n.Oh,o),u.label=4;case 4:return[2,r]}})})}function nl(t,e,n,r){return Object(Z.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(Z.d)(this,function(h){switch(h.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return Object(Z.b)(this,void 0,void 0,function(){var i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:return(i=e.view.gh(n)).ph?[4,Wc(t.Cu,e.query,!1).then(function(t){return e.view.gh(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.re.get(e.targetId),s=e.view.Zn(i,t.Jh,o),[2,(bl(t,e.targetId,s.Dh),s.snapshot)]}})})}(t,e,n,r)},[4,Wc(t.Cu,e,!0)];case 1:return i=h.sent(),o=new Xh(e,i.Bc),s=o.gh(i.documents),u=yo.he(n,r&&"Offline"!==t.onlineState),a=o.Zn(s,t.Jh,u),bl(t,n,a.Dh),c=new Jh(e,n,o),[2,(t.Bh.set(e,c),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),a.snapshot)]}})})}function rl(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:return n=gi(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter(function(t){return!Tu(t,e)})),void n.Bh.delete(e))]:n.Jh?(n.kh.Ga(r.targetId),n.kh.Ba(r.targetId)?[3,2]:[4,$c(n.Cu,r.targetId,!1).then(function(){n.kh.Ha(r.targetId),uh(n.Oh,r.targetId),pl(n,r.targetId)}).catch(Xc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return pl(n,r.targetId),[4,$c(n.Cu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function il(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:r=Dl(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=gi(t),i=ki.now(),o=e.reduce(function(t,e){return t.add(e.key)},ho());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Oc._s(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Qs(c,n.get(c.key));null!=h&&s.push(new tu(c.key,h,cu(h.proto.mapValue),Ks.exists(!0)))}return r.rs.Sr(t,i,s,e)})}).then(function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}})}(r.Cu,e)];case 2:return i=u.sent(),r.kh.qa(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new Ji(Ci)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(r,i.batchId,n),[4,yl(r,i.Qn)];case 3:return u.sent(),[4,mh(r.Oh)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=ma(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function ol(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r;return Object(Z.d)(this,function(i){switch(i.label){case 0:n=gi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,zc(n.Cu,e)];case 2:return r=i.sent(),e.re.forEach(function(t,e){var r=n.Kh.get(e);r&&(vi(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?vi(r.Fh):t.de.size>0&&(vi(r.Fh),r.Fh=!1))}),[4,yl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Xc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function sl(t,e,n){var r=gi(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=gi(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)}),r&&Mh(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function ul(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(Z.d)(this,function(c){switch(c.label){case 0:return(r=gi(t)).kh.Ja(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(s=(s=new Ji(Ri.$)).Tt(o,new fu(o,Di.min())),u=ho().add(o),a=new go(Di.min(),new Map,new eo(Ci),s,u),[4,ol(r,a)]):[3,2];case 1:return c.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),gl(r),[3,4];case 2:return[4,$c(r.Cu,e,!1).then(function(){return pl(r,e,n)}).catch(Xc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function al(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:n=gi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Fc(n.Cu,e)];case 2:return i=o.sent(),fl(n,r,null),ll(n,r),n.kh.Qa(r,"acknowledged"),[4,yl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Xc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function cl(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:r=gi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=gi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.rs.Cr(t,e).next(function(e){return vi(null!==e),r=e.keys(),n.rs.$r(t,e)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}(r.Cu,e)];case 2:return i=o.sent(),fl(r,e,n),ll(r,e),r.kh.Qa(e,"rejected",n),[4,yl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Xc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function hl(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:fh((n=gi(t)).Oh)||li("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=gi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})}(n.Cu)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=u.sent(),s=ma(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function ll(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function fl(t,e,n){var r=gi(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function pl(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach(function(e){t.Wh.Qr(e)||dl(t,e)})}function dl(t,e){var n=t.Qh.get(e);null!==n&&(uh(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),gl(t))}function bl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Hh?(t.Wh.Do(o.key,e),vl(t,o)):o instanceof Qh?(li("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||dl(t,o.key)):bi()}}function vl(t,e){var n=e.key;t.Qh.get(n)||(li("SyncEngine","New document in limbo: "+n),t.Uh.push(n),gl(t))}function gl(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Zh(e)),t.Qh=t.Qh.Tt(e,n),sh(t.Oh,new Yi(Eu(vu(e.path)),n,2,ia.Ds))}}function yl(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:return r=gi(t),i=[],o=[],s=[],r.Bh.W()?[3,3]:(r.Bh.forEach(function(t,u){s.push(r.Yh(u,e,n).then(function(t){if(t){r.Jh&&r.kh.Ja(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ra.Vs(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.Lh.au(i),[4,function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(Z.d)(this,function(h){switch(h.label){case 0:n=gi(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Hu.forEach(e,function(e){return Hu.forEach(e.gs,function(r){return n.persistence.Vr.Do(t,e.targetId,r)}).next(function(){return Hu.forEach(e.ys,function(r){return n.persistence.Vr.No(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!ca(r=h.sent()))throw r;return li("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.Cc.get(u),c=a.Et(a.ft),n.Cc=n.Cc.Tt(u,c));return[2]}})})}(r.Cu,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function ml(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r;return Object(Z.d)(this,function(i){switch(i.label){case 0:return(n=gi(t)).currentUser.isEqual(e)?[3,3]:(li("SyncEngine","User change. New user:",e.h()),[4,qc(n.Cu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new mi(yi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(n),n.kh.Xa(e,r.$c,r.Lc),[4,yl(n,r.kc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function wl(t,e){var n=gi(t),r=n.Kh.get(e);if(r&&r.Fh)return ho().add(r.key);var i=ho(),o=n.qh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Bh.get(u[s]);i=i.Gt(a.view.Ph)}return i}function Ol(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:return[4,Wc((n=gi(t)).Cu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&bl(n,e.targetId,i.Dh),i)]}})})}function Il(t){return Object(Z.b)(this,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){return[2,Hc((e=gi(t)).Cu).then(function(t){return yl(e,t)})]})})}function El(t,e,n,r){return Object(Z.b)(this,void 0,void 0,function(){var i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=gi(t),r=gi(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Nr(t,e).next(function(e){return e?n.Oc._s(t,e):Hu.resolve(null)})})}((i=gi(t)).Cu,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,mh(i.Oh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(fl(i,e,r||null),ll(i,e),function(t,e){gi(gi(t).rs).Br(e)}(i.Cu,e)):bi(),s.label=4;case 4:return[4,yl(i,o)];case 5:return s.sent(),[3,7];case 6:li("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function _l(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(Z.d)(this,function(c){switch(c.label){case 0:return kl(n=gi(t)),Dl(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$a(),[4,Tl(n,r.H())]);case 1:return i=c.sent(),n.Hh=!0,[4,jh(n.Oh,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)sh(n.Oh,s[o]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(u=[],a=Promise.resolve(),n.qh.forEach(function(t,e){n.kh.za(e)?u.push(e):a=a.then(function(){return pl(n,e),$c(n.Cu,e,!0)}),uh(n.Oh,e)}),[4,a]);case 4:return c.sent(),[4,Tl(n,u)];case 5:return c.sent(),function(t){var e=gi(t);e.Kh.forEach(function(t,n){uh(e.Oh,n)}),e.Wh.wa(),e.Kh=new Map,e.Qh=new Ji(Ri.$)}(n),n.Hh=!1,[4,jh(n.Oh,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Tl(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,l,f,p,d;return Object(Z.d)(this,function(b){switch(b.label){case 0:n=gi(t),r=[],i=[],o=0,s=e,b.label=1;case 1:return o<s.length?(a=void 0,(c=n.qh.get(u=s[o]))&&0!==c.length?[4,Kc(n.Cu,Eu(c[0]))]:[3,7]):[3,13];case 2:a=b.sent(),h=0,l=c,b.label=3;case 3:return h<l.length?(f=n.Bh.get(l[h]),[4,Ol(n,f)]):[3,6];case 4:(p=b.sent()).snapshot&&i.push(p.snapshot),b.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Yc(n.Cu,u)];case 8:return d=b.sent(),[4,Kc(n.Cu,d)];case 9:return a=b.sent(),[4,nl(n,jl(d),u,!1)];case 10:b.sent(),b.label=11;case 11:r.push(a),b.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.au(i),r)]}})})}function jl(t){return bu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Cl(t){var e=gi(t);return gi(gi(e.Cu).persistence).Ic()}function Al(t,e,n,r){return Object(Z.b)(this,void 0,void 0,function(){var i,o,s;return Object(Z.d)(this,function(u){switch(u.label){case 0:return(i=gi(t)).Hh?(li("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Hc(i.Cu)];case 3:return o=u.sent(),s=go.ae(e,"current"===n),[4,yl(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,$c(i.Cu,e,!0)];case 6:return u.sent(),pl(i,e,r),[3,8];case 7:bi(),u.label=8;case 8:return[2]}})})}function Nl(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,l;return Object(Z.d)(this,function(f){switch(f.label){case 0:if(!(r=kl(t)).Hh)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.qh.has(s=o[i])?(li("SyncEngine","Adding an already active target "+s),[3,5]):[4,Yc(r.Cu,s)]:[3,6];case 2:return u=f.sent(),[4,Kc(r.Cu,u)];case 3:return a=f.sent(),[4,nl(r,jl(u),a.targetId,!1)];case 4:f.sent(),sh(r.Oh,a),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Z.d)(this,function(e){switch(e.label){case 0:return r.qh.has(t)?[4,$c(r.Cu,t,!1).then(function(){uh(r.Oh,t),pl(r,t)}).catch(Xc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function kl(t){var e=gi(t);return e.Oh.xu.Qu=ol.bind(null,e),e.Oh.xu.Xe=wl.bind(null,e),e.Oh.xu.Uu=ul.bind(null,e),e.Lh.au=Ph.bind(null,e.Mh),e.Lh.Xh=Sh.bind(null,e.Mh),e}function Dl(t){var e=gi(t);return e.Oh.xu.Ku=al.bind(null,e),e.Oh.xu.Wu=cl.bind(null,e),e}var xl=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(Di.min())?this.tl(t,e):this.Zh._s(t,r).next(function(o){var s=i.el(e,o);return(gu(e)||yu(e))&&i.ph(e.limitType,s,r,n)?i.tl(t,e):(hi()<=et.a.DEBUG&&li("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Cu(e)),i.Zh.ws(t,e,n).next(function(t){return s.forEach(function(e){t=t.Tt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new eo(Nu(t));return e.forEach(function(e,r){r instanceof lu&&Au(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return hi()<=et.a.DEBUG&&li("IndexFreeQueryEngine","Using full collection scan to execute query:",Cu(e)),this.Zh.ws(t,e,Di.min())},t}(),Pl=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new eo(Lh.ua)}return t.prototype.br=function(t){return Hu.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new $u(i,e,n,r);this.rs.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new Lh(a.key,i)),this.os.Dr(t,a.key.path.q())}return Hu.resolve(o)},t.prototype.Cr=function(t,e){return Hu.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return Hu.resolve(this.rs.length>r?this.rs[r]:null)},t.prototype.Or=function(){return Hu.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return Hu.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new Lh(e,0),i=new Lh(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],function(t){var e=n.il(t.Ta);o.push(e)}),Hu.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new eo(Ci);return e.forEach(function(t){var e=new Lh(t,0),i=new Lh(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],function(t){r=r.add(t.Ta)})}),Hu.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;Ri.ot(i)||(i=i.child(""));var o=new Lh(new Ri(i),0),s=new eo(Ci);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(s=s.add(t.Ta)),!0)},o),Hu.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.$r=function(t,e){var n=this;vi(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return Hu.forEach(e.mutations,function(i){var o=new Lh(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)}).next(function(){n.sl=r})},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new Lh(e,0),r=this.sl.jt(n);return Hu.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return Hu.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),Sl=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new Ji(Ri.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:s,readTime:n}),this.size+=s-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return Hu.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=oo();return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),Hu.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=uo(),i=new Ri(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.value,a=u.zn,c=u.readTime;if(!e.path.j(s.key.path))break;c.F(n)<=0||a instanceof lu&&Au(e,a)&&(r=r.Tt(a.key,a))}return Hu.resolve(r)},t.prototype.al=function(t,e){return Hu.forEach(this.docs,function(t){return e(t)})},t.prototype.Xr=function(t){return new Ml(this)},t.prototype.eo=function(t){return Hu.resolve(this.size)},t}(),Ml=function(t){function e(e){var n=this;return(n=t.call(this)||this).no=e,n}return Object(Z.c)(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach(function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)}),Hu.qn(n)},e.prototype.Yn=function(t,e){return this.no.Jn(t,e)},e.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},e}(Qu),Rl=function(){function t(t){this.persistence=t,this.hl=new Yu(function(t){return Bi(t)},zi),this.lastRemoteSnapshotVersion=Di.min(),this.highestTargetId=0,this.ll=0,this._l=new Uh,this.targetCount=0,this.fl=Tc.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),Hu.resolve()},t.prototype.To=function(t){return Hu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return Hu.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),Hu.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Hu.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Tc(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,Hu.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),Hu.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,Hu.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.po(t,u.targetId)),i++)}),Hu.qn(o).next(function(){return i})},t.prototype.vo=function(t){return Hu.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return Hu.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),Hu.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach(function(e){i.push(r.qr(t,e))}),Hu.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),Hu.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return Hu.resolve(n)},t.prototype.Qr=function(t,e){return Hu.resolve(this._l.Qr(e))},t}(),Ul=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return Hu.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:is(n.createTime)}),Hu.resolve()},t.prototype.co=function(t,e){return Hu.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:qa(n.bundledQuery),readTime:is(n.readTime)}),Hu.resolve()},t}(),Ll=function(){function t(t,e){var n=this;this.El={},this.ko=new ia(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new Rl(this),this.os=new Za,this.ss=function(t,e){return new Sl(t,function(t){return n.Vr.Tl(t)})}(this.os),this.serializer=new ka(e),this.Go=new Ul(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Pl(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;li("MemoryPersistence","Starting transaction:",t);var i=new Vl(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},t.prototype.Al=function(t,e){return Hu.Un(Object.values(this.El).map(function(n){return function(){return n.Qr(t,e)}}))},t}(),Vl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return Object(Z.c)(e,t),e}(ea),ql=function(){function t(t){this.persistence=t,this.Rl=new Uh,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw bi()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),Hu.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),Hu.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),Hu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return Hu.forEach(this.yl,function(r){var i=Ri.st(r);return e.Vl(t,i).next(function(t){t||n.Hn(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return Hu.Un([function(){return Hu.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),Fl=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),Bl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zl=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(Z.c)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise(function(i,o){var s=new ii;s.listenOnce(ei.COMPLETE,function(){try{switch(s.getLastErrorCode()){case ti.NO_ERROR:var e=s.getResponseJson();li("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ti.TIMEOUT:li("Connection",'RPC "'+t+'" timed out'),o(new mi(yi.DEADLINE_EXCEEDED,"Request time out"));break;case ti.HTTP_ERROR:var n=s.getStatus();if(li("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(yi).indexOf(e)>=0?e:yi.UNKNOWN}(r.status);o(new mi(u,r.message))}else o(new mi(yi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new mi(yi.UNAVAILABLE,"Connection failed."));break;default:bi()}}finally{li("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Hr,i=Xe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(o.initMessageHeaders,e),Object(nt.l)()||Object(nt.n)()||Object(nt.j)()||Object(nt.k)()||Object(nt.o)()||Object(nt.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");li("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Fl({pl:function(t){c?li("Connection","Not sending because WebChannel is closed:",t):(a||(li("Connection","Opening WebChannel transport."),u.open(),a=!0),li("Connection","WebChannel sending:",t),u.send(t))},vl:function(){return u.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(u,ri.EventType.OPEN,function(){c||li("Connection","WebChannel transport opened.")}),l(u,ri.EventType.CLOSE,function(){c||(c=!0,li("Connection","WebChannel transport closed"),h.Nl())}),l(u,ri.EventType.ERROR,function(t){c||(c=!0,pi("Connection","WebChannel transport errored:",t),h.Nl(new mi(yi.UNAVAILABLE,"The operation could not be completed")))}),l(u,ri.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];vi(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){li("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=$i[t];if(void 0!==e)return Xi(e)}(i),s=r.message;void 0===o&&(o=yi.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new mi(o,s)),u.close()}else li("Connection","WebChannel received:",n),h.xl(n)}}),l(i,ni.STAT_EVENT,function(t){10===t.stat?li("Connection","Detected buffering proxy"):11===t.stat&&li("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Cl()},0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);li("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return li("RestConnection","Received: ",t),t},function(e){throw pi("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+Bl[t]},t}()),Gl=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){li("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){li("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Kl=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),$l=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return this.serializer=Ju(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Vc(this.persistence,new xl,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new Ll(ql.gl,this.serializer)},t.prototype.jl=function(t){return new Yh},t.prototype.terminate=function(){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},t}(),Wl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Z.c)(e,t),e.prototype.initialize=function(e){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Qc(this.Cu)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Dl(this.Xl.ga)];case 4:return n.sent(),[4,mh(this.Xl.Oh)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return Vc(this.persistence,new xl,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new _a(this.persistence.Vr.cr,t.di)},e.prototype.Gl=function(t){var e=Uc(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Ea.er(this.cacheSizeBytes):Ea.ir;return new xc(this.synchronizeTabs,e,t.clientId,n,t.di,ba(),va(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new Yh},e}($l),Yl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Z.c)(e,t),e.prototype.initialize=function(e){return Object(Z.b)(this,void 0,void 0,function(){var n,r=this;return Object(Z.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.ga,this.kh instanceof Wh?(this.kh.ga={_h:El.bind(null,n),fh:Al.bind(null,n),dh:Nl.bind(null,n),Ic:Cl.bind(null,n),lh:Il.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Zo(function(t){return Object(Z.b)(r,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,_l(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=ba();if(!Wh.Gs(e))throw new mi(yi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Uc(t.Fl.t,t.Fl.persistenceKey);return new Wh(e,t.di,n,t.clientId,t.Yl)},e}(Wl),Hl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n=this;return Object(Z.d)(this,function(r){switch(r.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.ga=this.n_(e,!t.synchronizeTabs),this.kh.Pu=function(t){return sl(n.ga,t,1)},this.Oh.xu.s_=ml.bind(null,this.ga),[4,jh(this.Oh,this.ga.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new kh},t.prototype.Zl=function(t){var e=Ju(t.Fl.t),n=new zl(t.Fl);return function(t,e,n){return new eh(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return sl(s.ga,t,0)},o=Gl.Gs()?new Gl:new Kl,new rh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new tl(t,e,n,r,i,o);return s&&(u.Hh=!0),u}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return Object(Z.b)(this,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){switch(n.label){case 0:return e=gi(t),li("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,oh(e)];case 1:return n.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},t}(),Ql=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Xl=function(t){this.o_=t};function Jl(t,e,n){if(!n)throw new mi(yi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Zl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new mi(yi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function tf(t,e,n,r){if(!0===e&&!0===r)throw new mi(yi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function ef(t){if(!Ri.ot(t))throw new mi(yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function nf(t){if(Ri.ot(t))throw new mi(yi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function rf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":bi()}function of(t,e){if(t instanceof Xl&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new mi(yi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=rf(t);throw new mi(yi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function sf(t,e){if(e<=0)throw new mi(yi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var uf=function(t){this.c_=t},af=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.u_=function(t){if(2!==t.a_)throw t.h_(1===t.a_?this.c_+"() can only appear at the top level of your update data":this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(uf);function cf(t,e,n){return new fp({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var hf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.u_=function(t){return new zs(t.path,new Ss)},e.prototype.isEqual=function(t){return t instanceof e},e}(uf),lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(Z.c)(e,t),e.prototype.u_=function(t){var e=cf(this,t,!0),n=this.f_.map(function(t){return yp(t,e)}),r=new Ms(n);return new zs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(uf),ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(Z.c)(e,t),e.prototype.u_=function(t){var e=cf(this,t,!0),n=this.f_.map(function(t){return yp(t,e)}),r=new Us(n);return new zs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(uf),pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return Object(Z.c)(e,t),e.prototype.u_=function(t){var e=new Vs(t.serializer,ts(t.serializer,this.d_));return new zs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(uf),df=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new mi(yi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new mi(yi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return Ci(this.w_,t.w_)||Ci(this.E_,t.E_)},t}(),bf=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(Ki.fromBase64String(e))}catch(e){throw new mi(yi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ki.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),vf=new Map,gf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new mi(yi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new mi(yi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,tf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),yf=function(){function t(t,e){this.I_="(lite)",this.m_=new gf({}),this.A_=!1,t instanceof ui?(this.R_=t,this.P_=new Oi):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new mi(yi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ui(t.options.projectId)}(t),this.P_=new Ii(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new mi(yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new mi(yi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new gf(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Oi;switch(t.type){case"gapi":var e=t.client;return vi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new _i(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new mi(yi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return function(t){var e=vf.get(t);e&&(li("ComponentProvider","Removing Datastore"),vf.delete(t),e.terminate())}(this),Promise.resolve()},t}();function mf(){if("undefined"==typeof Uint8Array)throw new mi(yi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wf(){if("undefined"==typeof atob)throw new mi(yi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Of=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.fromBase64String=function(t){return wf(),new e(bf.fromBase64String(t))},e.fromUint8Array=function(t){return mf(),new e(bf.fromUint8Array(t))},e.prototype.toBase64=function(){return wf(),this.o_.toBase64()},e.prototype.toUint8Array=function(){return mf(),this.o_.toUint8Array()},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Xl),If=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),Po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Fo(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Bo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw bi()}},t.prototype.L_=function(t,e){var n=this,r={};return Co(t.fields||{},function(t,i){r[t]=n.C_(i,e)}),r},t.prototype.M_=function(t){return new df(Fo(t.latitude),Fo(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},t.prototype.x_=function(t,e){switch(e){case"previous":var n=ko(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(Do(t));default:return null}},t.prototype.N_=function(t){var e=qo(t);return new ki(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=Pi.Y(t);vi(Ns(n));var r=new ui(n.get(1),n.get(3)),i=new Ri(n.B(5));return r.isEqual(e)||fi("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Ef=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Z.c)(e,t),e.prototype.F_=function(t){return new Of(new bf(t))},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return Qp.q_(e,this.firestore,null)},e}(If),_f=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ff(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new Tf(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(jf("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),Tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(_f);function jf(t,e){return"string"==typeof e?_p(t,e):e instanceof Xl?e.o_.G_:e.G_}var Cf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new mi(yi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new Mi(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),Af=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new ya,r.I_="name"in e?e.name:"[DEFAULT]",r}return Object(Z.c)(e,t),e.prototype.D_=function(){return this.H_||Wp(this),this.H_.terminate()},e}(yf);function Nf(t,e,n){var r=this,i=new Xu;return t.di.enqueue(function(){return Object(Z.b)(r,void 0,void 0,function(){var r;return Object(Z.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,kp(t,n)];case 1:return o.sent(),[4,Dp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===yi.FAILED_PRECONDITION||t.code===yi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function kf(t){if(t.y_||t.V_)throw new mi(yi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Df=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).U_=e,u.J_=e,u.metadata=o,u}return Object(Z.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new xf(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(jf("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},e}(_f),xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Df),Pf=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new td(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach(function(r){t.call(e,new xf(n.U_,n.Q_,r.key,r,new td(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new mi(yi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map(function(e){return{type:"added",doc:new xf(t.U_,t.Q_,e.doc.key,e.doc,new td(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),oldIndex:-1,newIndex:n++}})}var r=t.Y_.te;return t.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new xf(t.U_,t.Q_,e.doc.key,e.doc,new td(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Sf(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Z_=e),this.X_},t}();function Sf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bi()}}function Mf(t,e){return t instanceof Df&&e instanceof Df?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Pf&&e instanceof Pf&&t.U_===e.U_&&sp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Rf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Z.c)(e,t),e.prototype.F_=function(t){return new bf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new Ff(this.firestore,null,e)},e}(If);function Uf(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=of(t.firestore,Af),s=up(o);return e instanceof Xl&&(e=e.o_),Vf(o,("string"==typeof e||e instanceof Cf?vp(s,"updateDoc",t.K_,e,n,r):bp(s,"updateDoc",t.K_,e)).ef(t.K_,Ks.exists(!0)))}function Lf(t){for(var e,n,r,i=this,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];var u={includeMetadataChanges:!1},a=0;"object"!=typeof o[a]||Zu(o[a])||(u=o[a],a++);var c,h,l,f={includeMetadataChanges:u.includeMetadataChanges};if(Zu(o[a])){var p=o[a];o[a]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[a+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[a+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof Ff)h=of(t.firestore,Af),l=vu(t.K_.path),c={next:function(e){o[a]&&o[a](qf(h,t,e))},error:o[a+1],complete:o[a+2]};else{h=of(t.firestore,Af),l=t.tf;var d=new Rf(h);c={next:function(e){o[a]&&o[a](new Pf(h,d,t,e))},error:o[a+1],complete:o[a+2]},tp(t.tf)}var b=$p(h),v=new Ql(c),g=new Rh(l,v,f);return h.z_.Ri(function(){return Object(Z.b)(i,void 0,void 0,function(){var t;return Object(Z.d)(this,function(e){switch(e.label){case 0:return t=Dh,[4,Lp(b)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})}),function(){v.r_(),h.z_.Ri(function(){return Object(Z.b)(i,void 0,void 0,function(){var t;return Object(Z.d)(this,function(e){switch(e.label){case 0:return t=xh,[4,Lp(b)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})})}}function Vf(t,e){return function(t,e){var n=this,r=new Xu;return t.di.Ri(function(){return Object(Z.b)(n,void 0,void 0,function(){var n;return Object(Z.d)(this,function(i){switch(i.label){case 0:return n=il,[4,Up(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}($p(t),e)}function qf(t,e,n){var r=n.docs.get(e.K_),i=new Rf(t);return new Df(t,i,e.K_,r,new td(n.hasPendingWrites,n.fromCache),e.j_)}var Ff=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ep(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),Bf=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),zf=function(){};function Gf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.sf(t)}return t}var Kf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return Object(Z.c)(e,t),e.prototype.sf=function(t){var e=up(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new mi(yi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Jf(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Xf(r,t,h[c]));u={arrayValue:{values:a}}}else u=Xf(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Jf(s,o),u=gp(n,"where",s,"in"===o||"not-in"===o);var l=ku.create(i,o,u);return function(t,e){if(e.An()){var n=wu(t);if(null!==n&&!n.isEqual(e.field))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=mu(t);null!==r&&Zf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new mi(yi.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Bf(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new du(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},e}(zf),$f=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return Object(Z.c)(e,t),e.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new mi(yi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new mi(yi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new zu(e,n);return function(t,e){if(null===mu(t)){var n=wu(t);null!==n&&Zf(0,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new Bf(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new du(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},e}(zf),Wf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return Object(Z.c)(e,t),e.prototype.sf=function(t){return new Bf(t.firestore,t.j_,_u(t.tf,this.hf,this.lf))},e}(zf),Yf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(Z.c)(e,t),e.prototype.sf=function(t){var e=Qf(t,this.type,this._f,this.ff);return new Bf(t.firestore,t.j_,function(t,e){return new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},e}(zf),Hf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(Z.c)(e,t),e.prototype.sf=function(t){var e=Qf(t,this.type,this._f,this.ff);return new Bf(t.firestore,t.j_,function(t,e){return new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},e}(zf);function Qf(t,e,n,r){if(n[0]instanceof Xl&&(n[0]=n[0].o_),n[0]instanceof _f)return function(t,e,n,r,i){if(!r)throw new mi(yi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Iu(t);s<u.length;s++){var a=u[s];if(a.field.tt())o.push(zo(e,r.key));else{var c=r.field(a.field);if(No(c))throw new mi(yi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new mi(yi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Vu(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=up(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new mi(yi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new mi(yi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ou(t)&&-1!==c.indexOf("/"))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Pi.Y(c));if(!Ri.ot(h))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ri(h);u.push(zo(e,l))}else{var f=gp(n,r,c);u.push(f)}}return new Vu(u,o)}(t.tf,t.firestore.R_,i,e,n,r)}function Xf(t,e,n){if(n instanceof Xl&&(n=n.o_),"string"==typeof n){if(""===n)throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ou(e)&&-1!==n.indexOf("/"))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Pi.Y(n));if(!Ri.ot(r))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return zo(t,new Ri(r))}if(n instanceof Ff)return zo(t,n.K_);throw new mi(yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+rf(n)+".")}function Jf(t,e){if(!Array.isArray(t)||0===t.length)throw new mi(yi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new mi(yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Zf(t,e,n){if(!n.isEqual(e))throw new mi(yi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function tp(t){if(yu(t)&&0===t.Tn.length)throw new mi(yi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ep=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,vu(r))||this).firestore=e,i.nf=r,i.type="collection",i}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new Ff(this.firestore,null,new Ri(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.nf)},e}(Bf);function np(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Jl("collection","path",e),t instanceof yf){var i=Pi.Y.apply(Pi,Object(Z.g)([e],n));return nf(i),new ep(t,null,i)}if(!(t instanceof Ff||t instanceof ep))throw new mi(yi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=Pi.Y.apply(Pi,Object(Z.g)([t.path],n)).child(Pi.Y(e));return nf(o),new ep(t.firestore,null,o)}function rp(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=ji.D()),Jl("doc","path",e),t instanceof yf){var i=Pi.Y.apply(Pi,Object(Z.g)([e],n));return ef(i),new Ff(t,null,new Ri(i))}if(!(t instanceof Ff||t instanceof ep))throw new mi(yi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.nf.child(Pi.Y.apply(Pi,Object(Z.g)([e],n)));return ef(o),new Ff(t.firestore,t instanceof ep?t.j_:null,new Ri(o))}var ip=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Z.c)(e,t),e.prototype.F_=function(t){return new bf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new Ff(this.firestore,null,e)},e}(If);function op(t,e){return(t instanceof Ff||t instanceof ep)&&(e instanceof Ff||e instanceof ep)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function sp(t,e){return t instanceof Bf&&e instanceof Bf&&t.firestore===e.firestore&&Tu(t.tf,e.tf)&&t.j_===e.j_}function up(t){var e=t.S_(),n=Ju(t.R_);return new pp(t.R_,!!e.ignoreUndefinedProperties,n)}var ap=/^__.*__$/,cp=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return n.push(null!==this.en?new tu(t,this.data,this.en,e):new Zs(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new nu(t,this.fieldTransforms)),n},t}(),hp=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new tu(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new nu(t,this.fieldTransforms)),n},t}();function lp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw bi()}}var fp=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return Tp(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find(function(e){return t.j(e)})||void 0!==this.fieldTransforms.find(function(e){return t.j(e.field)})},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(lp(this.a_)&&ap.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),pp=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ju(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new fp({a_:t,methodName:e,l_:n,path:Mi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function dp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Op("Data must be an object, but it was:",s,r);var u,a,c=mp(r,s);if(o.merge)u=new Bs(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Ip(e,f[l],n);if(!s.contains(p))throw new mi(yi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");jp(h,p)||h.push(p)}u=new Bs(h),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new cp(new uu(c),u,a)}function bp(t,e,n,r){var i=t.Rf(1,e,n);Op("Data must be an object, but it was:",i,r);var o=[],s=new au;Co(r,function(t,r){var u=_p(e,t,n);r instanceof Xl&&(r=r.o_);var a=i.If(u);if(r instanceof af)o.push(u);else{var c=yp(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new Bs(o);return new hp(s.hn(),u,i.fieldTransforms)}function vp(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[Ip(e,r,n)],a=[i];if(o.length%2!=0)throw new mi(yi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Ip(e,o[c])),a.push(o[c+1]);for(var h=[],l=new au,f=u.length-1;f>=0;--f)if(!jp(h,u[f])){var p=u[f],d=a[f];d instanceof Xl&&(d=d.o_);var b=s.If(p);if(d instanceof af)h.push(p);else{var v=yp(d,b);null!=v&&(h.push(p),l.set(p,v))}}var g=new Bs(h);return new hp(l.hn(),g,s.fieldTransforms)}function gp(t,e,n,r){return void 0===r&&(r=!1),yp(n,t.Rf(r?4:3,e))}function yp(t,e){if(t instanceof Xl&&(t=t.o_),wp(t))return Op("Unsupported field value:",e,t),mp(t,e);if(t instanceof uf)return function(t,e){if(!lp(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=yp(o[i],e.mf(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Xl&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ts(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ki.fromDate(t);return{timestampValue:es(e.serializer,n)}}if(t instanceof ki){var r=new ki(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:es(e.serializer,r)}}if(t instanceof df)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bf)return{bytesValue:ns(e.serializer,t.T_)};if(t instanceof Ff){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:os(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+rf(t))}(t,e)}function mp(t,e){var n={};return Ao(t)?e.path&&e.path.length>0&&e.en.push(e.path):Co(t,function(t,r){var i=yp(r,e.Ef(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function wp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ki||t instanceof df||t instanceof bf||t instanceof Ff||t instanceof uf)}function Op(t,e,n){if(!wp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=rf(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function Ip(t,e,n){if(e instanceof Xl&&(e=e.o_),e instanceof Cf)return e.G_;if("string"==typeof e)return _p(t,e);throw Tp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ep=new RegExp("[~\\*/\\[\\]]");function _p(t,e,n){if(e.search(Ep)>=0)throw Tp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Cf.bind.apply(Cf,Object(Z.g)([void 0],e.split("."))))).G_}catch(r){throw Tp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Tp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new mi(yi.INVALID_ARGUMENT,(u+=". ")+t+a)}function jp(t,e){return t.some(function(t){return t.isEqual(e)})}var Cp=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n=this;return Object(Z.d)(this,function(r){switch(r.label){case 0:if(this.vf(),this.mutations.length>0)throw new mi(yi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(Z.d)(this,function(a){switch(a.label){case 0:return n=gi(t),r=ls(n.serializer)+"/documents",i={documents:e.map(function(t){return us(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){vi(!!e.found);var n=as(t,e.found.name),r=is(e.found.updateTime),i=new uu({mapValue:{fields:e.found.fields}});return new lu(n,r,i,{})}(t,e):"missing"in e?function(t,e){vi(!!e.missing),vi(!!e.readTime);var n=as(t,e.missing),r=is(e.readTime);return new fu(n,r)}(t,e):bi()}(n.serializer,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());vi(!!e),u.push(e)}),u)]}})})}(this.Nu,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof fu||t instanceof lu?n.bf(t):bi()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new ou(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return Object(Z.b)(this,void 0,void 0,function(){var t,e=this;return Object(Z.d)(this,function(n){switch(n.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Ri.st(n);e.mutations.push(new su(r,e.rn(r)))}),[4,function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r,i;return Object(Z.d)(this,function(o){switch(o.label){case 0:return n=gi(t),r=ls(n.serializer)+"/documents",i={writes:e.map(function(t){return ds(n.serializer,t)})},[4,n.Au("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return n.sent(),this.gf=!0,[2]}})})},t.prototype.bf=function(t){var e;if(t instanceof lu)e=t.version;else{if(!(t instanceof fu))throw bi();e=Di.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new mi(yi.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Ks.updateTime(e):Ks.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(Di.min()))throw new mi(yi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ks.updateTime(e)}return Ks.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),Ap=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new oa(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return Object(Z.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Z.d)(this,function(r){return t=new Cp(this.Nu),(e=this.Nf(t))&&e.then(function(e){n.di.Ri(function(){return t.commit().then(function(){n.Ti.resolve(e)}).catch(function(t){n.xf(t)})})}).catch(function(t){n.xf(t)}),[2]})})})},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Qi(e)}return!1},t}(),Np=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=ai.UNAUTHENTICATED,this.clientId=ji.D(),this.Of=function(){},this.g=new Xu,this.credentials.A(function(t){li("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}return t.prototype.getConfiguration=function(){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},t.prototype.kf=function(){if(this.di.Ci)throw new mi(yi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new Xu;return this.di.Ni(function(){return Object(Z.b)(t,void 0,void 0,function(){var t,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ma(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function kp(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r=this;return Object(Z.d)(this,function(i){switch(i.label){case 0:return t.di.Li(),li("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return Object(Z.b)(r,void 0,void 0,function(){return Object(Z.d)(this,function(t){switch(t.label){case 0:return[4,qc(e.Cu,n)];case 1:return t.sent(),[2]}})})})}),e.persistence.tc(function(){return t.terminate()}),t.Lf=e,[2]}})})}function Dp(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r;return Object(Z.d)(this,function(i){switch(i.label){case 0:return t.di.Li(),[4,xp(t)];case 1:return n=i.sent(),li("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return function(t,e){return Object(Z.b)(this,void 0,void 0,function(){var n,r;return Object(Z.d)(this,function(i){switch(i.label){case 0:return(n=gi(t)).di.Li(),li("RemoteStore","RemoteStore received new credentials"),r=fh(n),n.Mu.add(3),[4,oh(n)];case 1:return i.sent(),r&&n.Bu.set("Unknown"),[4,n.xu.s_(e)];case 2:return i.sent(),n.Mu.delete(3),[4,ih(n)];case 3:return i.sent(),[2]}})})}(e.Oh,n)})}),t.$f=e,[2]}})})}function xp(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return t.Lf?[3,2]:(li("FirestoreClient","Using default OfflineComponentProvider"),[4,kp(t,new $l)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}})})}function Pp(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return t.$f?[3,2]:(li("FirestoreClient","Using default OnlineComponentProvider"),[4,Dp(t,new Hl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}})})}function Sp(t){return xp(t).then(function(t){return t.persistence})}function Mp(t){return xp(t).then(function(t){return t.Cu})}function Rp(t){return Pp(t).then(function(t){return t.Oh})}function Up(t){return Pp(t).then(function(t){return t.ga})}function Lp(t){return Object(Z.b)(this,void 0,void 0,function(){var e,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:return[4,Pp(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ju=el.bind(null,e.ga),n.Zu=rl.bind(null,e.ga),n)]}})})}function Vp(t,e,n,r,i){var o=new Ql({next:function(o){e.Ri(function(){return xh(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new mi(yi.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new mi(yi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Rh(vu(n.path),o,{includeMetadataChanges:!0,oa:!0});return Dh(t,s)}function qp(t,e,n,r,i){var o=new Ql({next:function(n){e.Ri(function(){return xh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new mi(yi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Rh(n,o,{includeMetadataChanges:!0,oa:!0});return Dh(t,s)}var Fp=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=up(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=Bp(t,this.U_),i=ad(r.j_,e,n),o=dp(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,Ks.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,s=Bp(t,this.U_);return e instanceof Xl&&(e=e.o_),o="string"==typeof e||e instanceof Cf?vp(this.Qf,"WriteBatch.update",s.K_,e,n,r):bp(this.Qf,"WriteBatch.update",s.K_,e),this.qf=this.qf.concat(o.ef(s.K_,Ks.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=Bp(t,this.U_);return this.qf=this.qf.concat(new ou(e.K_,Ks.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new mi(yi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Bp(t,e){if(t instanceof Xl&&(t=t.o_),t.firestore!==e)throw new mi(yi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var zp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return Object(Z.c)(e,t),e.prototype.get=function(e){var n=this,r=Bp(e,this.U_),i=new Rf(this.U_);return t.prototype.get.call(this,e).then(function(t){return new Df(n.U_,i,r.K_,t.W_,new td(!1,!1),r.j_)})},e}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=up(t)}return t.prototype.get=function(t){var e=this,n=Bp(t,this.U_),r=new ip(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return bi();var i=t[0];if(i instanceof fu)return new _f(e.U_,r,n.K_,null,n.j_);if(i instanceof lu)return new _f(e.U_,r,i.key,i,n.j_);throw bi()})},t.prototype.set=function(t,e,n){var r=Bp(t,this.U_),i=ad(r.j_,e,n),o=dp(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Bp(t,this.U_);return e instanceof Xl&&(e=e.o_),o="string"==typeof e||e instanceof Cf?vp(this.Qf,"Transaction.update",s.K_,e,n,r):bp(this.Qf,"Transaction.update",s.K_,e),this.Wf.update(s.K_,o),this},t.prototype.delete=function(t){var e=Bp(t,this.U_);return this.Wf.delete(e.K_),this},t}()),Gp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){kf(t);var n=$p(t),r=t.S_(),i=new Hl;return Nf(n,i,new Wl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){kf(t);var e=$p(t),n=t.S_(),r=new Hl;return Nf(e,r,new Yl(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.y_&&!t.V_)throw new mi(yi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Xu;return t.z_.Ni(function(){return Object(Z.b)(e,void 0,void 0,function(){var e;return Object(Z.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Z.b)(this,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return sa.Gs()?[4,sa.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Uc(t.R_,t.I_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.o_)},t}(),Kp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof ui||(i.Gf=e),i}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&pi("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(Z.b)(e,void 0,void 0,function(){var e,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:return[4,Sp(t)];case 1:return e=r.sent(),[4,Rp(t)];case 2:return n=r.sent(),[2,(e.ec(!0),function(t){var e=gi(t);return e.Mu.delete(0),ih(e)}(n))]}})})})}($p(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(Z.b)(e,void 0,void 0,function(){var e,n;return Object(Z.d)(this,function(r){switch(r.label){case 0:return[4,Sp(t)];case 1:return e=r.sent(),[4,Rp(t)];case 2:return n=r.sent(),[2,(e.ec(!1),function(t){return Object(Z.b)(this,void 0,void 0,function(){var e;return Object(Z.d)(this,function(n){switch(n.label){case 0:return(e=gi(t)).Mu.add(0),[4,oh(e)];case 1:return n.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}($p(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&tf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Xu;return t.di.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){var e;return Object(Z.d)(this,function(r){switch(r.label){case 0:return e=hl,[4,Up(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}($p(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=$p(t),i=Zu(e)?e:{next:e},o=new Ql(i);return t.z_.Ri(function(){return Object(Z.b)(n,void 0,void 0,function(){var t;return Object(Z.d)(this,function(e){switch(e.label){case 0:return t=function(t,e){gi(t).Hu.add(e),e.next()},[4,Lp(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})}),function(){o.r_(),t.z_.Ri(function(){return Object(Z.b)(n,void 0,void 0,function(){var t;return Object(Z.d)(this,function(e){switch(e.label){case 0:return t=function(t,e){gi(t).Hu.delete(e)},[4,Lp(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})})}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Gf)throw new mi(yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new sd(this,np(this.o_,t))}catch(t){throw Xp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Qp(this,rp(this.o_,t))}catch(t){throw Xp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new rd(this,function(t,e){if(Jl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new mi(yi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Bf(t,null,function(t){return new du(Pi.X(),t)}(e))}(this.o_,t))}catch(t){throw Xp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Xu;return t.di.Ri(function(){return Object(Z.b)(n,void 0,void 0,function(){var n;return Object(Z.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Pp(t).then(function(t){return t.Nu})}(t)];case 1:return n=i.sent(),new Ap(t.di,n,e,r).run(),[2]}})})}),r.promise}($p(t),function(n){return e(new zp(t,n))})}(this.o_,function(n){return t(new Yp(e,n))})},e.prototype.batch=function(){var t=this;return $p(this.o_),new Hp(new Fp(this.o_,function(e){return Vf(t.o_,e)}))},e}(Xl);function $p(t){return t.H_||Wp(t),t.H_.kf(),t.H_}function Wp(t){var e=t.S_(),n=function(t,e,n){return new si(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new Np(t.P_,t.z_,n)}var Yp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(Z.c)(e,t),e.prototype.get=function(t){var e=this,n=ud(t);return this.o_.get(n).then(function(t){return new ed(e.U_,t)})},e.prototype.set=function(t,e,n){var r=ud(t);return n?(Zl("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ud(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(Z.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ud(t);return this.o_.delete(e),this},e}(Xl),Hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.set=function(t,e,n){var r=ud(t);return n?(Zl("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ud(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(Z.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ud(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(Xl),Qp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new Ef(e),r}return Object(Z.c)(e,t),e.zf=function(t,n,r){if(t.length%2!=0)throw new mi(yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new Ff(n.o_,r,new Ri(t)))},e.q_=function(t,n,r){return new e(n,new Ff(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new sd(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new sd(this.firestore,np(this.o_,t))}catch(t){throw Xp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Xl&&(t=t.o_),t instanceof Ff&&op(this.o_,t)},e.prototype.set=function(t,e){e=Zl("DocumentReference.set",e);try{return function(t,e,n){var r=of(t.firestore,Af),i=ad(t.j_,e,n);return Vf(r,dp(up(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,Ks.on()))}(this.o_,t,e)}catch(t){throw Xp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Uf(this.o_,t):Uf.apply(void 0,Object(Z.g)([this.o_,t,e],n))}catch(t){throw Xp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Vf(of((t=this.o_).firestore,Af),[new ou(t.K_,Ks.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Jp(e),i=Zp(e,function(e){return new ed(t.firestore,new Df(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))});return Lf(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Rf(n),o=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Mp(r)];case 1:return[4,function(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o;return Object(Z.d)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=gi(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)})}(t,e)];case 1:return(r=s.sent())instanceof lu?n.resolve(r):r instanceof fu?n.resolve(null):n.reject(new mi(yi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=ma(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}(e.sent(),t.K_,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Df(n,i,t.K_,e,new td(e instanceof lu&&e.an,!0),t.j_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Lp(r)];case 1:return[4,Vp(e.sent(),n.z_,t.K_,{source:"server"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return qf(n,t,e)})}(this.o_):function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Lp(r)];case 1:return[4,Vp(e.sent(),n.z_,t.K_,{source:"default"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return qf(n,t,e)})}(this.o_)).then(function(t){return new ed(e.firestore,new Df(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Xl);function Xp(t,e,n){return t.message=t.message.replace(e,n),t}function Jp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Zu(r))return r}return{}}function Zp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Zu(t[0])?t[0]:Zu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var td=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ed=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Qp(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return Mf(this.o_,t.o_)},e}(Xl),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(ed),rd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return Object(Z.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Gf(this.o_,function(t,e,n){var r=e,i=jf("where",t);return new Kf(i,r,n)}(t,n,r)))}catch(t){throw Xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Gf(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=jf("orderBy",t);return new $f(r,n)}(t,n)))}catch(t){throw Xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Gf(this.o_,function(t){return sf("limit",t),new Wf("limit",t,"F")}(t)))}catch(t){throw Xp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Gf(this.o_,function(t){return sf("limitToLast",t),new Wf("limitToLast",t,"L")}(t)))}catch(t){throw Xp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gf(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yf("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw Xp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gf(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yf("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw Xp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gf(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hf("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw Xp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gf(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hf("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw Xp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return sp(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Rf(n),o=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Mp(r)];case 1:return[4,function(t,e,n){return Object(Z.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(Z.d)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,Wc(t,e,!0)];case 1:return r=c.sent(),i=new Xh(e,r.Bc),o=i.gh(r.documents),s=i.Zn(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=c.sent(),a=ma(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})}(e.sent(),t.tf,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Pf(n,i,t,e)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Rf(n),o=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Lp(r)];case 1:return[4,qp(e.sent(),n.z_,t.tf,{source:"server"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Pf(n,i,t,e)})}(this.o_):function(t){var e=this,n=of(t.firestore,Af),r=$p(n),i=new Rf(n);tp(t.tf);var o=new Xu;return n.z_.Ri(function(){return Object(Z.b)(e,void 0,void 0,function(){return Object(Z.d)(this,function(e){switch(e.label){case 0:return[4,Lp(r)];case 1:return[4,qp(e.sent(),n.z_,t.tf,{source:"default"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new Pf(n,i,t,e)})}(this.o_)).then(function(t){return new od(e.firestore,t)})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Jp(e),i=Zp(e,function(e){return new od(t.firestore,e)});return Lf(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Xl),id=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new nd(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(Xl),od=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new rd(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new nd(t.U_,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new id(e.U_,t)})},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new nd(n.U_,r))})},e.prototype.isEqual=function(t){return Mf(this.o_,t.o_)},e}(Xl),sd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return Object(Z.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Qp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Qp(this.firestore,void 0===t?rp(this.o_):rp(this.o_,t))}catch(t){throw Xp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=of(t.firestore,Af),r=rp(t),i=ad(t.j_,e);return Vf(n,dp(up(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,Ks.exists(!1))).then(function(){return r})}(this.o_,t).then(function(t){return new Qp(e.firestore,t)})},e.prototype.isEqual=function(t){return op(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(rd);function ud(t){return t instanceof Xl&&(t=t.o_),of(t,Ff)}function ad(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var cd,hd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Cf.bind.apply(Cf,Object(Z.g)([void 0],e))))||this}return Object(Z.c)(e,t),e.documentId=function(){return new e(Mi.et().J())},e.prototype.isEqual=function(t){return t instanceof Xl&&(t=t.o_),t instanceof Cf&&this.o_.G_.isEqual(t.G_)},e}(Xl),ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Z.c)(e,t),e.serverTimestamp=function(){var t=new hf("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new af("deleteField");return t.c_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lf("arrayUnion",t)}).apply(void 0,t);return r.c_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ff("arrayRemove",t)}).apply(void 0,t);return r.c_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new pf("increment",t)}(t);return n.c_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(Xl),fd={Firestore:Kp,GeoPoint:df,Timestamp:ki,Blob:Of,Transaction:Yp,WriteBatch:Hp,DocumentReference:Qp,DocumentSnapshot:ed,Query:rd,QueryDocumentSnapshot:nd,QuerySnapshot:od,CollectionReference:sd,FieldPath:hd,FieldValue:ld,setLogLevel:function(t){ci.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new oi.a("firestore",function(t){return function(t,e){return new Kp(t,new Af(t,e),new Gp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},fd)))})(cd=tt.a),cd.registerVersion("@firebase/firestore","2.0.4");var pd=n("Jgta"),dd=n("VRyK"),bd=n("eIep"),vd=n("UXun"),gd=n("SxV6");const yd=new s.s("angularfire2.auth.use-emulator"),md=new s.s("angularfire2.auth.settings"),wd=new s.s("angularfire2.auth.tenant-id"),Od=new s.s("angularfire2.auth.langugage-code"),Id=new s.s("angularfire2.auth.use-device-language"),Ed=new s.s("angularfire.auth.persistence");let _d=(()=>{class t{constructor(t,e,i,s,u,a,c,h,l,f){const p=new J.d(s),d=Object(J.h)(p),b=new o.a,v=Object(W.a)(void 0).pipe(Object(X.b)(p.outsideAngular),Object(bd.a)(()=>s.runOutsideAngular(()=>n.e(5).then(n.bind(null,"6nsN")))),Object(Y.a)(()=>Object(J.g)(t,s,e)),Object(Y.a)(t=>s.runOutsideAngular(()=>{const e=u,n=a;return Object(J.f)(t.name+".auth","AngularFireAuth",t,()=>{const r=s.runOutsideAngular(()=>t.auth());return e&&r.useEmulator("http://"+e.join(":")),c&&(r.tenantId=c),r.languageCode=h,l&&r.useDeviceLanguage(),n&&(r.settings=n),f&&r.setPersistence(f),r},[e,c,h,l,n,f])})),Object(vd.a)({bufferSize:1,refCount:!1}));return Object(r.u)(i)?this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(W.a)(null):(v.pipe(Object(gd.a)()).subscribe(),this.authState=v.pipe(Object(bd.a)(t=>t.getRedirectResult().then(()=>t,()=>t)),Object(bd.a)(t=>s.runOutsideAngular(()=>new K.a(t.onAuthStateChanged.bind(t)))),d,Object(vd.a)(1)),this.user=v.pipe(Object(bd.a)(t=>t.getRedirectResult().then(()=>t,()=>t)),Object(bd.a)(t=>s.runOutsideAngular(()=>new K.a(t.onIdTokenChanged.bind(t)))),d,Object(vd.a)(1)),this.idToken=this.user.pipe(Object(bd.a)(t=>t?Object($.a)(t.getIdToken()):Object(W.a)(null))),this.idTokenResult=this.user.pipe(Object(bd.a)(t=>t?Object($.a)(t.getIdTokenResult()):Object(W.a)(null))),this.credential=v.pipe(Object(bd.a)(t=>Object(dd.a)(t.getRedirectResult().then(t=>t,()=>null),b,this.authState.pipe(Object(Q.a)(t=>!t)))),Object(Y.a)(t=>(null==t?void 0:t.user)?t:null),d,Object(vd.a)(1))),Object(J.i)(this,v,s,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>b.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(J.c),s.Yb(J.b,8),s.Yb(s.D),s.Yb(s.B),s.Yb(yd,8),s.Yb(md,8),s.Yb(wd,8),s.Yb(Od,8),s.Yb(Id,8),s.Yb(Ed,8))},t.\u0275prov=Object(s.Kb)({factory:function(){return new t(Object(s.Yb)(J.c),Object(s.Yb)(J.b,8),Object(s.Yb)(s.D),Object(s.Yb)(s.B),Object(s.Yb)(yd,8),Object(s.Yb)(md,8),Object(s.Yb)(wd,8),Object(s.Yb)(Od,8),Object(s.Yb)(Id,8),Object(s.Yb)(Ed,8))},token:t,providedIn:"any"}),t})();function Td(t,e){return function(t,e=G.b){return new K.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function jd(t,e){return Td(t,e).pipe(Object(Y.a)(t=>({payload:t,type:"query"})))}function Cd(t,e){return jd(t,e).pipe(Object(Y.a)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function Ad(t,e,n){return jd(t,n).pipe(Object(Y.a)(t=>t.payload.docChanges()),Object(H.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),Object(Y.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Nd(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}Object(J.e)(_d,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);class kd{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?Cd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(Y.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(Q.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Cd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(H.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Nd(t);return Ad(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(Y.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object($.a)(this.query.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new Dd(this.ref.doc(t),this.afs)}}class Dd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=Ud(n,e);return new kd(r,i,this.afs)}snapshotChanges(){return Td(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(Y.a)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(Y.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object($.a)(this.ref.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}}class xd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Cd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(Y.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(Q.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Cd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(H.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Nd(t);return Ad(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(Y.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object($.a)(this.query.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}}const Pd=new s.s("angularfire2.enableFirestorePersistence"),Sd=new s.s("angularfire2.firestore.persistenceSettings"),Md=new s.s("angularfire2.firestore.settings"),Rd=new s.s("angularfire2.firestore.use-emulator");function Ud(t,e=(t=>t)){return{query:e(t),ref:t}}let Ld=(()=>{class t{constructor(t,e,n,i,o,s,u,a,c){this.schedulers=new J.d(s),this.keepUnstableUntilFirst=Object(J.h)(this.schedulers);const h=Object(J.g)(t,s,e);!pd.a.auth&&c&&Object(J.j)();const l=a;[this.firestore,this.persistenceEnabled$]=Object(J.f)(h.name+".firestore","AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object($.a)(t.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(e){return"undefined"!=typeof console&&console.warn(e),Object(W.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(W.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=Ud(n,e),o=this.schedulers.ngZone.run(()=>r);return new kd(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new xd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new Dd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(J.c),s.Yb(J.b,8),s.Yb(Pd,8),s.Yb(Md,8),s.Yb(s.D),s.Yb(s.B),s.Yb(Sd,8),s.Yb(Rd,8),s.Yb(yd,8))},t.\u0275prov=Object(s.Kb)({factory:function(){return new t(Object(s.Yb)(J.c),Object(s.Yb)(J.b,8),Object(s.Yb)(Pd,8),Object(s.Yb)(Md,8),Object(s.Yb)(s.D),Object(s.Yb)(s.B),Object(s.Yb)(Sd,8),Object(s.Yb)(Rd,8),Object(s.Yb)(yd,8))},token:t,providedIn:"any"}),t})(),Vd=(()=>{class t{constructor(t,e){this.afs=t,this.store=e}listenForIssueChanges(){this.readCollectionsOnChanges("issues",t=>{console.log(t.size),t.docChanges().forEach(t=>{console.log(t.type,t.doc.data()),this.updateIssuesStore(t)})},t=>{},()=>{console.log("issue listenered stopped.")})}updateIssuesStore(t){switch(t.type){case"added":case"modified":case"removed":return}}createDocument(t,e){return this.afs.doc(e).set(t)}createDocId(){return this.afs.createId()}updatePartialDocument(t,e){return this.afs.doc(e).update(t.changes)}deleteDocument(t,e="issues"){return this.afs.collection(e).doc(t.id).delete()}readCollections(t,e){const n=this.afs.collection(t);return e?n.ref.where("description",">=",e).get():n.ref.orderBy("dateCreated","desc").get()}readCollectionsOnChanges(t,e,n,r){return this.afs.collection(t).ref.orderBy("dateCreated","desc").onSnapshot(e,n,r)}addNewIssue(t,e){this.store.dispatch(p.g({data:t,url:e}))}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(Ld),s.Yb(c.h))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var qd=n("bv9b"),Fd=n("NFeN"),Bd=n("MutI"),zd=n("A5z7"),Gd=n("mrSG"),Kd=n("oC0T"),$d=n.n(Kd),Wd=n("WEJZ");let Yd=(()=>{class t{transform(t){let e="prior-";switch(t){case Wd.a.Low:e+="low";break;case Wd.a.Medium:e+="medium";break;case Wd.a.High:e+="high"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Nb({name:"priorToCssClass",type:t,pure:!0}),Object(Gd.a)([$d()()],t.prototype,"transform",null),t})(),Hd=(()=>{class t{transform(t){return t?"issue-open":"issue-closed"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Nb({name:"openToCssClass",type:t,pure:!0}),Object(Gd.a)([$d()()],t.prototype,"transform",null),t})(),Qd=(()=>{class t{transform(t,e){return t?e?"opened":"open":"closed"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Nb({name:"issueOpenStatusDisplay",type:t,pure:!0}),t})(),Xd=(()=>{class t{transform(t){return t?(t+"").trim().length:0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Nb({name:"getValueCountDisplay",type:t,pure:!0}),t})();var Jd=n("B6IJ");function Zd(t,e){if(1&t){const t=s.Vb();s.Ub(0,"button",9),s.bc("click",function(){return s.tc(t),s.fc(2).onEditToggle()}),s.Ec(1),s.gc(2,"async"),s.Tb()}if(2&t){const t=s.fc(2);s.Cb(1),s.Gc(" ",s.hc(2,1,t.cs.getIssueEditMode$)?"Cancel edit":"Edit issue"," ")}}function tb(t,e){if(1&t){const t=s.Vb();s.Sb(0),s.Cc(1,Zd,3,3,"button",7),s.Ub(2,"button",8),s.bc("click",function(){return s.tc(t),s.fc().deleteIssue()}),s.Ec(3,"Delete issue"),s.Tb(),s.Rb()}if(2&t){const t=s.fc();s.Cb(1),s.lc("ngIf",null==t.issue?null:t.issue.open)}}function eb(t,e){if(1&t){const t=s.Vb();s.Sb(0),s.Ub(1,"button",10),s.bc("click",function(){return s.tc(t),s.fc().onOpenCloseToggleIssue()}),s.Ec(2),s.Tb(),s.Rb()}if(2&t){const t=s.fc();s.Cb(2),s.Gc(" ",null!=t.issue&&t.issue.open?"Close issue":"Reopen issue"," ")}}function nb(t,e){1&t&&(s.Sb(0),s.Ub(1,"div",11),s.Ub(2,"div",12),s.Pb(3,"mat-progress-bar",13),s.Tb(),s.Tb(),s.Rb())}function rb(t,e){if(1&t&&(s.Sb(0),s.Ub(1,"div",14),s.Ub(2,"div",12),s.Ub(3,"div",15),s.Ub(4,"mat-icon",16),s.gc(5,"priorToCssClass"),s.Ec(6,"error_outline"),s.Tb(),s.Ec(7),s.Ub(8,"span",17),s.Ec(9),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Ub(10,"div",18),s.Ub(11,"div",12),s.Ub(12,"div",19),s.Ub(13,"mat-chip-list",20),s.Ub(14,"mat-chip",21),s.gc(15,"openToCssClass"),s.Ec(16),s.gc(17,"issueOpenStatusDisplay"),s.Tb(),s.Tb(),s.Ub(18,"div",22),s.Ec(19),s.gc(20,"dateDisplay"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Pb(21,"hr"),s.Rb()),2&t){const t=s.fc();s.Cb(4),s.Eb(s.hc(5,10,null==t.issue||null==t.issue.priority?null:t.issue.priority.id)),s.lc("title","Priority: "+(null==t.issue||null==t.issue.priority?null:t.issue.priority.display)),s.Cb(3),s.Gc(" ",null==t.issue?null:t.issue.title," "),s.Cb(2),s.Gc(" #",null==t.issue?null:t.issue.issueNumber," "),s.Cb(5),s.Eb(s.hc(15,12,null==t.issue?null:t.issue.open)),s.Cb(2),s.Gc(" ",s.ic(17,14,null==t.issue?null:t.issue.open,!1)," "),s.Cb(3),s.Hc(" ",null==t.issue?null:t.issue.author," created this issue on ",s.ic(20,17,null==t.issue?null:t.issue.dateCreated,"FULLANDFROMNOW")," ")}}const ib=function(){return["/","issues"]};function ob(t,e){1&t&&(s.Sb(0),s.Ub(1,"div",14),s.Ub(2,"div",23),s.Ec(3," This issue does not exist anymore. "),s.Ub(4,"a",24),s.Ec(5,"Go back"),s.Tb(),s.Tb(),s.Tb(),s.Rb()),2&t&&(s.Cb(4),s.lc("routerLink",s.mc(1,ib)))}function sb(t,e){if(1&t&&(s.Cc(0,ob,6,2,"ng-container",3),s.gc(1,"async")),2&t){const t=s.fc();s.lc("ngIf",!s.hc(1,1,t.cs.issueOverallLoading$))}}let ub=(()=>{class t{constructor(t,e,n,r,i,s){this.router=t,this.route=e,this.cs=n,this.store=r,this.crs=i,this.dialog=s,this.compDest$=new o.a,this.issue=void 0,this.editMode=!1}ngOnInit(){q.c("action-row"),this.cs.getIssueBySelectedId$.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.issue=t}),this.route.paramMap.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.cs.setSelectedIssueId(t.get("id"))}),this.cs.getIssueEditMode$.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.editMode=t})}goBackToAll(){this.router.navigate(["/","issues"],{relativeTo:this.route})}onOpenCloseToggleIssue(){var t;if(this.issue){const e=(null===(t=this.issue)||void 0===t?void 0:t.open)?"close":"reopen";this.openConfirmDialog(e).subscribe(t=>{t&&this.issue&&this.cs.toggleOpenCloseIssue(this.issue)})}}openConfirmDialog(t){return this.dialog.open(z,{minWidth:"300px",data:{actionName:t+" this issue?"}}).afterClosed().pipe(Object(V.a)(this.compDest$))}onEditToggle(){this.router.navigate(this.editMode?["./","view"]:["./","edit"],{relativeTo:this.route})}deleteIssue(){this.openConfirmDialog("delete").subscribe(t=>{t&&this.issue&&this.cs.deleteIssue(this.issue,R)})}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(i.f),s.Ob(i.a),s.Ob(U),s.Ob(c.h),s.Ob(Vd),s.Ob(F.b))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-display-detail"]],decls:14,vars:7,consts:[["id","action-row",1,"row","my-3","py-1"],[1,"col-6","col-lg-10"],["type","button",1,"btn","btn-outline-primary","mr-2","mb-2",3,"click"],[4,"ngIf"],[1,"col-6","col-lg-2"],[4,"ngIf","ngIfElse"],["issueDoesNotExist",""],["type","button","class","btn btn-warning mr-2 mb-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","mr-2","mb-2",3,"click"],["type","button",1,"btn","btn-warning","mr-2","mb-2",3,"click"],["type","button",1,"btn","btn-success","float-right",3,"click"],[1,"row","mb-2"],[1,"col-lg-12"],["mode","indeterminate"],[1,"row"],[1,"title"],["mat-list-icon","",3,"title"],[1,"count"],[1,"row","mt-2"],[1,"meta"],[1,"mr-2"],["color","primary","selected",""],[1,"v-center"],[1,"col-lg-12","if","fs-18","f-w-700"],[3,"routerLink"]],template:function(t,e){if(1&t&&(s.Ub(0,"div",0),s.Ub(1,"div",1),s.Ub(2,"button",2),s.bc("click",function(){return e.goBackToAll()}),s.Ec(3,"Back"),s.Tb(),s.Cc(4,tb,4,1,"ng-container",3),s.Tb(),s.Ub(5,"div",4),s.Cc(6,eb,3,1,"ng-container",3),s.Tb(),s.Tb(),s.Pb(7,"hr"),s.Cc(8,nb,4,0,"ng-container",3),s.gc(9,"async"),s.Cc(10,rb,22,20,"ng-container",5),s.Pb(11,"router-outlet"),s.Cc(12,sb,2,3,"ng-template",null,6,s.Dc)),2&t){const t=s.rc(13);s.Cb(4),s.lc("ngIf",e.issue),s.Cb(2),s.lc("ngIf",e.issue),s.Cb(2),s.lc("ngIf",s.hc(9,5,e.cs.issueOverallLoading$)),s.Cb(2),s.lc("ngIf",e.issue)("ngIfElse",t)}},directives:[r.k,i.j,qd.a,Fd.a,Bd.b,zd.b,zd.a,i.h],pipes:[r.b,Yd,Hd,Qd,Jd.a],styles:[".action-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.title[_ngcontent-%COMP%]{font-size:32px;font-weight:400;line-height:33px;word-break:break-word}.count[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{min-height:35px}.count[_ngcontent-%COMP%]{color:#6a737d;font-weight:100}.meta[_ngcontent-%COMP%]{font-size:14px;color:#586069;display:flex}.desc[_ngcontent-%COMP%]{font-size:23px}mat-chip.issue-open[_ngcontent-%COMP%]{background-color:#28a745!important}mat-chip.issue-closed[_ngcontent-%COMP%]{background-color:#888!important}p.desc[_ngcontent-%COMP%]{font-size:14px;color:#24292e}"]}),t})();var ab=n("Kj3r"),cb=n("/uUt"),hb=n("D7s6"),lb=n("kmnG"),fb=n("qFsG"),pb=n("3Pt+"),db=n("FKr1"),bb=n("Xa2L");function vb(t,e){1&t&&(s.Ub(0,"div",8),s.Pb(1,"mat-spinner",9),s.Ec(2," Loading... "),s.Tb())}function gb(t,e){if(1&t&&(s.Ub(0,"div",10),s.Ec(1),s.gc(2,"async"),s.gc(3,"dateDisplay"),s.Tb()),2&t){const t=s.fc().ngIf,e=s.fc();s.Cb(1),s.Ic(" #",s.hc(2,3,e.cs.getIssueCounterNumber(null==t?null:t.id))," created ",s.ic(3,5,null==t?null:t.dateCreated,"FROMNOW")," by ",null==t?null:t.author," ")}}const yb=function(t,e,n){return{"issue-open":t,"issue-closed":e,"loading-bg":n}};function mb(t,e){if(1&t){const t=s.Vb();s.Sb(0),s.Ub(1,"mat-list-item",1),s.Ub(2,"mat-icon",2),s.gc(3,"priorToCssClass"),s.Ec(4,"error_outline"),s.Tb(),s.Ub(5,"div",3),s.Ub(6,"div",4),s.bc("click",function(){return s.tc(t),s.fc().onIssueClick()}),s.Ec(7),s.Tb(),s.Cc(8,vb,3,0,"div",5),s.Tb(),s.Ub(9,"div",6),s.Ec(10),s.Tb(),s.Cc(11,gb,4,8,"div",7),s.Tb(),s.Rb()}if(2&t){const t=e.ngIf;s.Cb(1),s.lc("ngClass",s.pc(11,yb,null==t?null:t.open,!(null!=t&&t.open),!(null!=t&&t.created))),s.Cb(1),s.Eb(s.hc(3,9,null==t||null==t.priority?null:t.priority.id)),s.lc("title","Priority: "+(null==t||null==t.priority?null:t.priority.display)),s.Cb(5),s.Hc(" ",null==t?null:t.title," ",null!=t&&t.created?"":"(creating...)"," "),s.Cb(1),s.lc("ngIf",null==t?null:t.loading),s.Cb(2),s.Gc(" ",null==t?null:t.description," "),s.Cb(1),s.lc("ngIf",null==t?null:t.created)}}let wb=(()=>{class t{constructor(t,e,n){this.cs=t,this.router=e,this.route=n}ngOnInit(){}onIssueClick(){var t,e;(null===(t=this.issue)||void 0===t?void 0:t.id)&&this.router.navigate(["../",null===(e=this.issue)||void 0===e?void 0:e.id],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(U),s.Ob(i.f),s.Ob(i.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-display-issue"]],inputs:{issue:"issue"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"issue-border",3,"ngClass"],["mat-list-icon","",3,"title"],["mat-line","",1,"issue-title"],["mat-line","",1,"text",3,"click"],["class","d-flex",4,"ngIf"],["mat-line","",1,"issue-desc","mb-1"],["mat-line","","class","issue-meta",4,"ngIf"],[1,"d-flex"],["color","primary","diameter","20",1,"mr-2"],["mat-line","",1,"issue-meta"]],template:function(t,e){1&t&&s.Cc(0,mb,12,15,"ng-container",0),2&t&&s.lc("ngIf",e.issue)},directives:[r.k,Bd.c,r.i,Fd.a,Bd.b,db.j,bb.b],pipes:[Yd,r.b,Jd.a],styles:[".issue-border[_ngcontent-%COMP%]{border-right:1px solid #e1e4e8;border-bottom:1px solid #e1e4e8}.mat-line.issue-desc[_ngcontent-%COMP%]{color:#666;font-size:13px!important;line-height:22px}.mat-line.issue-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;display:flex;justify-content:space-between}.mat-line.issue-meta[_ngcontent-%COMP%]{font-size:13px!important;color:#888}.mat-line.issue-title[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]:hover{cursor:pointer;color:#33f}"]}),t})(),Ob=(()=>{class t{constructor(){this.wholePage=!1,this.loading=!0,this.logoShakeState=!1,this.compDest$=new o.a}ngOnChanges(t){this.parentClass=this.wholePage?"whole-page loading-container":"container loading-container mt-5"}ngOnInit(){}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Ib({type:t,selectors:[["app-shared-loading"]],inputs:{wholePage:"wholePage"},features:[s.Ab],decls:13,vars:2,consts:[[1,"row"],[1,"col-sm-12"],[1,"d-flex","loading-parent"],[1,"loading-logo"],["src","assets/banner/resolved2.png","alt","logo",1,"logo-img","d-inline-block"],[1,"lds-facebook"],[1,"d-flex","loading-parent","secfont"]],template:function(t,e){1&t&&(s.Ub(0,"div"),s.Ub(1,"div",0),s.Ub(2,"div",1),s.Ub(3,"div",2),s.Ub(4,"div",3),s.Pb(5,"img",4),s.Tb(),s.Tb(),s.Ub(6,"div",2),s.Ub(7,"div",5),s.Pb(8,"div"),s.Pb(9,"div"),s.Pb(10,"div"),s.Tb(),s.Tb(),s.Ub(11,"div",6),s.Ec(12," Loading... "),s.Tb(),s.Tb(),s.Tb(),s.Tb()),2&t&&s.Eb(e.parentClass)},styles:[".loading-logo[_ngcontent-%COMP%]{height:3rem}.loading-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.loading-container[_ngcontent-%COMP%], .loading-parent[_ngcontent-%COMP%]{justify-content:center;align-items:center}.loading-container[_ngcontent-%COMP%]{display:flex;height:100%}.whole-page[_ngcontent-%COMP%]{position:fixed;width:100%}.lds-facebook[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;position:absolute;left:8px;width:16px;background:#007bff;animation:lds-facebook 1.2s cubic-bezier(0,.5,.5,1) infinite}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{left:8px;animation-delay:-.24s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:32px;animation-delay:-.12s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:56px;animation-delay:0}@keyframes lds-facebook{0%{top:8px;height:64px}50%,to{top:24px;height:32px}}"]}),t})();function Ib(t,e){if(1&t&&(s.Sb(0),s.Pb(1,"app-core-issue-display-issue",10),s.Rb()),2&t){const t=e.$implicit;s.Cb(1),s.lc("issue",t)}}function Eb(t,e){if(1&t&&(s.Sb(0),s.Cc(1,Ib,2,1,"ng-container",9),s.Rb()),2&t){const t=s.fc().ngIf;s.Cb(1),s.lc("ngForOf",t)}}function _b(t,e){if(1&t&&(s.Sb(0),s.Cc(1,Eb,2,1,"ng-container",5),s.Rb()),2&t){const t=e.ngIf;s.fc(2);const n=s.rc(17);s.Cb(1),s.lc("ngIf",t&&t.length>0)("ngIfElse",n)}}function Tb(t,e){if(1&t&&(s.Sb(0),s.Cc(1,_b,2,2,"ng-container",8),s.gc(2,"async"),s.Rb()),2&t){const t=s.fc();s.Cb(1),s.lc("ngIf",s.hc(2,1,t.cs.getAllIssues$))}}const jb=function(){return["./"]},Cb=function(){return{newIssuePane:"open"}};function Ab(t,e){1&t&&(s.Ub(0,"div",11),s.Pb(1,"img",12),s.Tb(),s.Ub(2,"div",13),s.Ec(3," No isses were found. "),s.Tb(),s.Ub(4,"div",14),s.Ub(5,"a",15),s.Ec(6," Would you like to create a new issue? "),s.Tb(),s.Tb()),2&t&&(s.Cb(5),s.lc("routerLink",s.mc(2,jb))("queryParams",s.mc(3,Cb)))}function Nb(t,e){1&t&&(s.Ub(0,"div",16),s.Pb(1,"app-shared-loading"),s.Tb())}let kb=(()=>{class t{constructor(t){this.cs=t,this.compDest$=new o.a}ngOnInit(){}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(U))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-display"]],decls:20,vars:13,consts:[[1,"issues-header"],["mat-line","",1,"d-flex"],[1,"open"],[3,"title"],[1,"closed"],[4,"ngIf","ngIfElse"],["noIssuesReturned",""],["issueLoading",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"issue"],[1,"lg-img-parent","mt-5","mb-3"],["src","assets/banner/empty-cb.png","alt","logo",1,"lg-img","d-inline-block"],[1,"no-issues","if","mb-3"],[1,"no-issues","if"],[3,"routerLink","queryParams"],[1,"my-5"]],template:function(t,e){if(1&t&&(s.Ub(0,"mat-list"),s.Ub(1,"mat-list-item",0),s.Ub(2,"div",1),s.Ub(3,"mat-icon",2),s.Ec(4,"error_outline"),s.Tb(),s.Ub(5,"div",3),s.gc(6,"async"),s.Ec(7),s.gc(8,"async"),s.Tb(),s.Ub(9,"mat-icon",4),s.Ec(10,"check_circle_outline"),s.Tb(),s.Ub(11,"div"),s.Ec(12),s.gc(13,"async"),s.Tb(),s.Tb(),s.Tb(),s.Cc(14,Tb,3,3,"ng-container",5),s.gc(15,"async"),s.Tb(),s.Cc(16,Ab,7,4,"ng-template",null,6,s.Dc),s.Cc(18,Nb,2,0,"ng-template",null,7,s.Dc)),2&t){const t=s.rc(19);s.Cb(5),s.lc("title",s.hc(6,5,e.cs.totalIssueCount$)+" total issues"),s.Cb(2),s.Gc(" ",s.hc(8,7,e.cs.openIssueCount$)," Open "),s.Cb(5),s.Gc(" ",s.hc(13,9,e.cs.closedIssueCount$)," Closed"),s.Cb(2),s.lc("ngIf",!s.hc(15,11,e.cs.issuesRefreshLoading$))("ngIfElse",t)}},directives:[Bd.a,Bd.c,db.j,Fd.a,r.k,r.j,wb,i.h,Ob],pipes:[r.b],styles:[".issues-header[_ngcontent-%COMP%]{background-color:#f6f8fa;border:1px solid #e1e4e8}.mat-line[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:15px}.mat-line[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px}mat-list-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{border-radius:15px;color:#fff}mat-list-item[_ngcontent-%COMP%]   .mat-icon.open[_ngcontent-%COMP%]{background-color:#28a745}mat-list-item[_ngcontent-%COMP%]   .mat-icon.closed[_ngcontent-%COMP%]{background-color:#888}.no-issues[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:22px;font-weight:400}"]}),t})();function Db(t){const e=t.value;if(!e||""===(""+e).trim())return{fieldRequired:!0}}function xb(t){const e=t.value;if(!(e&&""!==(""+e).trim()&&(e+"").trim().length<=256))return{fieldTooLong:!0}}var Pb=n("Wp6s"),Sb=n("ihCf"),Mb=n("QibW");const Rb=["titleInput"];function Ub(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-card-header"),s.Pb(1,"div",6),s.Ub(2,"mat-card-title",7),s.Ub(3,"div"),s.Ec(4),s.Tb(),s.Tb(),s.Ub(5,"mat-card-subtitle",8),s.Ub(6,"div"),s.Ec(7),s.Tb(),s.Ub(8,"div"),s.Ub(9,"button",9),s.bc("click",function(){return s.tc(t),s.fc().onIssueCancel()}),s.Ec(10,"Cancel"),s.Tb(),s.Tb(),s.Tb(),s.Tb()}if(2&t){const t=s.fc();s.Cb(4),s.Gc(" Add Issue ",null!=t.issueFg&&t.issueFg.pristine?"":"*"," "),s.Cb(3),s.Gc(" #",t.cos.currentIssueCounter," ")}}function Lb(t,e){if(1&t&&(s.Ub(0,"mat-radio-button",19),s.gc(1,"priorToCssClass"),s.Ub(2,"span",20),s.Ec(3),s.Tb(),s.Tb()),2&t){const t=e.$implicit;s.Eb(s.hc(1,4,t.id)),s.lc("value",t),s.Cb(3),s.Fc(t.display)}}function Vb(t,e){if(1&t&&(s.Ub(0,"div"),s.Ub(1,"form",10),s.Ub(2,"mat-form-field",11),s.Ub(3,"mat-label"),s.Ec(4,"Title"),s.Tb(),s.Pb(5,"input",12,13),s.Ub(7,"mat-hint",14),s.Ec(8),s.gc(9,"getValueCountDisplay"),s.Tb(),s.Tb(),s.Ub(10,"mat-form-field",15),s.Ub(11,"mat-label"),s.Ec(12,"Description"),s.Tb(),s.Pb(13,"textarea",16),s.Tb(),s.Ub(14,"mat-radio-group",17),s.Cc(15,Lb,4,6,"mat-radio-button",18),s.Tb(),s.Tb(),s.Tb()),2&t){const t=s.fc();s.Cb(1),s.lc("formGroup",t.issueFg),s.Cb(7),s.Gc("",s.hc(9,5,null==t.titleValue?null:t.titleValue.value)," / 256"),s.Cb(5),s.lc("cdkTextareaAutosize",!0)("cdkAutosizeMinRows",3),s.Cb(2),s.lc("ngForOf",t.priorityList)}}function qb(t,e){if(1&t){const t=s.Vb();s.Ub(0,"button",9),s.bc("click",function(){return s.tc(t),s.fc().onFormReset()}),s.Ec(1,"Reset"),s.Tb()}}const Fb=function(t,e){return{"mat-elevation-z0":t,"mat-elevation-z5":e}};let Bb=(()=>{class t{constructor(t,e,n,r,i){this.fb=t,this.cs=e,this.router=n,this.route=r,this.cos=i,this.issueData=void 0,this.isEditMode=!1,this.priorityList=q.a,this.issueFg=void 0,this.createInitIssueFg()}get titleValue(){if(this.issueFg&&this.issueFg.get("title"))return this.issueFg.get("title")}ngOnChanges(){this.createIssueFg(this.issueData)}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{var t;null===(t=this.titleInput)||void 0===t||t.nativeElement.focus()},300)}createIssueFg(t){if(t){const e=this.priorityList.find(e=>{var n;return e.id===(null===(n=t.priority)||void 0===n?void 0:n.id)});this.issueFg.patchValue(Object.assign(Object.assign({},t),{priority:e}))}}onFormReset(){this.issueData&&this.createIssueFg(this.issueData)}onSubmit(){var t,e,n;let r=null===(t=this.issueFg)||void 0===t?void 0:t.value;if(null===(e=this.issueFg)||void 0===e?void 0:e.valid)if(this.isEditMode&&this.issueData){const t={id:null===(n=this.issueData)||void 0===n?void 0:n.id,changes:Object.assign(Object.assign({},r),{loading:!0})};this.cos.editIssue(t,this.issueData)}else{const t=this.createFullIssueObject(r);this.cs.addNewIssue(t,"issues/"+t.id),this.onIssueCancel()}}createFullIssueObject(t){return Object.assign(Object.assign({},t),{dateCreated:(new Date).getTime(),id:this.cs.createDocId(),open:!0,author:"Tester",reactions:0,created:!1,loading:!0,issueNumber:this.cos.currentIssueCounter})}onIssueCancel(){this.router.navigate(["./"])}createInitIssueFg(){this.issueFg=this.fb.group({title:q.b(null,!1,[Db,xb]),description:q.b(null,!1,[Db]),priority:q.b(this.priorityList[1],!1,[pb.q.required])})}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(pb.d),s.Ob(Vd),s.Ob(i.f),s.Ob(i.a),s.Ob(U))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-creator"]],viewQuery:function(t,e){if(1&t&&s.Jc(Rb,!0),2&t){let t;s.qc(t=s.cc())&&(e.titleInput=t.first)}},inputs:{issueData:"issueData",isEditMode:"isEditMode"},features:[s.Ab],decls:12,vars:17,consts:[[1,"creator-card",3,"ngClass"],[4,"ngIf"],[1,"mt-2"],[1,"actions"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button","class","btn btn-info",3,"click",4,"ngIf"],["mat-card-avatar","",1,"creator-header-image"],[1,"if","f-w-700"],[1,"title-parent"],["type","button",1,"btn","btn-info",3,"click"],[1,"issue-form",3,"formGroup"],[1,"full-w"],["matInput","","placeholder","Add NgRx to app...","formControlName","title"],["titleInput",""],["align","end"],[1,"full-w","mb-2"],["matInput","","placeholder","Install latest NgRx...","cdkTextareaAutosize","","formControlName","description",3,"cdkTextareaAutosize","cdkAutosizeMinRows"],["formControlName","priority",1,"priority-radio"],["color","primary",3,"value","class",4,"ngFor","ngForOf"],["color","primary",3,"value"],[1,"priority-val"]],template:function(t,e){1&t&&(s.Ub(0,"mat-card",0),s.gc(1,"async"),s.gc(2,"async"),s.Cc(3,Ub,11,2,"mat-card-header",1),s.gc(4,"async"),s.Ub(5,"mat-card-content",2),s.Cc(6,Vb,16,7,"div",1),s.Tb(),s.Ub(7,"mat-card-actions",3),s.Ub(8,"button",4),s.bc("click",function(){return e.onSubmit()}),s.Ec(9),s.gc(10,"async"),s.Tb(),s.Cc(11,qb,2,0,"button",5),s.Tb(),s.Tb()),2&t&&(s.lc("ngClass",s.oc(14,Fb,s.hc(1,6,e.cos.getIssueEditMode$),!s.hc(2,8,e.cos.getIssueEditMode$))),s.Cb(3),s.lc("ngIf",!s.hc(4,10,e.cos.getIssueEditMode$)),s.Cb(3),s.lc("ngIf",e.issueFg),s.Cb(2),s.lc("disabled",null==e.issueFg?null:e.issueFg.invalid),s.Cb(1),s.Gc(" ",s.hc(10,12,e.cos.getIssueEditMode$)?"Save edits":"Submit new issue"," "),s.Cb(2),s.lc("ngIf",!(null!=e.issueFg&&e.issueFg.pristine)))},directives:[Pb.a,r.i,r.k,Pb.d,Pb.b,Pb.e,Pb.c,Pb.h,Pb.g,pb.r,pb.n,pb.h,lb.b,lb.f,fb.b,pb.c,pb.m,pb.g,lb.e,Sb.b,Mb.b,r.j,Mb.a],pipes:[r.b,Xd,Yd],styles:[".creator-card[_ngcontent-%COMP%]{width:100%}.creator-header-image[_ngcontent-%COMP%]{background-image:url(/assets/banner/resolved2.png);background-size:95%;background-repeat:no-repeat}.issue-form[_ngcontent-%COMP%]{width:100%}.mat-radio-button[_ngcontent-%COMP%] ~ .mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.priority-val[_ngcontent-%COMP%]{font-size:15px;font-weight:700}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:19px}.title-parent[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.btn.btn-info[_ngcontent-%COMP%]{font-family:Roboto}mat-card-subtitle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px}"]}),t})();function zb(t,e){if(1&t&&(s.Ub(0,"div",8),s.Ub(1,"div",9),s.Pb(2,"app-core-issue-creator",10),s.Tb(),s.Tb()),2&t){const t=s.fc();s.Cb(2),s.lc("issueData",t.newIssue)}}function Gb(t,e){if(1&t&&(s.Sb(0),s.Ub(1,"div",1),s.Ub(2,"div",2),s.Ub(3,"p",3),s.Ec(4),s.Tb(),s.Tb(),s.Tb(),s.Rb()),2&t){const t=s.fc();s.Cb(4),s.Gc(" ",null==t.issue?null:t.issue.description," ")}}function Kb(t,e){if(1&t&&(s.Sb(0),s.Ub(1,"div",1),s.Ub(2,"div",2),s.Pb(3,"app-core-issue-creator",3),s.gc(4,"async"),s.Tb(),s.Tb(),s.Rb()),2&t){const t=e.ngIf,n=s.fc();s.Cb(3),s.lc("issueData",t)("isEditMode",s.hc(4,2,n.cs.getIssueEditMode$))}}const $b=[{path:"",component:L,children:[{path:"",redirectTo:"all",pathMatch:"full"},{path:"all",component:(()=>{class t{constructor(t,e,n,r){this.cs=t,this.router=e,this.route=n,this.ims=r,this.compDest$=new o.a,this.showIssueCreatePane=!1,this.newIssue=void 0,this.searchCtrl=q.b(null,!1)}ngOnInit(){this.cs.getQueryParamById$.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.showIssueCreatePane=!!t}),this.searchCtrl.valueChanges.pipe(Object(ab.a)(500),Object(cb.a)((t,e)=>t===e),Object(V.a)(this.compDest$)).subscribe(t=>{this.searchForIssues(t)}),this.cs.getUserSearchTerm$.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.searchCtrl.setValue(t,{emitEvent:!1})})}onInputActionClick(){this.searchCtrl.pristine?this.searchForIssues(this.searchCtrl.value):this.searchCtrl.reset()}searchForIssues(t){let e=null;t&&""!==t.trim()&&(e=t.trim()),this.cs.getAllIssues(e)}onNewIssue(){this.router.navigate(["./"],{queryParams:{newIssuePane:"open"}}),this.newIssue=void 0}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(U),s.Ob(i.f),s.Ob(i.a),s.Ob(hb.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-all-issues"]],decls:17,vars:5,consts:[[1,"row","mt-3"],[1,"col-lg-12"],[1,"actions"],["matInput","","placeholder","NgRx upgrade",3,"formControl","keyup.enter"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"],[1,"btn-parent"],["type","button",1,"btn","btn-success",3,"click"],["class","row my-3",4,"ngIf"],[1,"row","my-3"],[1,"offset-lg-1","col-lg-10"],[3,"issueData"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Ub(1,"div",1),s.Ub(2,"div",2),s.Ub(3,"div"),s.Ub(4,"mat-form-field"),s.Ub(5,"mat-label"),s.Ec(6,"Search issues.."),s.Tb(),s.Ub(7,"input",3),s.bc("keyup.enter",function(){return e.searchForIssues(e.searchCtrl.value)}),s.Tb(),s.Ub(8,"button",4),s.bc("click",function(){return e.onInputActionClick()}),s.Ub(9,"mat-icon"),s.Ec(10),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Ub(11,"div",5),s.Ub(12,"button",6),s.bc("click",function(){return e.onNewIssue()}),s.Ec(13,"New issue"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Cc(14,zb,3,1,"div",7),s.Pb(15,"hr"),s.Pb(16,"app-core-issue-display")),2&t&&(s.Cb(3),s.Eb(e.ims.mediaQList.matches?"":"input-parent-min-width"),s.Cb(4),s.lc("formControl",e.searchCtrl),s.Cb(3),s.Gc(" ",e.searchCtrl.pristine?"search":"clear"," "),s.Cb(4),s.lc("ngIf",e.showIssueCreatePane))},directives:[lb.b,lb.f,fb.b,pb.c,pb.m,pb.f,B.a,lb.g,Fd.a,r.k,kb,Bb],styles:[".row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.actions[_ngcontent-%COMP%]   .btn-parent[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-form-field[_ngcontent-%COMP%]{width:100%}.input-parent-min-width[_ngcontent-%COMP%]{min-width:500px}button.issue[_ngcontent-%COMP%]{background-color:#2ea44f;color:#fff}"]}),t})()},{path:":id",component:ub,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:(()=>{class t{constructor(t,e,n,r){this.store=t,this.router=e,this.route=n,this.cs=r,this.compDest$=new o.a,this.issue=void 0}ngOnInit(){this.cs.getIssueBySelectedId$.pipe(Object(V.a)(this.compDest$)).subscribe(t=>{this.issue=t})}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(c.h),s.Ob(i.f),s.Ob(i.a),s.Ob(U))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-detail-view"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[1,"desc"]],template:function(t,e){1&t&&s.Cc(0,Gb,5,1,"ng-container",0),2&t&&s.lc("ngIf",e.issue)},directives:[r.k],styles:[""]}),t})()},{path:"edit",component:(()=>{class t{constructor(t){this.cs=t,this.cs.toggleIssueEditMode(!0)}ngOnInit(){}ngOnDestroy(){this.cs.toggleIssueEditMode(!1)}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(U))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-core-issue-detail-edit"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[3,"issueData","isEditMode"]],template:function(t,e){1&t&&(s.Cc(0,Kb,5,4,"ng-container",0),s.gc(1,"async")),2&t&&s.lc("ngIf",s.hc(1,1,e.cs.getIssueBySelectedId$))},directives:[r.k,Bb],pipes:[r.b],styles:[""]}),t})()}]}]}];let Wb=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[i.i.forChild($b)],i.i]}),t})();var Yb=n("oJm8"),Hb=n("9jGm"),Qb=n("5+tZ"),Xb=n("XqQ8"),Jb=n("vkgz"),Zb=n("bOdf");function tv(t){return t?function(t){let e="Server error occured.";switch(t.code){case"auth/email-already-in-use":e="Email already exists.";break;case"auth/invalid-email":e="Email is invalid.";break;case"auth/operation-not-allowed":e="This operation is currently not allowed.";break;case"auth/weak-password":e="Password is too weak, try 6+ characters.";break;case"auth/user-not-found":e="User does not exist.";break;case"auth/wrong-password":e="Invalid password.";break;case"permission-denied":e="You do not have the permission to take this action.";break;case"":e="BLAH."}return e+" "+t.message}(t):"Server error occured, but could not get a detailed message from backend."}var ev=n("mAmA");const nv=[(()=>{class t{constructor(t,e,n,r){this.actions$=t,this.ts=e,this.cs=n,this.cos=r,this.onAddIssue$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.g),Object(Qb.a)(t=>{const e=t.data,n=t.url;return this.cs.createDocument(e,n).then(t=>{const r=(new Date).getTime();return p.h({data:{id:e.id,changes:{created:!0,loading:!1}},dateFinished:r,url:n})},t=>{console.log("err: ",t);const n=tv(t);return p.f({errMsg:n,data:e})})}))),this.onSuccessfullyIssueAdded$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.h),Object(Qb.a)(t=>this.cs.updatePartialDocument(t.data,t.url).then(t=>p.e(),t=>{const e=tv(t);return p.d({errorMsg:e})})))),this.onSuccessfullyCleanup$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.e),Object(Y.a)(()=>(this.ts.getSnackbar("Issue created successfully"),p.p({url:R,searchTerm:null,showLoadMask:!1}))))),this.loadAllIssues$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.p),Object(bd.a)(t=>this.cs.readCollections(t.url,t.searchTerm).then(t=>{let e=[];const n=(new Date).getTime();return t.docs.forEach(t=>{e.push(t.data())}),p.q({data:e,updatedTime:n})},t=>{const e=tv(t);return p.o({errMsg:e})})))),this.closeAIssue$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.b),Object(Xb.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{open:!1,loading:!0}},"issues/"+e.id).then(t=>p.c({data:e}),t=>{const n=tv(t);return p.a({data:e,errMsg:n})})}))),this.closeAIssueSuccess$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.c),Object(Qb.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{loading:!1}},"issues/"+e.id).then(t=>{this.ts.getSnackbar("Issue closed successfully!")},t=>{const e=tv(t);this.ts.getError("Error occured closing issue. "+e)})})),{dispatch:!1}),this.openAIssue$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.s),Object(Xb.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{open:!0,loading:!0}},"issues/"+e.id).then(t=>p.t({data:e}),t=>{const n=tv(t);return p.r({data:e,errMsg:n})})}))),this.openAIssueSuccess$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.t),Object(Qb.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{loading:!1}},"issues/"+e.id).then(t=>{this.ts.getSnackbar("Issue reopened successfully!")},t=>{const e=tv(t);this.ts.getError("Error occured closing issue. "+e)})})),{dispatch:!1}),this.onFailedCleanup$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.d),Object(Jb.a)(()=>{this.ts.getSnackbar("Error occured creating the issue")})),{dispatch:!1}),this.onDeleteIssue$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.j),Object(Xb.a)(t=>{const e=t.issue;return this.cs.deleteDocument(e,t.url).then(t=>p.k({issue:e}),t=>{const n=tv(t);return p.i({issue:e,errMsg:n})})}))),this.onDeleteIssueSuccess$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.k),Object(Jb.a)(t=>{this.ts.getSnackbar("Issue #"+t.issue.issueNumber+" was deleted successfully"),this.cos.goBackToIssuesPage()})),{dispatch:!1}),this.onEditIssue$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.m),Object(Zb.a)(t=>{const e=t.issue,n=t.updates;let r={id:t.issue.id,changes:Object.assign(Object.assign({},t.updates.changes),{loading:!1})};return this.cs.updatePartialDocument(r,t.url).then(t=>p.n({issue:n}),t=>{const n=tv(t);return p.l({errMsg:n,issue:e})})}))),this.onEditIssueSuccess$=Object(Hb.c)(()=>this.actions$.pipe(Object(Hb.d)(p.n),Object(Jb.a)(t=>{this.ts.getSnackbar("Issue #"+t.issue.changes.issueNumber+" was edited"),this.cos.goToIssueDetailView(t.issue.id)})),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(Hb.a),s.Yb(ev.a),s.Yb(Vd),s.Yb(U))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac}),t})()];var rv=n("37S3"),iv=n("PCNd");let ov=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c]]}),t})(),sv=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c,pb.p,pb.i,Yb.a,c.j.forFeature("issues",O),Hb.b.forFeature(nv),rv.a,iv.a,ov,Wb]]}),t})()}}]);