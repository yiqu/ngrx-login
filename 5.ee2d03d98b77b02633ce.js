(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{pKmL:function(t,e,n){"use strict";n.r(e),n.d(e,"CoreModule",function(){return ub});var r=n("ofXK"),i=n("tyNb"),o=n("XNiG"),s=n("fXoL"),u=n("+Rhh"),a=n("99NH"),c=n("l7P3");const h=Object(c.o)("myRouter"),{selectQueryParam:f,selectRouteParam:l}=a.b(h);var p=n("Q3uk");const d={EntitiesOnly:0,Both:1,None:2};function v(t){return function(e,n){const r={ids:[...n.ids],entities:Object.assign({},n.entities)},i=t(e,r);return i===d.Both?Object.assign({},n,r):i===d.EntitiesOnly?Object.assign(Object.assign({},n),{entities:r.entities}):n}}function b(t,e){const n=e(t);return Object(s.Z)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),n}function y(t){function e(e,n){const r=b(e,t);return r in n.entities?d.None:(n.ids.push(r),n.entities[r]=e,d.Both)}function n(t,n){let r=!1;for(const i of t)r=e(i,n)!==d.None||r;return r?d.Both:d.None}function r(t,e){return e.ids=[],e.entities={},n(t,e),d.Both}function i(t,e){const n=(t instanceof Array?t:e.ids.filter(n=>t(e.entities[n]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return n&&(e.ids=e.ids.filter(t=>t in e.entities)),n?d.Both:d.None}function o(t,e){return s([t],e)}function s(e,n){const r={};return(e=e.filter(t=>t.id in n.entities)).length>0?e.filter(e=>function(e,n,r){const i=Object.assign({},r.entities[n.id],n.changes),o=b(i,t),s=o!==n.id;return s&&(e[n.id]=o,delete r.entities[n.id]),r.entities[o]=i,s}(r,e,n)).length>0?(n.ids=n.ids.map(t=>r[t]||t),d.Both):d.EntitiesOnly:d.None}function u(e,r){const i=[],o=[];for(const n of e){const e=b(n,t);e in r.entities?o.push({id:e,changes:n}):i.push(n)}const u=s(o,r),a=n(i,r);switch(!0){case a===d.None&&u===d.None:return d.None;case a===d.Both||u===d.Both:return d.Both;default:return d.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:v(e),addMany:v(n),addAll:v(r),setAll:v(r),setOne:v(function(e,n){const r=b(e,t);return r in n.entities?(n.entities[r]=e,d.EntitiesOnly):(n.ids.push(r),n.entities[r]=e,d.Both)}),updateOne:v(o),updateMany:v(s),upsertOne:v(function(t,e){return u([t],e)}),upsertMany:v(u),removeOne:v(function(t,e){return i([t],e)}),removeMany:v(i),map:v(function(t,e){return s(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]).filter(({id:t})=>t in e.entities),e)}),mapOne:v(function({map:t,id:e},n){const r=n.entities[e];return r?o({id:e,changes:t(r)},n):d.None})}}d[d.EntitiesOnly]="EntitiesOnly",d[d.Both]="Both",d[d.None]="None";const g=function(t={}){const{selectId:e,sortComparer:n}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),r={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},i={getSelectors:function(t){const e=t=>t.ids,n=t=>t.entities,r=Object(c.q)(e,n,(t,e)=>t.map(t=>e[t])),i=Object(c.q)(e,t=>t.length);return t?{selectIds:Object(c.q)(t,e),selectEntities:Object(c.q)(t,n),selectAll:Object(c.q)(t,r),selectTotal:Object(c.q)(t,i)}:{selectIds:e,selectEntities:n,selectAll:r,selectTotal:i}}},o=n?function(t,e){const{removeOne:n,removeMany:r,removeAll:i}=y(t);function o(t,e){return s([t],e)}function s(e,n){const r=e.filter(e=>!(b(e,t)in n.entities));return 0===r.length?d.None:(f(r,n),d.Both)}function u(t,e){return e.entities={},e.ids=[],s(t,e),d.Both}function a(t,e){return c([t],e)}function c(e,n){const r=[],i=e.filter(e=>function(e,n,r){if(!(n.id in r.entities))return!1;const i=Object.assign({},r.entities[n.id],n.changes),o=b(i,t);return delete r.entities[n.id],e.push(i),o!==n.id}(r,e,n)).length>0;if(0===r.length)return d.None;{const t=n.ids,e=[];return n.ids=n.ids.filter((t,r)=>t in n.entities||(e.push(r),!1)),f(r,n),!i&&e.every(e=>n.ids[e]===t[e])?d.EntitiesOnly:d.Both}}function h(e,n){const r=[],i=[];for(const s of e){const e=b(s,t);e in n.entities?i.push({id:e,changes:s}):r.push(s)}const o=c(i,n),u=s(r,n);switch(!0){case u===d.None&&o===d.None:return d.None;case u===d.Both||o===d.Both:return d.Both;default:return d.EntitiesOnly}}function f(n,r){n.sort(e);const i=[];let o=0,s=0;for(;o<n.length&&s<r.ids.length;){const u=n[o],a=b(u,t),c=r.ids[s];e(u,r.entities[c])<=0?(i.push(a),o++):(i.push(c),s++)}r.ids=i.concat(o<n.length?n.slice(o).map(t):r.ids.slice(s)),n.forEach((e,n)=>{r.entities[t(e)]=e})}return{removeOne:n,removeMany:r,removeAll:i,addOne:v(o),updateOne:v(a),upsertOne:v(function(t,e){return h([t],e)}),addAll:v(u),setAll:v(u),setOne:v(function(e,n){const r=b(e,t);return r in n.entities?(n.ids=n.ids.filter(t=>t!==r),f([e],n),d.Both):o(e,n)}),addMany:v(s),updateMany:v(c),upsertMany:v(h),map:v(function(t,e){return c(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]),e)}),mapOne:v(function({map:t,id:e},n){const r=n.entities[e];return r?a({id:e,changes:t(r)},n):d.None})}}(e,n):y(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:n},r),i),o)}({selectId:function(t){return t.id}}),m=g.getInitialState({loading:!1,fbError:!1,allIssuesLastFetched:0}),w=Object(c.p)(m,Object(c.r)(p.g,(t,{data:e})=>g.addOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.h,(t,{data:e})=>g.updateOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.f,(t,{data:e,errMsg:n})=>g.removeOne(e.id,Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.e,t=>Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null})),Object(c.r)(p.d,(t,{errorMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:e})),Object(c.r)(p.p,(t,{searchTerm:e,showLoadMask:n})=>{let r;return r=n,Object.assign(Object.assign({},t),{issuesRefreshingLoading:r,searchTerm:e,loading:!0,fbError:!1,fbErrorMsg:null})}),Object(c.r)(p.q,(t,{data:e,updatedTime:n})=>g.setAll(e,Object.assign(Object.assign({},t),{allIssuesLastFetched:n,issuesRefreshingLoading:!1,loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.o,(t,{errMsg:e})=>Object.assign(Object.assign({},t),{issuesRefreshingLoading:!1,loading:!1,fbError:!0,fbErrorMsg:e})),Object(c.r)(p.b,(t,{data:e})=>g.updateOne({id:e.id,changes:{open:!1,loading:!0}},Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.c,(t,{data:e})=>g.updateOne({id:e.id,changes:{loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.a,(t,{data:e,errMsg:n})=>g.updateOne({id:e.id,changes:{open:!0,loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.s,(t,{data:e})=>g.updateOne({id:e.id,changes:{open:!0,loading:!0}},Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.t,(t,{data:e})=>g.updateOne({id:e.id,changes:{loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.r,(t,{data:e,errMsg:n})=>g.updateOne({id:e.id,changes:{open:!1,loading:!1}},Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.v,(t,{issueId:e})=>Object.assign(Object.assign({},t),{selectedIssueId:e})),Object(c.r)(p.w,(t,{inEditMode:e})=>Object.assign(Object.assign({},t),{issueEditMode:e})),Object(c.r)(p.j,(t,{issue:e})=>(console.log(e),g.removeOne(e.id,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null})))),Object(c.r)(p.k,(t,{})=>Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null})),Object(c.r)(p.i,(t,{issue:e,errMsg:n})=>g.addOne(e,Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(c.r)(p.m,(t,{updates:e})=>g.updateOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(c.r)(p.n,(t,{issue:e})=>{const n={id:e.id+"",changes:Object.assign(Object.assign({},e.changes),{loading:!1})};return g.updateOne(n,Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null}))}),Object(c.r)(p.u,(t,{time:e})=>Object.assign(Object.assign({},t),{lastRefreshAllRequest:e})));function I(t,e){return w(t,e)}const O=Object(c.o)("issues"),E=(Object(c.q)(O,g.getSelectors().selectIds),Object(c.q)(O,g.getSelectors().selectEntities)),_=Object(c.q)(O,g.getSelectors().selectAll),T=Object(c.q)(O,g.getSelectors().selectTotal),j=(Object(c.q)(O,t=>t.ids?t.ids.length:0),t=>Object(c.q)(E,e=>t?e[t]:void 0)),N=Object(c.q)(_,t=>t.reduce((t,e)=>{let n=t;return e.open&&(n+=1),n},0)),S=Object(c.q)(T,N,(t,e)=>t-e),A=Object(c.q)(O,t=>t.loading),D=Object(c.q)(O,t=>t.selectedIssueId),C=Object(c.q)(D,E,(t,e)=>{if(t)return e[t]}),x=Object(c.q)(O,t=>t.issueEditMode),k=Object(c.q)(O,t=>t.lastRefreshAllRequest),P=Object(c.q)(O,t=>t.issuesRefreshingLoading),M=Object(c.q)(O,t=>t.searchTerm&&""===t.searchTerm.trim()?null:t.searchTerm),V="issues";let L=(()=>{class t{constructor(t,e,n){this.store=t,this.router=e,this.route=n,this.getQueryParamById$=this.store.select(f("newIssuePane")),this.getAllIssues$=this.store.select(_),this.openIssueCount$=this.store.select(N),this.closedIssueCount$=this.store.select(S),this.totalIssueCount$=this.store.select(T),this.getIssueCounterNumber=t=>this.store.select((t=>Object(c.q)(j(t),t=>null==t?void 0:t.issueNumber))(t)),this.getIssueById=t=>this.store.select(j(t)),this.getIssueByParamId=t=>this.store.select((t=>Object(c.q)(l(t),E,(t,e)=>{if(t)return e[t]}))(t)),this.getIssueBySelectedId$=this.store.select(C),this.issueOverallLoading$=this.store.select(A),this.getIssueEditMode$=this.store.select(x),this.refreshAllIssuesRequest$=this.store.select(k),this.issuesRefreshLoading$=this.store.select(P),this.getUserSearchTerm$=this.store.select(M),this.currentIssueCounter=1,this.totalIssueCount$.subscribe(t=>{this.currentIssueCounter=t+1}),this.refreshAllIssuesRequest$.subscribe(t=>{t&&(console.log("refreshing all issues:",t),this.getAllIssues(null,!0))})}toggleNewIssuePane(t){this.store.dispatch(u.a({open:t}))}getAllIssues(t,e=!1){this.store.dispatch(p.p({url:V,searchTerm:t,showLoadMask:e}))}toggleOpenCloseIssue(t){this.store.dispatch(t.open?p.b({data:t}):p.s({data:t}))}setSelectedIssueId(t){this.store.dispatch(p.v({issueId:t}))}toggleIssueEditMode(t){this.store.dispatch(p.w({inEditMode:t}))}deleteIssue(t,e){this.store.dispatch(p.j({issue:t,url:e}))}goBackToIssuesPage(){this.router.navigate(["/","issues"])}goToIssueDetailView(t){this.router.navigate(["/issues",t])}editIssue(t,e){this.store.dispatch(p.m({updates:t,url:"issues/"+t.id,issue:e}))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(c.h),s.Zb(i.f),s.Zb(i.a))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),U=(()=>{class t{constructor(t,e,n,r){this.cs=t,this.router=e,this.route=n,this.store=r,this.compDest$=new o.a}ngOnInit(){}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(L),s.Pb(i.f),s.Pb(i.a),s.Pb(c.h))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core"]],decls:2,vars:0,consts:[[1,"container","mb-3"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Qb(1,"router-outlet"),s.Ub())},directives:[i.j],styles:[""]}),t})();var R=n("1G5W"),F=n("ooqH"),q=n("0IaG"),G=n("bTqV");let B=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}ngOnInit(){}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(q.f),s.Pb(q.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-shared-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,e){1&t&&(s.Vb(0,"h1",0),s.Gc(1,"Confirmation"),s.Ub(),s.Vb(2,"div",1),s.Vb(3,"p"),s.Gc(4),s.Ub(),s.Ub(),s.Vb(5,"div",2),s.Vb(6,"button",3),s.cc("click",function(){return e.onNoClick()}),s.Gc(7,"No"),s.Ub(),s.Vb(8,"button",4),s.cc("click",function(){return e.onYesClick()}),s.Gc(9,"Yes"),s.Ub(),s.Ub()),2&t&&(s.Db(4),s.Ic("Are you sure you want to ",null==e.data?null:e.data.actionName,""))},directives:[q.g,q.d,q.c,G.a],styles:[""]}),t})();var z=n("D0XW"),H=n("HDdC"),K=n("Cfvw"),$=n("LRne"),J=n("lJxs"),W=n("Kqap"),Q=n("pLZG"),X=n("pxpQ"),Y=n("spgP"),Z=n("zIRd"),tt=n("q/0M"),et=n("qOnz"),nt=function(t,e){return(nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function rt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var it,ot="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},st=st||{},ut=ot||self;function at(){}function ct(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ht(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ft="closure_uid_"+(1e9*Math.random()>>>0),lt=0;function pt(t,e,n){return t.call.apply(t.bind,arguments)}function dt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function vt(t,e,n){return(vt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?pt:dt).apply(null,arguments)}function bt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function yt(){return Date.now()}function gt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function mt(){this.j=this.j,this.i=this.i}mt.prototype.j=!1,mt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ft)&&t[ft]||(t[ft]=++lt)}(this)},mt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var wt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},It=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Ot(t){return Array.prototype.concat.apply([],arguments)}function Et(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function _t(t){return/^[\s\xa0]*$/.test(t)}var Tt,jt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Nt(t,e){return-1!=t.indexOf(e)}function St(t,e){return t<e?-1:t>e?1:0}t:{var At=ut.navigator;if(At){var Dt=At.userAgent;if(Dt){Tt=Dt;break t}}Tt=""}function Ct(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function xt(t){var e={};for(var n in t)e[n]=t[n];return e}var kt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<kt.length;o++)n=kt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Mt(t){return Mt[" "](t),t}Mt[" "]=at;var Vt,Lt,Ut=Nt(Tt,"Opera"),Rt=Nt(Tt,"Trident")||Nt(Tt,"MSIE"),Ft=Nt(Tt,"Edge"),qt=Ft||Rt,Gt=Nt(Tt,"Gecko")&&!(Nt(Tt.toLowerCase(),"webkit")&&!Nt(Tt,"Edge"))&&!(Nt(Tt,"Trident")||Nt(Tt,"MSIE"))&&!Nt(Tt,"Edge"),Bt=Nt(Tt.toLowerCase(),"webkit")&&!Nt(Tt,"Edge");function zt(){var t=ut.document;return t?t.documentMode:void 0}t:{var Ht="",Kt=(Lt=Tt,Gt?/rv:([^\);]+)(\)|;)/.exec(Lt):Ft?/Edge\/([\d\.]+)/.exec(Lt):Rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Lt):Bt?/WebKit\/(\S+)/.exec(Lt):Ut?/(?:Version)[ \/]?(\S+)/.exec(Lt):void 0);if(Kt&&(Ht=Kt?Kt[1]:""),Rt){var $t=zt();if(null!=$t&&$t>parseFloat(Ht)){Vt=String($t);break t}}Vt=Ht}var Jt={};function Wt(t){return function(t,e){var n=Jt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=jt(String(Vt)).split("."),r=jt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=St(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||St(0==s[2].length,0==u[2].length)||St(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var Qt=ut.document&&Rt&&(zt()||parseInt(Vt,10))||void 0,Xt=!Rt||9<=Number(Qt),Yt=Rt&&!Wt("9"),Zt=function(){if(!ut.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ut.addEventListener("test",at,e),ut.removeEventListener("test",at,e)}catch(n){}return t}();function te(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ee(t,e){if(te.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Gt){t:{try{Mt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ne[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}te.prototype.b=function(){this.defaultPrevented=!0},gt(ee,te);var ne={2:"touch",3:"pen",4:"mouse"};ee.prototype.b=function(){ee.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var re="closure_listenable_"+(1e6*Math.random()|0),ie=0;function oe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ie,this.Y=this.Z=!1}function se(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ue(t){this.src=t,this.a={},this.b=0}function ae(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=wt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(se(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ce(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ue.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ce(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new oe(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var he="closure_lm_"+(1e6*Math.random()|0),fe={};function le(t,e,n,r,i){if(r&&r.once)return de(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)le(t,e[o],n,r,i);return null}return n=Oe(n),t&&t[re]?t.va(e,n,ht(r)?!!r.capture:!!r,i):pe(t,e,n,!1,r,i)}function pe(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ht(i)?!!i.capture:!!i;if(s&&!Xt)return null;var u=we(t);if(u||(t[he]=u=new ue(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=me,e=Xt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Zt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ye(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function de(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)de(t,e[o],n,r,i);return null}return n=Oe(n),t&&t[re]?t.wa(e,n,ht(r)?!!r.capture:!!r,i):pe(t,e,n,!0,r,i)}function ve(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ve(t,e[o],n,r,i);else r=ht(r)?!!r.capture:!!r,n=Oe(n),t&&t[re]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=ce(o=t.a[e],n,r,i))&&(se(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=we(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ce(e,n,r,i)),(n=-1<t?e[t]:null)&&be(n))}function be(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[re])ae(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ye(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=we(e))?(ae(n,t),0==n.b&&(n.src=null,e[he]=null)):se(t)}}}function ye(t){return t in fe?fe[t]:fe[t]="on"+t}function ge(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&be(t),n.call(r,e)}function me(t,e){if(t.Y)return!0;if(!Xt){if(!e)t:{e=["window","event"];for(var n=ut,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ge(t,e=new ee(e,this))}return ge(t,new ee(e,this))}function we(t){return(t=t[he])instanceof ue?t:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oe(t){return"function"==typeof t?t:(t[Ie]||(t[Ie]=function(e){return t.handleEvent(e)}),t[Ie])}function Ee(){mt.call(this),this.c=new ue(this),this.J=this,this.C=null}function _e(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new te(e,t);else if(e instanceof te)e.target=e.target||t;else{var i=e;Pt(e=new te(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Te(s,r,!0,e)&&i}if(i=Te(s=e.a=t,r,!0,e)&&i,i=Te(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Te(s=e.a=n[o],r,!1,e)&&i}function Te(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&ae(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}gt(Ee,mt),Ee.prototype[re]=!0,(it=Ee.prototype).addEventListener=function(t,e,n,r){le(this,t,e,n,r)},it.removeEventListener=function(t,e,n,r){ve(this,t,e,n,r)},it.G=function(){if(Ee.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)se(n[r]);delete e.a[t],e.b--}}this.C=null},it.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},it.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var je=ut.JSON.stringify;function Ne(){this.b=this.a=null}var Se,Ae=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new Ce},function(t){t.reset()});function De(){var t=Me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ce(){this.next=this.b=this.a=null}function xe(t){ut.setTimeout(function(){throw t},0)}function ke(t,e){Se||function(){var t=ut.Promise.resolve(void 0);Se=function(){t.then(Ve)}}(),Pe||(Se(),Pe=!0),Me.add(t,e)}Ne.prototype.add=function(t,e){var n=Ae.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ce.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ce.prototype.reset=function(){this.next=this.b=this.a=null};var Pe=!1,Me=new Ne;function Ve(){for(var t;t=De();){try{t.a.call(t.b)}catch(n){xe(n)}var e=Ae;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Pe=!1}function Le(t,e){Ee.call(this),this.b=t||1,this.a=e||ut,this.f=vt(this.Za,this),this.g=yt()}function Ue(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Re(t,e,n){if("function"==typeof t)n&&(t=vt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=vt(t.handleEvent,t)}return 2147483647<Number(e)?-1:ut.setTimeout(t,e||0)}function Fe(t){t.a=Re(function(){t.a=null,t.c&&(t.c=!1,Fe(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}gt(Le,Ee),(it=Le.prototype).aa=!1,it.M=null,it.Za=function(){if(this.aa){var t=yt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),_e(this,"tick"),this.aa&&(Ue(this),this.start()))}},it.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=yt())},it.G=function(){Le.X.G.call(this),Ue(this),delete this.a};var qe=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}nt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Fe(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(ut.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(mt);function Ge(t){mt.call(this),this.b=t,this.a={}}gt(Ge,mt);var Be=[];function ze(t,e,n,r){Array.isArray(n)||(n&&(Be[0]=n.toString()),n=Be);for(var i=0;i<n.length;i++){var o=le(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function He(t){Ct(t.a,function(t,e){this.a.hasOwnProperty(e)&&be(t)},t),t.a={}}function Ke(){this.a=!0}function $e(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return je(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}Ge.prototype.G=function(){Ge.X.G.call(this),He(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ke.prototype.info=function(){};var Je={},We=null;function Qe(){return We=We||new Ee}function Xe(t){te.call(this,Je.Fa,t)}function Ye(t){var e=Qe();_e(e,new Xe(e,t))}function Ze(t,e){te.call(this,Je.STAT_EVENT,t),this.stat=e}function tn(t){var e=Qe();_e(e,new Ze(e,t))}function en(t){te.call(this,Je.Ga,t)}function nn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ut.setTimeout(function(){t()},e)}Je.Fa="serverreachability",gt(Xe,te),Je.STAT_EVENT="statevent",gt(Ze,te),Je.Ga="timingevent",gt(en,te);var rn={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},on={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function sn(){}function un(){}sn.prototype.a=null;var an,cn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function hn(){te.call(this,"d")}function fn(){te.call(this,"c")}function ln(){}function pn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ge(this),this.P=dn,this.R=new Le(t=qt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}gt(hn,te),gt(fn,te),gt(ln,sn),an=new ln;var dn=45e3,vn={},bn={};function yn(t,e,n){t.H=1,t.i=Rn(kn(e)),t.j=n,t.I=!0,gn(t,null)}function gn(t,e){t.u=yt(),In(t),t.l=kn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Yn(n.b,"t",r),t.D=0,t.a=Kr(t.g,t.g.C?e:null),0<t.O&&(t.F=new qe(vt(t.Ca,t,t.a),t.O)),ze(t.J,t.a,"readystatechange",t.Xa),e=t.B?xt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ye(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function mn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=wn(t,n);if(i==bn){4==e&&(t.h=4,tn(14),r=!1),$e(t.c,t.f,null,"[Incomplete Response]");break}if(i==vn){t.h=4,tn(15),$e(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}$e(t.c,t.f,i,null),jn(t,i)}4==e&&0==n.length&&(t.h=1,tn(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ur(e),e.F=!0,tn(11))):($e(t.c,t.f,n,"[Invalid Chunked Response]"),Tn(t),_n(t))}function wn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?bn:(n=Number(e.substring(n,r)),isNaN(n)?vn:(r+=1)+n>e.length?bn:(e=e.substr(r,n),t.D=r+n,e))}function In(t){t.T=yt()+t.P,On(t,t.P)}function On(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=nn(vt(t.Va,t),e)}function En(t){t.o&&(ut.clearTimeout(t.o),t.o=null)}function _n(t){0==t.g.v||t.A||qr(t.g,t)}function Tn(t){En(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ue(t.R),He(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function jn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||or(n.b,t)))if(n.I=t.N,!t.C&&or(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(xp){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Fr(n),Ar(n)}Lr(n),tn(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=nn(vt(n.Sa,n),6e3));if(1>=ir(n.b)&&n.ea){try{n.ea()}catch(xp){}n.ea=void 0}}else Br(n,11)}else if((t.C||n.a==t)&&Fr(n),!_t(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(Nt(h,"spdy")||Nt(h,"quic")||Nt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(sr(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Un(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=yt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Hr(a,a.C?a.ga:null,a.fa),p.C){ur(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(En(d),In(d)),a.a=p}else Vr(a);0<n.g.length&&xr(n)}else"stop"!=i[0]&&"close"!=i[0]||Br(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Br(n,7):Sr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Ye(4)}catch(xp){}}function Nn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ct(t)||"string"==typeof t)It(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(ct(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(ct(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Sn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Sn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function An(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Dn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(it=pn.prototype).setTimeout=function(t){this.P=t},it.Xa=function(t){t=t.target;var e=this.F;e&&3==_r(t)?e.f():this.Ca(t)},it.Ca=function(t){try{if(t==this.a)t:{var e=_r(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!qt&&!this.a.$())){this.A||4!=e||7==n||Ye(8==n||0>=r?3:2),En(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_t(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,tn(12),Tn(this),_n(this);break t}$e(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,jn(this,a)}this.I?(mn(this,e,o),qt&&this.b&&3==e&&(ze(this.J,this.R,"tick",this.Wa),this.R.start())):($e(this.c,this.f,o,null),jn(this,o)),4==e&&Tn(this),this.b&&!this.A&&(4==e?qr(this.g,this):(this.b=!1,In(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,tn(12)):(this.h=0,tn(13)),Tn(this),_n(this)}}}catch(c){}},it.Wa=function(){if(this.a){var t=_r(this.a),e=this.a.$();this.D<e.length&&(En(this),mn(this,t,e),this.b&&4!=t&&In(this))}},it.cancel=function(){this.A=!0,Tn(this)},it.Va=function(){this.o=null;var t=yt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Ye(3),tn(17)),Tn(this),this.h=2,_n(this)):On(this,this.T-t)},(it=Sn.prototype).K=function(){An(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},it.L=function(){return An(this),this.a.concat()},it.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},it.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},it.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Cn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof xn){this.a=void 0!==e?e:t.a,Pn(this,t.f),this.j=t.j,Mn(this,t.c),Vn(this,t.h),this.g=t.g,e=t.b;var n=new Jn;n.c=e.c,e.a&&(n.a=new Sn(e.a),n.b=e.b),Ln(this,n),this.i=t.i}else t&&(n=String(t).match(Cn))?(this.a=!!e,Pn(this,n[1]||"",!0),this.j=Fn(n[2]||""),Mn(this,n[3]||"",!0),Vn(this,n[4]),this.g=Fn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.i=Fn(n[7]||"")):(this.a=!!e,this.b=new Jn(null,this.a))}function kn(t){return new xn(t)}function Pn(t,e,n){t.f=n?Fn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Mn(t,e,n){t.c=n?Fn(e,!0):e}function Vn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ln(t,e,n){e instanceof Jn?(t.b=e,function(t,e){e&&!t.f&&(Wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Qn(this,e),Yn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=qn(e,Kn)),t.b=new Jn(e,t.a))}function Un(t,e,n){t.b.set(e,n)}function Rn(t){return Un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^yt()).toString(36)),t}function Fn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Gn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Gn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}xn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(qn(e,Bn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(qn(e,Bn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(qn(n,"/"==n.charAt(0)?Hn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",qn(n,$n)),t.join("")};var Bn=/[#\/\?@]/g,zn=/[#\?:]/g,Hn=/[#\?]/g,Kn=/[#\?@]/g,$n=/#/g;function Jn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Wn(t){t.a||(t.a=new Sn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Qn(t,e){Wn(t),e=Zn(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Dn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&An(t)))}function Xn(t,e){return Wn(t),e=Zn(t,e),Dn(t.a.b,e)}function Yn(t,e,n){Qn(t,e),0<n.length&&(t.c=null,t.a.set(Zn(t,e),Et(n)),t.b+=n.length)}function Zn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(it=Jn.prototype).add=function(t,e){Wn(this),this.c=null,t=Zn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},it.forEach=function(t,e){Wn(this),this.a.forEach(function(n,r){It(n,function(n){t.call(e,n,r,this)},this)},this)},it.L=function(){Wn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},it.K=function(t){Wn(this);var e=[];if("string"==typeof t)Xn(this,t)&&(e=Ot(e,this.a.get(Zn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Ot(e,t[n])}return e},it.set=function(t,e){return Wn(this),this.c=null,Xn(this,t=Zn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},it.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},it.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var tr=function(){return function(t,e){this.b=t,this.a=e}}();function er(t){this.g=t||nr,t=ut.PerformanceNavigationTiming?0<(t=ut.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(ut.ia&&ut.ia.ya&&ut.ia.ya()&&ut.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var nr=10;function rr(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ir(t){return t.b?1:t.a?t.a.size:0}function or(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function sr(t,e){t.a?t.a.add(e):t.b=e}function ur(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function ar(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=rt(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Et(t.c)}function cr(){}function hr(){this.a=new cr}function fr(t,e,n){var r=n||"";try{Nn(t,function(t,n){var i=t;ht(t)&&(i=je(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(md){throw e.push(r+"type="+encodeURIComponent("_badmap")),md}}function lr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}er.prototype.cancel=function(){var t,e;if(this.c=ar(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=rt(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},cr.prototype.stringify=function(t){return ut.JSON.stringify(t,void 0)},cr.prototype.parse=function(t){return ut.JSON.parse(t,void 0)};var pr=ut.JSON.parse;function dr(t){Ee.call(this),this.headers=new Sn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=vr,this.D=this.F=!1}gt(dr,Ee);var vr="",br=/^https?$/i,yr=["POST","PUT"];function gr(t){return"content-type"==t.toLowerCase()}function mr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,wr(t),Or(t)}function wr(t){t.u||(t.u=!0,_e(t,"complete"),_e(t,"error"))}function Ir(t){if(t.b&&void 0!==st&&(!t.s[1]||4!=_r(t)||2!=t.W()))if(t.l&&4==_r(t))Re(t.za,0,t);else if(_e(t,"readystatechange"),4==_r(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Cn)[1]||null;if(!o&&ut.self&&ut.self.location){var s=ut.self.location.protocol;o=s.substr(0,s.length-1)}i=!br.test(o?o.toLowerCase():"")}e=i}if(e)_e(t,"complete"),_e(t,"success");else{t.h=6;try{var u=2<_r(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",wr(t)}}finally{Or(t)}}}function Or(t,e){if(t.a){Er(t);var n=t.a,r=t.s[0]?at:null;t.a=null,t.s=null,e||_e(t,"ready");try{n.onreadystatechange=r}catch(md){}}}function Er(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(ut.clearTimeout(t.m),t.m=null)}function _r(t){return t.a?t.a.readyState:0}function Tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Ct(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Un(t,e,n))}function jr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Nr(t){this.pa=0,this.g=[],this.c=new Ke,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=jr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=jr("baseRetryDelayMs",5e3,t),this.Ra=jr("retryDelaySeedMs",1e4,t),this.Ma=jr("forwardChannelMaxRetries",2,t),this.ma=jr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new er(t&&t.concurrentRequestLimit),this.ka=new hr,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Sr(t){if(Dr(t),3==t.v){var e=t.R++,n=kn(t.B);Un(n,"SID",t.J),Un(n,"RID",e),Un(n,"TYPE","terminate"),Pr(t,n),(e=new pn(t,t.c,e,void 0)).H=2,e.i=Rn(kn(n)),n=!1,ut.navigator&&ut.navigator.sendBeacon&&(n=ut.navigator.sendBeacon(e.i.toString(),"")),!n&&ut.Image&&((new Image).src=e.i,n=!0),n||(e.a=Kr(e.g,null),e.a.ba(e.i)),e.u=yt(),In(e)}zr(t)}function Ar(t){t.a&&(Ur(t),t.a.cancel(),t.a=null)}function Dr(t){Ar(t),t.j&&(ut.clearTimeout(t.j),t.j=null),Fr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&ut.clearTimeout(t.h),t.h=null)}function Cr(t,e){t.g.push(new tr(t.Oa++,e)),3==t.v&&xr(t)}function xr(t){rr(t.b)||t.h||(t.h=!0,ke(t.Ba,t),t.u=0)}function kr(t,e){var n;n=e?e.f:t.R++;var r=kn(t.B);Un(r,"SID",t.J),Un(r,"RID",n),Un(r,"AID",t.P),Pr(t,r),t.i&&t.l&&Tr(r,t.i,t.l),n=new pn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Mr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),sr(t.b,n),yn(n,r,e)}function Pr(t,e){t.f&&Nn({},function(t,n){Un(e,n,t)})}function Mr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?vt(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{fr(h,s,"req"+c+"_")}catch(Si){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Vr(t){t.a||t.j||(t.T=1,ke(t.Aa,t),t.o=0)}function Lr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=nn(vt(t.Aa,t),Gr(t,t.o)),t.o++,0))}function Ur(t){null!=t.s&&(ut.clearTimeout(t.s),t.s=null)}function Rr(t){t.a=new pn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=kn(t.la);Un(e,"RID","rpc"),Un(e,"SID",t.J),Un(e,"CI",t.H?"0":"1"),Un(e,"AID",t.P),Pr(t,e),Un(e,"TYPE","xmlhttp"),t.i&&t.l&&Tr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Rn(kn(e)),n.j=null,n.I=!0,gn(n,t)}function Fr(t){null!=t.m&&(ut.clearTimeout(t.m),t.m=null)}function qr(t,e){var n=null;if(t.a==e){Fr(t),Ur(t),t.a=null;var r=2}else{if(!or(t.b,e))return;n=e.s,ur(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=yt()-e.u;var i=t.u;_e(r=Qe(),new en(r,n,e,i)),xr(t)}else Vr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ir(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=nn(vt(t.Ba,t,e),Gr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Lr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Br(t,5);break;case 4:Br(t,10);break;case 3:Br(t,6);break;default:Br(t,2)}}function Gr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Br(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=vt(t.Ya,t);n||(n=new xn("//www.google.com/images/cleardot.gif"),ut.location&&"http"==ut.location.protocol||Pn(n,"https"),Rn(n)),function(t,e){var n=new Ke;if(ut.Image){var r=new Image;r.onload=bt(lr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=bt(lr,n,r,"TestLoadImage: error",!1,e),r.onabort=bt(lr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=bt(lr,n,r,"TestLoadImage: timeout",!1,e),ut.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else tn(2);t.v=0,t.f&&t.f.ra(e),zr(t),Dr(t)}function zr(t){t.v=0,t.I=-1,t.f&&(0==ar(t.b).length&&0==t.g.length||(t.b.c.length=0,Et(t.g),t.g.length=0),t.f.qa())}function Hr(t,e,n){var r=function(t){return t instanceof xn?kn(t):new xn(t,void 0)}(n);if(""!=r.c)e&&Mn(r,e+"."+r.c),Vn(r,r.h);else{var i=ut.location;r=function(t,e,n,r){var i=new xn(null,void 0);return t&&Pn(i,t),e&&Mn(i,e),n&&Vn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Ct(t.V,function(t,e){Un(r,e,t)}),n=t.na,(e=t.A)&&n&&Un(r,e,n),Un(r,"VER",t.ha),Pr(t,r),r}function Kr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new dr(t.Na)).F=t.C,e}function $r(){}function Jr(){if(Rt&&!(10<=Number(Qt)))throw Error("Environmental error: no available transport.")}function Wr(t,e){Ee.call(this),this.a=new Nr(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!_t(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_t(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Yr(this)}function Qr(t){hn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Xr(){fn.call(this),this.status=1}function Yr(t){this.a=t}(it=dr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:an),this.a.onreadystatechange=vt(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void mr(this,o)}t=n||"";var i=new Sn(this.headers);r&&Nn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=gr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=ut.FormData&&t instanceof ut.FormData,!(0<=wt(yr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Er(this),0<this.o&&((this.D=function(t){return Rt&&Wt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=vt(this.xa,this)):this.m=Re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){mr(this,o)}},it.xa=function(){void 0!==st&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,_e(this,"timeout"),this.abort(8))},it.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,_e(this,"complete"),_e(this,"abort"),Or(this))},it.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Or(this,!0)),dr.X.G.call(this)},it.za=function(){this.j||(this.A||this.l||this.g?Ir(this):this.Ua())},it.Ua=function(){Ir(this)},it.W=function(){try{return 2<_r(this)?this.a.status:-1}catch(Lt){return-1}},it.$=function(){try{return this.a?this.a.responseText:""}catch(Lt){return""}},it.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),pr(e)}},it.ua=function(){return this.h},it.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(it=Nr.prototype).ha=8,it.v=1,it.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new pn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Pt(r=xt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Mr(this,n,e),Un(i=kn(this.B),"RID",t),Un(i,"CVER",22),this.A&&Un(i,"X-HTTP-Session-Id",this.A),Pr(this,i),this.i&&r&&Tr(i,this.i,r),sr(this.b,n),this.Ia&&Un(i,"TYPE","init"),this.da?(Un(i,"$req",e),Un(i,"SID","null"),n.U=!0,yn(n,i,null)):yn(n,i,e),this.v=2}}else 3==this.v&&(t?kr(this,t):0==this.g.length||rr(this.b)||kr(this))},it.Aa=function(){if(this.j=null,Rr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=nn(vt(this.Ta,this),t)}},it.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,tn(10),Ar(this),Rr(this))},it.Sa=function(){null!=this.m&&(this.m=null,Ar(this),Lr(this),tn(19))},it.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),tn(2)):(this.c.info("Failed to ping google.com"),tn(1))},(it=$r.prototype).ta=function(){},it.sa=function(){},it.ra=function(){},it.qa=function(){},it.Ja=function(){},Jr.prototype.a=function(t,e){return new Wr(t,e)},gt(Wr,Ee),Wr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;tn(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Hr(t,null,t.fa),xr(t)},Wr.prototype.close=function(){Sr(this.a)},Wr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Cr(this.a,e)}else this.l?((e={}).__data__=je(t),Cr(this.a,e)):Cr(this.a,t)},Wr.prototype.G=function(){this.a.f=null,delete this.f,Sr(this.a),delete this.a,Wr.X.G.call(this)},gt(Qr,hn),gt(Xr,fn),gt(Yr,$r),Yr.prototype.ta=function(){_e(this.a,"a")},Yr.prototype.sa=function(t){_e(this.a,new Qr(t))},Yr.prototype.ra=function(t){_e(this.a,new Xr(t))},Yr.prototype.qa=function(){_e(this.a,"b")},Jr.prototype.createWebChannel=Jr.prototype.a,Wr.prototype.send=Wr.prototype.h,Wr.prototype.open=Wr.prototype.g,Wr.prototype.close=Wr.prototype.close,rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,on.COMPLETE="complete",un.EventType=cn,cn.OPEN="a",cn.CLOSE="b",cn.ERROR="c",cn.MESSAGE="d",Ee.prototype.listen=Ee.prototype.va,dr.prototype.listenOnce=dr.prototype.wa,dr.prototype.getLastError=dr.prototype.Qa,dr.prototype.getLastErrorCode=dr.prototype.ua,dr.prototype.getStatus=dr.prototype.W,dr.prototype.getResponseJson=dr.prototype.Pa,dr.prototype.getResponseText=dr.prototype.$,dr.prototype.send=dr.prototype.ba;var Zr=rn,ti=on,ei=Je,ni=un,ri=dr,ii=n("30Go"),oi=new tt.b("@firebase/firestore");function si(){return oi.logLevel}function ui(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(oi.logLevel<=tt.a.DEBUG){var r=e.map(hi);oi.debug.apply(oi,Object(ii.g)(["Firestore (8.2.1): "+t],r))}}function ai(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(oi.logLevel<=tt.a.ERROR){var r=e.map(hi);oi.error.apply(oi,Object(ii.g)(["Firestore (8.2.1): "+t],r))}}function ci(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(oi.logLevel<=tt.a.WARN){var r=e.map(hi);oi.warn.apply(oi,Object(ii.g)(["Firestore (8.2.1): "+t],r))}}function hi(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(md){return t}}function fi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.1) INTERNAL ASSERTION FAILED: "+t;throw ai(e),new Error(e)}function li(t,e){t||fi()}function pi(t,e){return t}function di(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var vi=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=di(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function bi(t,e){return t<e?-1:t>e?1:0}function yi(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function gi(t){return t+"\0"}var mi=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return bi(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();mi.h=new mi("");var wi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ii=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(ii.c)(e,t),e}(Error),Oi=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(mi.fromBase64String(e))}catch(e){throw new Ii(wi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(mi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Ei=function(t){this._=t};function _i(){if("undefined"==typeof Uint8Array)throw new Ii(wi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ti(){if("undefined"==typeof atob)throw new Ii(wi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.fromBase64String=function(t){return Ti(),new e(Oi.fromBase64String(t))},e.fromUint8Array=function(t){return _i(),new e(Oi.fromUint8Array(t))},e.prototype.toBase64=function(){return Ti(),this._.toBase64()},e.prototype.toUint8Array=function(){return _i(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Ei),Ni=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Si=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Ai=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ai.UNAUTHENTICATED=new Ai(null),Ai.P=new Ai("google-credentials-uid"),Ai.g=new Ai("first-party-uid");var Di=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Ci=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Ai.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),xi=function(){function t(t){var e=this;this.C=null,this.currentUser=Ai.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.F,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.F!==e?(ui("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(li("string"==typeof n.accessToken),new Di(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.O=function(){var t=this.auth&&this.auth.getUid();return li(null===t||"string"==typeof t),new Ai(t)},t}(),ki=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Ai.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Pi=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new ki(this.k,this.M))},t.prototype.S=function(t){t(Ai.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),Mi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();Mi.U=-1;var Vi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ii(wi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ii(wi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ii(wi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ii(wi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?bi(this.nanoseconds,t.nanoseconds):bi(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Li=function(){function t(t){this.timestamp=t}return t.W=function(e){return new t(e)},t.min=function(){return new t(new Vi(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),Ui=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&fi(),void 0===n?n=t.length-e:n>t.length-e&&fi(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Ii(wi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(Ui),Fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return Fi.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ii(wi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Ii(wi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Ii(wi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Ii(wi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(Ui),Gi=function(){function t(t){this.path=t}return t.ft=function(e){return new t(Ri.ct(e))},t.dt=function(e){return new t(Ri.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Ri.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return Ri.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new Ri(e.slice()))},t}();function Bi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Hi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ki=function(){function t(t){this.fields=t,t.sort(qi.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),$i=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ji(t){if(li(!!t),"string"==typeof t){var e=0,n=$i.exec(t);if(li(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Wi(t.seconds),nanos:Wi(t.nanos)}}function Wi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Qi(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function Xi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Yi(t){var e=t.mapValue.fields.__previous_value__;return Xi(e)?Yi(e):e}function Zi(t){var e=Ji(t.mapValue.fields.__local_write_time__.timestampValue);return new Vi(e.seconds,e.nanos)}function to(t){return null==t}function eo(t){return 0===t&&1/t==-1/0}function no(t){return"number"==typeof t&&Number.isInteger(t)&&!eo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ro(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xi(t)?4:10:fi()}function io(t,e){var n=ro(t);if(n!==ro(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zi(t).isEqual(Zi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ji(t.timestampValue),r=Ji(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Qi(t.bytesValue).isEqual(Qi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Wi(t.geoPointValue.latitude)===Wi(e.geoPointValue.latitude)&&Wi(t.geoPointValue.longitude)===Wi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Wi(t.integerValue)===Wi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Wi(t.doubleValue),r=Wi(e.doubleValue);return n===r?eo(n)===eo(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return yi(t.arrayValue.values||[],e.arrayValue.values||[],io);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Bi(n)!==Bi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!io(n[i],r[i])))return!1;return!0}(t,e);default:return fi()}}function oo(t,e){return void 0!==(t.values||[]).find(function(t){return io(t,e)})}function so(t,e){var n=ro(t),r=ro(e);if(n!==r)return bi(n,r);switch(n){case 0:return 0;case 1:return bi(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Wi(t.integerValue||t.doubleValue),r=Wi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return uo(t.timestampValue,e.timestampValue);case 4:return uo(Zi(t),Zi(e));case 5:return bi(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Qi(t),r=Qi(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=bi(n[i],r[i]);if(0!==o)return o}return bi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=bi(Wi(t.latitude),Wi(e.latitude));return 0!==n?n:bi(Wi(t.longitude),Wi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=so(n[i],r[i]);if(o)return o}return bi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=bi(r[s],o[s]);if(0!==u)return u;var a=so(n[r[s]],i[o[s]]);if(0!==a)return a}return bi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw fi()}}function uo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return bi(t,e);var n=Ji(t),r=Ji(e),i=bi(n.seconds,r.seconds);return 0!==i?i:bi(n.nanos,r.nanos)}function ao(t){return co(t)}function co(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Ji(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Qi(t.bytesValue).toBase64():"referenceValue"in t?Gi.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=co(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+co(t.fields[o])}return e+"}"}(t.mapValue):fi();var e}function ho(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function fo(t){return!!t&&"integerValue"in t}function lo(t){return!!t&&"arrayValue"in t}function po(t){return!!t&&"nullValue"in t}function vo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bo(t){return!!t&&"mapValue"in t}var yo=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!bo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return io(this.proto,t.proto)},t}(),go=function(){function t(t){void 0===t&&(t=yo.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ro(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(qi.at(),this.Rt);return null!=t?new yo(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=bo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function mo(t){var e=[];return zi(t.fields||{},function(t,n){var r=new qi([t]);if(bo(n)){var i=mo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Ki(e)}var wo=function(t,e){this.key=t,this.version=e},Io=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(ii.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(wo),Oo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(ii.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(wo),Eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(wo),_o=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function To(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new _o(t,e,n,r,i,o,s)}function jo(t){var e=pi(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+ao(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),to(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Ro(e.startAt)),e.endAt&&(n+="|ub:",n+=Ro(e.endAt)),e.St=n}return e.St}function No(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!qo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!io(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bo(t.startAt,e.startAt)&&Bo(t.endAt,e.endAt)}function So(t){return Gi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ao=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(ii.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Do(t,n,r):"array-contains"===n?new Po(t,r):"in"===n?new Mo(t,r):"not-in"===n?new Vo(t,r):"array-contains-any"===n?new Lo(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Co(t,n):new xo(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(so(e,this.value)):null!==e&&ro(this.value)===ro(e)&&this.Ct(so(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return fi()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Do=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Gi.dt(r.referenceValue),i}return Object(ii.c)(e,t),e.prototype.matches=function(t){var e=Gi.J(t.key,this.key);return this.Ct(e)},e}(Ao),Co=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ko(0,n),r}return Object(ii.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ao),xo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ko(0,n),r}return Object(ii.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Ao);function ko(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Gi.dt(t.referenceValue)})}var Po=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(ii.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return lo(e)&&oo(e.arrayValue,this.value)},e}(Ao),Mo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(ii.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&oo(this.value.arrayValue,e)},e}(Ao),Vo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(ii.c)(e,t),e.prototype.matches=function(t){if(oo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!oo(this.value.arrayValue,e)},e}(Ao),Lo=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(ii.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!lo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return oo(e.value.arrayValue,t)})},e}(Ao),Uo=function(t,e){this.position=t,this.before=e};function Ro(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ao(t)}).join(",")}var Fo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function qo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Go(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?Gi.J(Gi.dt(s.referenceValue),n.key):so(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!io(t.position[n],e.position[n]))return!1;return!0}var zo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null};function Ho(t,e,n,r,i,o,s,u){return new zo(t,e,n,r,i,o,s,u)}function Ko(t){return new zo(t)}function $o(t){return!to(t.limit)&&"F"===t.limitType}function Jo(t){return!to(t.limit)&&"L"===t.limitType}function Wo(t){return t.Nt.length>0?t.Nt[0].field:null}function Qo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Xo(t){return null!==t.collectionGroup}function Yo(t){var e=pi(t);if(null===e.Ft){e.Ft=[];var n=Qo(e),r=Wo(e);if(null!==n&&null===r)n.ht()||e.Ft.push(new Fo(n)),e.Ft.push(new Fo(qi.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ft.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ft.push(new Fo(qi.lt(),a))}}}return e.Ft}function Zo(t){var e=pi(t);if(!e.Ot)if("F"===e.limitType)e.Ot=To(e.path,e.collectionGroup,Yo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Yo(e);r<i.length;r++){var o=i[r];n.push(new Fo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Uo(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Uo(e.startAt.position,!e.startAt.before):null;e.Ot=To(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ot}function ts(t,e,n){return new zo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function es(t,e){return No(Zo(t),Zo(e))&&t.limitType===e.limitType}function ns(t){return jo(Zo(t))+"|lt:"+t.limitType}function rs(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+ao(e.value);var e}).join(", ")+"]"),to(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Ro(t.startAt)),t.endAt&&(e+=", endAt: "+Ro(t.endAt)),"Target("+e+")"}(Zo(t))+"; limitType="+t.limitType+")"}function is(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):Gi.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Go(t.startAt,Yo(t),e)||t.endAt&&Go(t.endAt,Yo(t),e))}(t,e)}function os(t){return function(e,n){for(var r=!1,i=0,o=Yo(t);i<o.length;i++){var s=o[i],u=ss(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function ss(t,e,n){var r=t.field.ht()?Gi.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?so(r,i):fi()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return fi()}}var us=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Li.min()),void 0===o&&(o=Li.min()),void 0===s&&(s=mi.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function as(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eo(e)?"-0":e}}function cs(t){return{integerValue:""+t}}function hs(t,e){return no(e)?cs(e):as(t,e)}var fs=function(){this.Ut=void 0};function ls(t,e,n){return t instanceof vs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof bs?ys(t,e):t instanceof gs?ms(t,e):function(t,e){var n=ds(t,e),r=Is(n)+Is(t.Qt);return fo(n)&&fo(t.Qt)?cs(r):as(t.Kt,r)}(t,e)}function ps(t,e,n){return t instanceof bs?ys(t,e):t instanceof gs?ms(t,e):n}function ds(t,e){return t instanceof ws?fo(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var vs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e}(fs),bs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(ii.c)(e,t),e}(fs);function ys(t,e){for(var n=Os(e),r=function(t){n.some(function(e){return io(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var gs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(ii.c)(e,t),e}(fs);function ms(t,e){for(var n=Os(e),r=function(t){n=n.filter(function(e){return!io(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ws=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(ii.c)(e,t),e}(fs);function Is(t){return Wi(t.integerValue||t.doubleValue)}function Os(t){return lo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=function(t,e){this.field=t,this.transform=e},_s=function(t,e){this.version=t,this.transformResults=e},Ts=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Wt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function js(t,e){return void 0!==t.updateTime?e instanceof Io&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Io}var Ns=function(){};function Ss(t,e,n){return t instanceof ks?function(t,e,n){var r=t.value;if(n.transformResults){var i=Vs(t.fieldTransforms,e,n.transformResults);r=Us(t.fieldTransforms,r,i)}return new Io(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ps?function(t,e,n){if(!js(t.Gt,e))return new Eo(t.key,n.version);var r=Ms(t,e,n.transformResults?Vs(t.fieldTransforms,e,n.transformResults):[]);return new Io(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Oo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function As(t,e,n,r){return t instanceof ks?function(t,e,n,r){if(!js(t.Gt,e))return e;var i=t.value;if(t.fieldTransforms){var o=Ls(t.fieldTransforms,n,e,r);i=Us(t.fieldTransforms,i,o)}var s=xs(e);return new Io(t.key,s,i,{bt:!0})}(t,e,r,n):t instanceof Ps?function(t,e,n,r){if(!js(t.Gt,e))return e;var i=xs(e),o=Ms(t,e,Ls(t.fieldTransforms,n,e,r));return new Io(t.key,i,o,{bt:!0})}(t,e,r,n):function(t,e){return js(t.Gt,e)?new Oo(t.key,Li.min()):e}(t,e)}function Ds(t,e){return void 0!==t.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Io?e.field(o.field):void 0,u=ds(o.transform,s||null);null!=u&&(n=null==n?(new go).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e):null}function Cs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&yi(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof bs&&e instanceof bs||t instanceof gs&&e instanceof gs?yi(t.elements,e.elements,io):t instanceof ws&&e instanceof ws?io(t.Qt,e.Qt):t instanceof vs&&e instanceof vs}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function xs(t){return t instanceof Io?t.version:Li.min()}var ks=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(ii.c)(e,t),e}(Ns),Ps=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(ii.c)(e,t),e}(Ns);function Ms(t,e,n){var r;return r=function(t,e){var n=new go(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof Io?e.data():yo.empty()),Us(t.fieldTransforms,r,n)}function Vs(t,e,n){var r=[];li(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Io&&(u=e.field(o.field)),r.push(ps(s,u,n[i]))}return r}function Ls(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Io&&(c=n.field(u.field)),null===c&&r instanceof Io&&(c=r.field(u.field)),i.push(ls(a,c,e))}return i}function Us(t,e,n){for(var r=new go(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var Rs,Fs,qs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(ii.c)(e,t),e}(Ns),Gs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(ii.c)(e,t),e}(Ns),Bs=function(t){this.count=t};function zs(t){switch(t){case wi.OK:return fi();case wi.CANCELLED:case wi.UNKNOWN:case wi.DEADLINE_EXCEEDED:case wi.RESOURCE_EXHAUSTED:case wi.INTERNAL:case wi.UNAVAILABLE:case wi.UNAUTHENTICATED:return!1;case wi.INVALID_ARGUMENT:case wi.NOT_FOUND:case wi.ALREADY_EXISTS:case wi.PERMISSION_DENIED:case wi.FAILED_PRECONDITION:case wi.ABORTED:case wi.OUT_OF_RANGE:case wi.UNIMPLEMENTED:case wi.DATA_LOSS:return!0;default:return fi()}}function Hs(t){if(void 0===t)return ai("GRPC error has no .code"),wi.UNKNOWN;switch(t){case Rs.OK:return wi.OK;case Rs.CANCELLED:return wi.CANCELLED;case Rs.UNKNOWN:return wi.UNKNOWN;case Rs.DEADLINE_EXCEEDED:return wi.DEADLINE_EXCEEDED;case Rs.RESOURCE_EXHAUSTED:return wi.RESOURCE_EXHAUSTED;case Rs.INTERNAL:return wi.INTERNAL;case Rs.UNAVAILABLE:return wi.UNAVAILABLE;case Rs.UNAUTHENTICATED:return wi.UNAUTHENTICATED;case Rs.INVALID_ARGUMENT:return wi.INVALID_ARGUMENT;case Rs.NOT_FOUND:return wi.NOT_FOUND;case Rs.ALREADY_EXISTS:return wi.ALREADY_EXISTS;case Rs.PERMISSION_DENIED:return wi.PERMISSION_DENIED;case Rs.FAILED_PRECONDITION:return wi.FAILED_PRECONDITION;case Rs.ABORTED:return wi.ABORTED;case Rs.OUT_OF_RANGE:return wi.OUT_OF_RANGE;case Rs.UNIMPLEMENTED:return wi.UNIMPLEMENTED;case Rs.DATA_LOSS:return wi.DATA_LOSS;default:return fi()}}(Fs=Rs||(Rs={}))[Fs.OK=0]="OK",Fs[Fs.CANCELLED=1]="CANCELLED",Fs[Fs.UNKNOWN=2]="UNKNOWN",Fs[Fs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fs[Fs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fs[Fs.NOT_FOUND=5]="NOT_FOUND",Fs[Fs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fs[Fs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fs[Fs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fs[Fs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fs[Fs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fs[Fs.ABORTED=10]="ABORTED",Fs[Fs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fs[Fs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fs[Fs.INTERNAL=13]="INTERNAL",Fs[Fs.UNAVAILABLE=14]="UNAVAILABLE",Fs[Fs.DATA_LOSS=15]="DATA_LOSS";var Ks=function(){function t(t,e){this.J=t,this.root=e||Js.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,Js.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,Js.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new $s(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new $s(this.root,t,this.J,!1)},t.prototype.se=function(){return new $s(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new $s(this.root,t,this.J,!0)},t}(),$s=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),Js=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw fi();if(this.right._e())throw fi();var t=this.left.me();if(t!==this.right.me())throw fi();return t+(this._e()?0:1)},t}();Js.EMPTY=null,Js.RED=!0,Js.Jt=!1,Js.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw fi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw fi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw fi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw fi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw fi()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new Js(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var Ws=function(){function t(t){this.J=t,this.data=new Ks(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new Qs(this.data.ee())},t.prototype.ne=function(t){return new Qs(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),Qs=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),Xs=new Ks(Gi.J);function Ys(){return Xs}function Zs(){return Ys()}var tu=new Ks(Gi.J);function eu(){return tu}var nu=new Ks(Gi.J);function ru(){return nu}var iu=new Ws(Gi.J);function ou(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=iu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var su=new Ws(bi);function uu(){return su}var au=function(){function t(t){this.J=t?function(e,n){return t(e,n)||Gi.J(e.key,n.key)}:function(t,e){return Gi.J(t.key,e.key)},this.Ve=eu(),this.pe=new Ks(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),cu=function(){function t(){this.ve=new Ks(Gi.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):fi():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),hu=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Fe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,au.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&es(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),fu=function(){function t(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,lu.Be(e,n)),new t(Li.min(),r,uu(),Ys(),ou())},t}(),lu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(mi.h,n,ou(),ou(),ou())},t}(),pu=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},du=function(t,e){this.targetId=t,this.Ge=e},vu=function(t,e,n,r){void 0===n&&(n=mi.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bu=function(){function t(){this.ze=0,this.He=mu(),this.Je=mi.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=ou(),e=ou(),n=ou();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:fi()}}),new lu(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=mu()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),yu=function(){function t(t){this.hn=t,this.ln=new Map,this._n=Ys(),this.fn=gu(),this.dn=new Ws(bi)}return t.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof Io?this.En(r,t.je):t.je instanceof Oo&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.je)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:fi()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(So(i))if(0===n){var o=new Gi(i.path);this.Tn(e,o,new Oo(o,Li.min()))}else li(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&So(o.target)){var s=new Gi(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Oo(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=ou();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new fu(t,n,this.dn,this._n,r);return this._n=Ys(),this.fn=gu(),this.dn=new Ws(bi),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new bu,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Ws(bi),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||ui("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new bu),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function gu(){return new Ks(Gi.J)}function mu(){return new Ks(Gi.J)}var wu={asc:"ASCENDING",desc:"DESCENDING"},Iu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ou=function(t,e){this.T=t,this.qt=e};function Eu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function _u(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Tu(t,e){return Eu(t,e.G())}function ju(t){return li(!!t),Li.W(function(t){var e=Ji(t);return new Vi(e.seconds,e.nanos)}(t))}function Nu(t,e){return function(t){return new Ri(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Su(t){var e=Ri.ct(t);return li(Yu(e)),e}function Au(t,e){return Nu(t.T,e.path)}function Du(t,e){var n=Su(e);if(n.get(1)!==t.T.projectId)throw new Ii(wi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new Ii(wi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new Gi(Pu(n))}function Cu(t,e){return Nu(t.T,e)}function xu(t){var e=Su(t);return 4===e.length?Ri.at():Pu(e)}function ku(t){return new Ri(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Pu(t){return li(t.length>4&&"documents"===t.get(4)),t.X(5)}function Mu(t,e,n){return{name:Au(t,e),fields:n.proto.mapValue.fields}}function Vu(t,e,n){var r=Du(t,e.name),i=ju(e.updateTime),o=new yo({mapValue:{fields:e.fields}});return new Io(r,i,o,{hasCommittedMutations:!!n})}function Lu(t,e){var n;if(e instanceof ks)n={update:Mu(t,e.key,e.value)};else if(e instanceof qs)n={delete:Au(t,e.key)};else if(e instanceof Ps)n={update:Mu(t,e.key,e.data),updateMask:Xu(e.zt)};else{if(!(e instanceof Gs))return fi();n={verify:Au(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof vs)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof bs)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof gs)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof ws)return{fieldPath:e.field.ot(),increment:n.Qt};throw fi()}(0,t)})),e.Gt.jt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Tu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:fi()}(t,e.Gt)),n}function Uu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ts.updateTime(ju(t.updateTime)):void 0!==t.exists?Ts.exists(t.exists):Ts.Wt()}(e.currentDocument):Ts.Wt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(li("REQUEST_TIME"===e.setToServerValue),n=new vs):"appendMissingElements"in e?n=new bs(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new gs(e.removeAllFromArray.values||[]):"increment"in e?n=new ws(t,e.increment):fi();var r=qi._t(e.fieldPath);return new Es(r,n)}(t,e)}):[];if(e.update){var i=Du(t,e.update.name),o=new yo({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new Ki((t.fieldPaths||[]).map(function(t){return qi._t(t)}))}(e.updateMask);return new Ps(i,o,s,n,r)}return new ks(i,o,n,r)}if(e.delete){var u=Du(t,e.delete);return new qs(u,n)}if(e.verify){var a=Du(t,e.verify);return new Gs(a,n)}return fi()}function Ru(t,e){return{documents:[Cu(t,e.path)]}}function Fu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Cu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Cu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(vo(t.value))return{unaryFilter:{field:$u(t.field),op:"IS_NAN"}};if(po(t.value))return{unaryFilter:{field:$u(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(vo(t.value))return{unaryFilter:{field:$u(t.field),op:"IS_NOT_NAN"}};if(po(t.value))return{unaryFilter:{field:$u(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$u(t.field),op:Ku(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:$u(t.field),direction:Hu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||to(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Bu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Bu(e.endAt)),n}function qu(t){var e=xu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){li(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Gu(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Fo(Ju(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return to(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=zu(n.startAt));var h=null;return n.endAt&&(h=zu(n.endAt)),Ho(e,i,u,s,a,"F",c,h)}function Gu(t){return t?void 0!==t.unaryFilter?[Qu(t)]:void 0!==t.fieldFilter?[Wu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Gu(t)}).reduce(function(t,e){return t.concat(e)}):fi():[]}function Bu(t){return{before:t.before,values:t.position}}function zu(t){return new Uo(t.values||[],!!t.before)}function Hu(t){return wu[t]}function Ku(t){return Iu[t]}function $u(t){return{fieldPath:t.ot()}}function Ju(t){return qi._t(t.fieldPath)}function Wu(t){return Ao.create(Ju(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return fi()}}(t.fieldFilter.op),t.fieldFilter.value)}function Qu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ju(t.unaryFilter.field);return Ao.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ju(t.unaryFilter.field);return Ao.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ju(t.unaryFilter.field);return Ao.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ju(t.unaryFilter.field);return Ao.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return fi()}}function Xu(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function Yu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Zu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ta=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Fn&&fi(),this.Fn=!0,this.Nn?this.error?this.On(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.On(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.On=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),ea=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new Zu,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new ia(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=ca(e.target.error);n.qn.reject(new ia(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ia(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(ui("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new sa(e)},t}(),na=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(et.g)())&&ai("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return ui("SimpleDb","Removing database:",t),ua(window.indexedDB.deleteDatabase(t)).Mn()},t.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(t.jn())return!0;var e=Object(et.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n=this;return Object(ii.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(ui("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new ia(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Ii(wi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new ia(t,n))},i.onupgradeneeded=function(t){ui("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){ui("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(ii.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(ii.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=ea.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),ta.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return ui("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ra=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return ua(this.ts.delete())},t}(),ia=function(t){function e(e,n){var r=this;return(r=t.call(this,wi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(ii.c)(e,t),e}(Ii);function oa(t){return"IndexedDbTransactionError"===t.name}var sa=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ui("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ui("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ua(n)},t.prototype.add=function(t){return ui("SimpleDb","ADD",this.store.name,t,t),ua(this.store.add(t))},t.prototype.get=function(t){var e=this;return ua(this.store.get(t)).next(function(n){return void 0===n&&(n=null),ui("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return ui("SimpleDb","DELETE",this.store.name,t),ua(this.store.delete(t))},t.prototype.count=function(){return ui("SimpleDb","COUNT",this.store.name),ua(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){ui("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new ta(function(n,r){e.onerror=function(t){var e=ca(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new ta(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ra(i),s=e(i.primaryKey,i.value,o);if(s instanceof ta){var u=s.catch(function(t){return o.done(),ta.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return ta.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ua(t){return new ta(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ca(t.target.error);n(e)}})}var aa=!1;function ca(t){var e=na.Kn(Object(et.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ii("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return aa||(aa=!0,setTimeout(function(){throw r},0)),r}}return t}var ha=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new Zu,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Ii(wi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function fa(t,e){if(ai("AsyncQueue",e+": "+t),oa(t))return new Ii(wi.UNAVAILABLE,e+": "+t);throw t}var la=function(t,e){this.progress=t,this.gs=e},pa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",da=function(){function t(){this.Vs=[]}return t.prototype.ps=function(t){this.Vs.push(t)},t.prototype.bs=function(){this.Vs.forEach(function(t){return t()})},t}();function va(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ya(e)),e=ba(t.get(n),e);return ya(e)}function ba(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function ya(t){return t+"\x01\x01"}function ga(t){var e=t.length;if(li(e>=2),2===e)return li("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Ri.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&fi(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:fi()}o=s+2}return new Ri(r)}var ma=function(t,e){this.seconds=t,this.nanoseconds=e},wa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};wa.store="owner",wa.key="owner";var Ia=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ia.store="mutationQueues",Ia.keyPath="userId";var Oa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Oa.store="mutations",Oa.keyPath="batchId",Oa.userMutationsIndex="userMutationsIndex",Oa.userMutationsKeyPath=["userId","batchId"];var Ea=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,va(e)]},t.key=function(t,e,n){return[t,va(e),n]},t}();Ea.store="documentMutations",Ea.PLACEHOLDER=new Ea;var _a=function(t,e){this.path=t,this.readTime=e},Ta=function(t,e){this.path=t,this.version=e},ja=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ja.store="remoteDocuments",ja.readTimeIndex="readTimeIndex",ja.readTimeIndexPath="readTime",ja.collectionReadTimeIndex="collectionReadTimeIndex",ja.collectionReadTimeIndexPath=["parentPath","readTime"];var Na=function(t){this.byteSize=t};Na.store="remoteDocumentGlobal",Na.key="remoteDocumentGlobalKey";var Sa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sa.store="targets",Sa.keyPath="targetId",Sa.queryTargetsIndexName="queryTargetsIndex",Sa.queryTargetsKeyPath=["canonicalId","targetId"];var Aa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Aa.store="targetDocuments",Aa.keyPath=["targetId","path"],Aa.documentTargetsIndex="documentTargetsIndex",Aa.documentTargetsKeyPath=["path","targetId"];var Da=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Da.key="targetGlobalKey",Da.store="targetGlobal";var Ca=function(t,e){this.collectionId=t,this.parent=e};Ca.store="collectionParents",Ca.keyPath=["collectionId","parent"];var xa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};xa.store="clientMetadata",xa.keyPath="clientId";var ka=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ka.store="bundles",ka.keyPath="bundleId";var Pa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Pa.store="namedQueries",Pa.keyPath="name";var Ma=Object(ii.g)(Object(ii.g)(Object(ii.g)(Object(ii.g)([Ia.store,Oa.store,Ea.store,ja.store,Sa.store,wa.store,Da.store,Aa.store],[xa.store]),[Na.store]),[Ca.store]),[ka.store,Pa.store]),Va=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).vs=e,r.Ss=n,r}return Object(ii.c)(e,t),e}(da);function La(t,e){var n=pi(t);return na.Hn(n.vs,e)}var Ua=function(){function t(t,e,n,r){this.batchId=t,this.Ds=e,this.baseMutations=n,this.mutations=r}return t.prototype.Cs=function(t,e,n){for(var r=n.xs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ss(o,e,r[i]))}return e},t.prototype.Ns=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=As(i,e,e,this.Ds))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=As(a,e,o,this.Ds))}return e},t.prototype.Fs=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Ns(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ou())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,function(t,e){return Cs(t,e)})&&yi(this.baseMutations,t.baseMutations,function(t,e){return Cs(t,e)})},t}(),Ra=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.xs=n,this.ks=r}return t.from=function(e,n,r){li(e.mutations.length===r.length);for(var i=ru(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Fa=function(t){this.Ms=t};function qa(t,e){if(e.document)return Vu(t.Ms,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Gi.Tt(e.noDocument.path),r=Ka(e.noDocument.readTime);return new Oo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Gi.Tt(e.unknownDocument.path);return r=Ka(e.unknownDocument.version),new Eo(i,r)}return fi()}function Ga(t,e,n){var r=Ba(n),i=e.key.path.Z().rt();if(e instanceof Io){var o=function(t,e){return{name:Au(t,e.key),fields:e.vt().mapValue.fields,updateTime:Eu(t,e.version.G())}}(t.Ms,e),s=e.hasCommittedMutations;return new ja(null,null,o,s,r,i)}if(e instanceof Oo){var u=e.key.path.rt(),a=Ha(e.version);return s=e.hasCommittedMutations,new ja(null,new _a(u,a),null,s,r,i)}if(e instanceof Eo){var c=e.key.path.rt(),h=Ha(e.version);return new ja(new Ta(c,h),null,null,!0,r,i)}return fi()}function Ba(t){var e=t.G();return[e.seconds,e.nanoseconds]}function za(t){var e=new Vi(t[0],t[1]);return Li.W(e)}function Ha(t){var e=t.G();return new ma(e.seconds,e.nanoseconds)}function Ka(t){var e=new Vi(t.seconds,t.nanoseconds);return Li.W(e)}function $a(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Uu(t.Ms,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return Uu(t.Ms,e)}),s=Vi.fromMillis(e.localWriteTimeMs);return new Ua(e.batchId,s,n,o)}function Ja(t){var e,n,r=Ka(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ka(t.lastLimboFreeSnapshotVersion):Li.min();return void 0!==t.query.documents?(li(1===(n=t.query).documents.length),e=Zo(Ko(xu(n.documents[0])))):e=function(t){return Zo(qu(t))}(t.query),new us(e,t.targetId,0,t.lastListenSequenceNumber,r,i,mi.fromBase64String(t.resumeToken))}function Wa(t,e){var n,r=Ha(e.Mt),i=Ha(e.lastLimboFreeSnapshotVersion);n=So(e.target)?Ru(t.Ms,e.target):Fu(t.Ms,e.target);var o=e.resumeToken.toBase64();return new Sa(e.targetId,jo(e.target),r,o,e.sequenceNumber,i,n)}function Qa(t){var e=qu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ts(e,e.limit,"L"):e}var Xa=function(){function t(){}return t.prototype.Ls=function(t,e){return Ya(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Ka(e.createTime),version:e.version};var e})},t.prototype.$s=function(t,e){return Ya(t).put({bundleId:(n=e).id,createTime:Ha(ju(n.createTime)),version:n.version});var n},t.prototype.Bs=function(t,e){return Za(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Qa(e.bundledQuery),readTime:Ka(e.readTime)};var e})},t.prototype.qs=function(t,e){return Za(t).put(function(t){return{name:t.name,readTime:Ha(ju(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ya(t){return La(t,ka.store)}function Za(t){return La(t,Pa.store)}var tc=function(){function t(){this.Us=new ec}return t.prototype.Qs=function(t,e){return this.Us.add(e),ta.resolve()},t.prototype.Ks=function(t,e){return ta.resolve(this.Us.getEntries(e))},t}(),ec=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Ws(Ri.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ws(Ri.J)).rt()},t}(),nc=function(){function t(){this.Ws=new ec}return t.prototype.Qs=function(t,e){var n=this;if(!this.Ws.has(e)){var r=e.et(),i=e.Z();t.ps(function(){n.Ws.add(e)});var o={collectionId:r,parent:va(i)};return rc(t).put(o)}return ta.resolve()},t.prototype.Ks=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[gi(e),""],!1,!0);return rc(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ga(o.parent))}return n})},t}();function rc(t){return La(t,Ca.store)}var ic={js:!1,Gs:0,zs:0,Hs:0},oc=function(){function t(t,e,n){this.Js=t,this.Ys=e,this.Xs=n}return t.Zs=function(e){return new t(e,t.ti,t.ei)},t}();function sc(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){if(t.code!==wi.FAILED_PRECONDITION||t.message!==pa)throw t;return ui("LocalStore","Unexpectedly lost primary lease"),[2]})})}oc.ti=10,oc.ei=1e3,oc.ni=new oc(41943040,oc.ti,oc.ei),oc.si=new oc(-1,0,0);var uc=function(){function t(t,e){this.ii=t,this.ri=e,this.oi={}}return t.prototype.get=function(t){var e=this.ii(t),n=this.oi[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ri(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ii(t),r=this.oi[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ri(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.oi[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ii(t),n=this.oi[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ri(n[r][0],t))return 1===n.length?delete this.oi[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){zi(this.oi,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return Hi(this.oi)},t}(),ac=function(){function t(){this.ci=new uc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ai=!1}return t.prototype.ui=function(t){var e=this.ci.get(t);return e?e.readTime:Li.min()},t.prototype.hi=function(t,e){this.li(),this.ci.set(t.key,{_i:t,readTime:e})},t.prototype.fi=function(t,e){void 0===e&&(e=null),this.li(),this.ci.set(t,{_i:null,readTime:e})},t.prototype.di=function(t,e){this.li();var n=this.ci.get(e);return void 0!==n?ta.resolve(n._i):this.wi(t,e)},t.prototype.getEntries=function(t,e){return this.Ei(t,e)},t.prototype.apply=function(t){return this.li(),this.ai=!0,this.Ti(t)},t.prototype.li=function(){},t}();function cc(t,e,n){var r=t.store(Oa.store),i=t.store(Ea.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){li(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Ea.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ta.$n(o).next(function(){return c})}function hc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw fi();e=t.noDocument}return JSON.stringify(e).length}var fc=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ii=n,this.mi=r,this.Ai={}}return t.Ri=function(e,n,r,i){return li(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Pi=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pc(t).ls({index:Oa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.yi=function(t,e,n,r){var i=this,o=dc(t),s=pc(t);return s.add({}).next(function(u){li("number"==typeof u);for(var a=new Ua(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Lu(t.Ms,e)}),i=n.mutations.map(function(e){return Lu(t.Ms,e)});return new Oa(e,n.batchId,n.Ds.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new Ws(function(t,e){return bi(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Ea.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,Ea.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ii.Qs(t,e))}),t.ps(function(){i.Ai[u]=a.keys()}),ta.$n(h).next(function(){return a})})},t.prototype.gi=function(t,e){var n=this;return pc(t).get(e).next(function(t){return t?(li(t.userId===n.userId),$a(n.Kt,t)):null})},t.prototype.Vi=function(t,e){var n=this;return this.Ai[e]?ta.resolve(this.Ai[e]):this.gi(t,e).next(function(t){if(t){var r=t.keys();return n.Ai[e]=r,r}return null})},t.prototype.pi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return pc(t).ls({index:Oa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(li(e.batchId>=r),o=$a(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.bi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return pc(t).ls({index:Oa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.vi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return pc(t).os(Oa.userMutationsIndex,n).next(function(t){return t.map(function(t){return $a(e.Kt,t)})})},t.prototype.Si=function(t,e){var n=this,r=Ea.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return dc(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=ga(r[1]);if(u===n.userId&&e.path.isEqual(c))return pc(t).get(a).next(function(t){if(!t)throw fi();li(t.userId===n.userId),o.push($a(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Di=function(t,e){var n=this,r=new Ws(bi),i=[];return e.forEach(function(e){var o=Ea.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=dc(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=ga(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),ta.$n(i).next(function(){return n.Ci(t,r)})},t.prototype.xi=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ea.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Ws(bi);return dc(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=ga(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Ci(t,u)})},t.prototype.Ci=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(pc(t).get(e).next(function(t){if(null===t)throw fi();li(t.userId===n.userId),r.push($a(n.Kt,t))}))}),ta.$n(i).next(function(){return r})},t.prototype.Ni=function(t,e){var n=this;return cc(t.vs,this.userId,e).next(function(r){return t.ps(function(){n.Fi(e.batchId)}),ta.forEach(r,function(e){return n.mi.Oi(t,e)})})},t.prototype.Fi=function(t){delete this.Ai[t]},t.prototype.ki=function(t){var e=this;return this.Pi(t).next(function(n){if(!n)return ta.resolve();var r=IDBKeyRange.lowerBound(Ea.prefixForUser(e.userId)),i=[];return dc(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=ga(t[1]);i.push(o)}else r.done()}).next(function(){li(0===i.length)})})},t.prototype.Mi=function(t,e){return lc(t,this.userId,e)},t.prototype.Li=function(t){var e=this;return vc(t).get(this.userId).next(function(t){return t||new Ia(e.userId,-1,"")})},t}();function lc(t,e,n){var r=Ea.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return dc(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function pc(t){return La(t,Oa.store)}function dc(t){return La(t,Ea.store)}function vc(t){return La(t,Ia.store)}var bc=function(){function t(t){this.$i=t}return t.prototype.next=function(){return this.$i+=2,this.$i},t.Bi=function(){return new t(0)},t.qi=function(){return new t(-1)},t}(),yc=function(){function t(t,e){this.mi=t,this.Kt=e}return t.prototype.Ui=function(t){var e=this;return this.Qi(t).next(function(n){var r=new bc(n.highestTargetId);return n.highestTargetId=r.next(),e.Ki(t,n).next(function(){return n.highestTargetId})})},t.prototype.Wi=function(t){return this.Qi(t).next(function(t){return Li.W(new Vi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Qi(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Gi=function(t,e,n){var r=this;return this.Qi(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ki(t,i)})},t.prototype.zi=function(t,e){var n=this;return this.Hi(t,e).next(function(){return n.Qi(t).next(function(r){return r.targetCount+=1,n.Ji(e,r),n.Ki(t,r)})})},t.prototype.Yi=function(t,e){return this.Hi(t,e)},t.prototype.Xi=function(t,e){var n=this;return this.Zi(t,e.targetId).next(function(){return gc(t).delete(e.targetId)}).next(function(){return n.Qi(t)}).next(function(e){return li(e.targetCount>0),e.targetCount-=1,n.Ki(t,e)})},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return gc(t).ls(function(s,u){var a=Ja(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Xi(t,a)))}).next(function(){return ta.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return gc(t).ls(function(t,n){var r=Ja(n);e(r)})},t.prototype.Qi=function(t){return mc(t).get(Da.key).next(function(t){return li(null!==t),t})},t.prototype.Ki=function(t,e){return mc(t).put(Da.key,e)},t.prototype.Hi=function(t,e){return gc(t).put(Wa(this.Kt,e))},t.prototype.Ji=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.er=function(t){return this.Qi(t).next(function(t){return t.targetCount})},t.prototype.nr=function(t,e){var n=jo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return gc(t).ls({range:r,index:Sa.queryTargetsIndexName},function(t,n,r){var o=Ja(n);No(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.sr=function(t,e,n){var r=this,i=[],o=wc(t);return e.forEach(function(e){var s=va(e.path);i.push(o.put(new Aa(n,s))),i.push(r.mi.ir(t,n,e))}),ta.$n(i)},t.prototype.rr=function(t,e,n){var r=this,i=wc(t);return ta.forEach(e,function(e){var o=va(e.path);return ta.$n([i.delete([n,o]),r.mi.cr(t,n,e)])})},t.prototype.Zi=function(t,e){var n=wc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ar=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=wc(t),i=ou();return r.ls({range:n,hs:!0},function(t,e,n){var r=ga(t[1]),o=new Gi(r);i=i.add(o)}).next(function(){return i})},t.prototype.Mi=function(t,e){var n=va(e.path),r=IDBKeyRange.bound([n],[gi(n)],!1,!0),i=0;return wc(t).ls({index:Aa.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return gc(t).get(e).next(function(t){return t?Ja(t):null})},t}();function gc(t){return La(t,Sa.store)}function mc(t){return La(t,Da.store)}function wc(t){return La(t,Aa.store)}function Ic(t,e){var n=t[1],r=e[1],i=bi(t[0],e[0]);return 0===i?bi(n,r):i}var Oc=function(){function t(t){this.ur=t,this.buffer=new Ws(Ic),this.hr=0}return t.prototype.lr=function(){return++this.hr},t.prototype._r=function(t){var e=[t,this.lr()];if(this.buffer.size<this.ur)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ic(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ec=function(){function t(t,e){this.dr=t,this.fs=e,this.wr=!1,this.Er=null}return t.prototype.start=function(t){-1!==this.dr.params.Js&&this.Tr(t)},t.prototype.stop=function(){this.Er&&(this.Er.cancel(),this.Er=null)},Object.defineProperty(t.prototype,"Ir",{get:function(){return null!==this.Er},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t){var e=this,n=this.wr?3e5:6e4;ui("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Er=this.fs.mr("lru_garbage_collection",n,function(){return Object(ii.b)(e,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:this.Er=null,this.wr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ar(this.dr)];case 2:return n.sent(),[3,7];case 3:return oa(e=n.sent())?(ui("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,sc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Tr(t)];case 8:return n.sent(),[2]}})})})},t}(),_c=function(){function t(t,e){this.Rr=t,this.params=e}return t.prototype.Pr=function(t,e){return this.Rr.yr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.gr=function(t,e){var n=this;if(0===e)return ta.resolve(Mi.U);var r=new Oc(e);return this.Rr.mn(t,function(t){return r._r(t.sequenceNumber)}).next(function(){return n.Rr.Vr(t,function(t){return r._r(t)})}).next(function(){return r.maxValue})},t.prototype.tr=function(t,e,n){return this.Rr.tr(t,e,n)},t.prototype.pr=function(t,e){return this.Rr.pr(t,e)},t.prototype.br=function(t,e){var n=this;return-1===this.params.Js?(ui("LruGarbageCollector","Garbage collection skipped; disabled"),ta.resolve(ic)):this.vr(t).next(function(r){return r<n.params.Js?(ui("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Js),ic):n.Sr(t,e)})},t.prototype.vr=function(t){return this.Rr.vr(t)},t.prototype.Sr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Pr(t,this.params.Ys).next(function(e){return e>c.params.Xs?(ui("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Xs+" from "+e),r=c.params.Xs):r=e,o=Date.now(),c.gr(t,r)}).next(function(r){return n=r,s=Date.now(),c.tr(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.pr(t,n)}).next(function(t){return a=Date.now(),si()<=tt.a.DEBUG&&ui("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),ta.resolve({js:!0,Gs:r,zs:i,Hs:t})})},t}(),Tc=function(){function t(t,e){this.db=t,this.dr=function(t,e){return new _c(t,e)}(this,e)}return t.prototype.yr=function(t){var e=this.Dr(t);return this.db.Cr().er(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Dr=function(t){var e=0;return this.Vr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Cr().mn(t,e)},t.prototype.Vr=function(t,e){return this.Nr(t,function(t,n){return e(n)})},t.prototype.ir=function(t,e,n){return jc(t,n)},t.prototype.cr=function(t,e,n){return jc(t,n)},t.prototype.tr=function(t,e,n){return this.db.Cr().tr(t,e,n)},t.prototype.Oi=function(t,e){return jc(t,e)},t.prototype.Fr=function(t,e){return function(t,e){var n=!1;return vc(t)._s(function(r){return lc(t,r,e).next(function(t){return t&&(n=!0),ta.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.pr=function(t,e){var n=this,r=this.db.kr().Or(),i=[],o=0;return this.Nr(t,function(s,u){if(u<=e){var a=n.Fr(t,s).next(function(e){if(!e)return o++,r.di(t,s).next(function(){return r.fi(s),wc(t).delete([0,va(s.path)])})});i.push(a)}}).next(function(){return ta.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.Ss);return this.db.Cr().Yi(t,n)},t.prototype.Mr=function(t,e){return jc(t,e)},t.prototype.Nr=function(t,e){var n,r=wc(t),i=Mi.U;return r.ls({index:Aa.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Mi.U&&e(new Gi(ga(n)),i),i=s,n=o):i=Mi.U}).next(function(){i!==Mi.U&&e(new Gi(ga(n)),i)})},t.prototype.vr=function(t){return this.db.kr().Lr(t)},t}();function jc(t,e){return wc(t).put(function(t,e){return new Aa(0,va(t.path),e)}(e,t.Ss))}var Nc=function(){function t(t,e){this.Kt=t,this.Ii=e}return t.prototype.hi=function(t,e,n){return Dc(t).put(Cc(e),n)},t.prototype.fi=function(t,e){var n=Dc(t),r=Cc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.$r(t,r)})},t.prototype.di=function(t,e){var n=this;return Dc(t).get(Cc(e)).next(function(t){return n.Br(t)})},t.prototype.qr=function(t,e){var n=this;return Dc(t).get(Cc(e)).next(function(t){var e=n.Br(t);return e?{_i:e,size:hc(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Zs();return this.Ur(t,e,function(t,e){var i=n.Br(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Qr=function(t,e){var n=this,r=Zs(),i=new Ks(Gi.J);return this.Ur(t,e,function(t,e){var o=n.Br(e);o?(r=r.Ht(t,o),i=i.Ht(t,hc(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Kr:r,Wr:i}})},t.prototype.Ur=function(t,e,n){if(e.nt())return ta.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Dc(t).ls({range:r},function(t,e,r){for(var s=Gi.Tt(t);o&&Gi.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=eu(),o=e.path.length+1,s={};if(n.isEqual(Li.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=Ba(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=ja.collectionReadTimeIndex}return Dc(t).ls(s,function(t,n,s){if(t.length===o){var u=qa(r.Kt,n);e.path.st(u.key.path)?u instanceof Io&&is(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Sc(this,!!t&&t.Gr)},t.prototype.Lr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ac(t).get(Na.key).next(function(t){return li(!!t),t})},t.prototype.$r=function(t,e){return Ac(t).put(Na.key,e)},t.prototype.Br=function(t){if(t){var e=qa(this.Kt,t);return e instanceof Oo&&e.version.isEqual(Li.min())?null:e}return null},t}(),Sc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).zr=e,r.Gr=n,r.Hr=new uc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(ii.c)(e,t),e.prototype.Ti=function(t){var e=this,n=[],r=0,i=new Ws(function(t,e){return bi(t.ot(),e.ot())});return this.ci.forEach(function(o,s){var u=e.Hr.get(o);if(s._i){var a=Ga(e.zr.Kt,s._i,e.ui(o));i=i.add(o.path.Z());var c=hc(a);r+=c-u,n.push(e.zr.hi(t,o,a))}else if(r-=u,e.Gr){var h=Ga(e.zr.Kt,new Oo(o,Li.min()),e.ui(o));n.push(e.zr.hi(t,o,h))}else n.push(e.zr.fi(t,o))}),i.forEach(function(r){n.push(e.zr.Ii.Qs(t,r))}),n.push(this.zr.updateMetadata(t,r)),ta.$n(n)},e.prototype.wi=function(t,e){var n=this;return this.zr.qr(t,e).next(function(t){return null===t?(n.Hr.set(e,0),null):(n.Hr.set(e,t.size),t._i)})},e.prototype.Ei=function(t,e){var n=this;return this.zr.Qr(t,e).next(function(t){var e=t.Kr;return t.Wr.forEach(function(t,e){n.Hr.set(t,e)}),e})},e}(ac);function Ac(t){return La(t,Na.store)}function Dc(t){return La(t,ja.store)}function Cc(t){return t.path.rt()}var xc=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;li(n<r&&n>=0&&r<=11);var o=new ea("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(wa.store)}(t),function(t){t.createObjectStore(Ia.store,{keyPath:Ia.keyPath}),t.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ea.store)}(t),kc(t),function(t){t.createObjectStore(ja.store)}(t));var s=ta.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Aa.store),t.deleteObjectStore(Sa.store),t.deleteObjectStore(Da.store)}(t),kc(t)),s=s.next(function(){return function(t){var e=t.store(Da.store),n=new Da(0,0,Li.min().G(),0);return e.put(Da.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Oa.store).os().next(function(n){t.deleteObjectStore(Oa.store),t.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0});var r=e.store(Oa.store),i=n.map(function(t){return r.put(t)});return ta.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Jr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Na.store)}(t),i.Yr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Xr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Zr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ja.store);e.createIndex(ja.readTimeIndex,ja.readTimeIndexPath,{unique:!1}),e.createIndex(ja.collectionReadTimeIndex,ja.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.eo(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(ka.store,{keyPath:ka.keyPath})}(t),function(t){t.createObjectStore(Pa.store,{keyPath:Pa.keyPath})}(t)})),s},t.prototype.Yr=function(t){var e=0;return t.store(ja.store).ls(function(t,n){e+=hc(n)}).next(function(){var n=new Na(e);return t.store(Na.store).put(Na.key,n)})},t.prototype.Jr=function(t){var e=this,n=t.store(Ia.store),r=t.store(Oa.store);return n.os().next(function(n){return ta.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Oa.userMutationsIndex,i).next(function(r){return ta.forEach(r,function(r){li(r.userId===n.userId);var i=$a(e.Kt,r);return cc(t,n.userId,i).next(function(){})})})})})},t.prototype.Xr=function(t){var e=t.store(Aa.store),n=t.store(ja.store);return t.store(Da.store).get(Da.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new Ri(n),s=function(t){return[0,va(t)]}(o);r.push(e.get(s).next(function(n){return n?ta.resolve():function(n){return e.put(new Aa(0,va(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return ta.$n(r)})})},t.prototype.Zr=function(t,e){t.createObjectStore(Ca.store,{keyPath:Ca.keyPath});var n=e.store(Ca.store),r=new ec,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:va(i)})}};return e.store(ja.store).ls({hs:!0},function(t,e){var n=new Ri(t);return i(n.Z())}).next(function(){return e.store(Ea.store).ls({hs:!0},function(t,e){var n=ga(t[1]);return i(n.Z())})})},t.prototype.eo=function(t){var e=this,n=t.store(Sa.store);return n.ls(function(t,r){var i=Ja(r),o=Wa(e.Kt,i);return n.put(o)})},t}();function kc(t){t.createObjectStore(Aa.store,{keyPath:Aa.keyPath}).createIndex(Aa.documentTargetsIndex,Aa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.queryTargetsIndexName,Sa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Da.store)}var Pc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Mc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.no=o,this.window=s,this.document=u,this.so=c,this.io=h,this.ro=null,this.oo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.co=null,this.inForeground=!1,this.ao=null,this.uo=null,this.ho=Number.NEGATIVE_INFINITY,this.lo=function(t){return Promise.resolve()},!t.Wn())throw new Ii(wi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.mi=new Tc(this,i),this._o=n+"main",this.Kt=new Fa(a),this.fo=new na(this._o,11,new xc(this.Kt)),this.wo=new yc(this.mi,this.Kt),this.Ii=new nc,this.Eo=function(t,e){return new Nc(t,e)}(this.Kt,this.Ii),this.To=new Xa,this.window&&this.window.localStorage?this.Io=this.window.localStorage:(this.Io=null,!1===h&&ai("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.mo().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ii(wi.FAILED_PRECONDITION,Pc);return t.Ao(),t.Ro(),t.Po(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.wo.ji(e)})}).then(function(e){t.ro=new Mi(e,t.so)}).then(function(){t.oo=!0}).catch(function(e){return t.fo&&t.fo.close(),Promise.reject(e)})},t.prototype.yo=function(t){var e=this;return this.lo=function(n){return Object(ii.b)(e,void 0,void 0,function(){return Object(ii.d)(this,function(e){return this.Ir?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.Vo=function(t){var e=this;this.fo.Zn(function(n){return Object(ii.b)(e,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.po=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.no.ys(function(){return Object(ii.b)(e,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return this.Ir?[4,this.mo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.mo=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Lc(e).put(new xa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.bo(e).next(function(e){e||(t.isPrimary=!1,t.no.vo(function(){return t.lo(!1)}))})}).next(function(){return t.So(e)}).next(function(n){return t.isPrimary&&!n?t.Do(e).next(function(){return!1}):!!n&&t.Co(e).next(function(){return!0})})}).catch(function(e){if(oa(e))return ui("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return ui("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.no.vo(function(){return t.lo(e)}),t.isPrimary=e})},t.prototype.bo=function(t){var e=this;return Vc(t).get(wa.key).next(function(t){return ta.resolve(e.xo(t))})},t.prototype.No=function(t){return Lc(t).delete(this.clientId)},t.prototype.Fo=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(ii.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.ho,18e5)?[3,2]:(this.ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=La(t,xa.store);return e.os().next(function(t){var n=r.ko(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return ta.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Io)for(e=0,n=t;e<n.length;e++)this.Io.removeItem(this.Mo(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Po=function(){var t=this;this.uo=this.no.mr("client_metadata_refresh",4e3,function(){return t.mo().then(function(){return t.Fo()}).then(function(){return t.Po()})})},t.prototype.xo=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.So=function(t){var e=this;return this.io?ta.resolve(!0):Vc(t).get(wa.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Lo(n.ownerId)){if(e.xo(n)&&e.networkEnabled)return!0;if(!e.xo(n)){if(!n.allowTabSynchronization)throw new Ii(wi.FAILED_PRECONDITION,Pc);return!1}}return!(!e.networkEnabled||!e.inForeground)||Lc(t).os().next(function(t){return void 0===e.ko(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&ui("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.$o=function(){return Object(ii.b)(this,void 0,void 0,function(){var t=this;return Object(ii.d)(this,function(e){switch(e.label){case 0:return this.oo=!1,this.Bo(),this.uo&&(this.uo.cancel(),this.uo=null),this.qo(),this.Uo(),[4,this.fo.runTransaction("shutdown","readwrite",[wa.store,xa.store],function(e){var n=new Va(e,Mi.U);return t.Do(n).next(function(){return t.No(n)})})];case 1:return e.sent(),this.fo.close(),this.Qo(),[2]}})})},t.prototype.ko=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Lo(t.clientId)})},t.prototype.Ko=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Lc(e).os().next(function(e){return t.ko(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Wo=function(t){return fc.Ri(t,this.Kt,this.Ii,this.mi)},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.jo=function(){return this.Ii},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r,i=this;return ui("IndexedDbPersistence","Starting transaction:",t),this.fo.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ma,function(o){return r=new Va(o,i.ro?i.ro.next():Mi.U),"readwrite-primary"===e?i.bo(r).next(function(t){return!!t||i.So(r)}).next(function(e){if(!e)throw ai("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.no.vo(function(){return i.lo(!1)}),new Ii(wi.FAILED_PRECONDITION,pa);return n(r)}).next(function(t){return i.Co(r).next(function(){return t})}):i.zo(r).next(function(){return n(r)})}).then(function(t){return r.bs(),t})},t.prototype.zo=function(t){var e=this;return Vc(t).get(wa.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Lo(t.ownerId)&&!e.xo(t)&&!(e.io||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ii(wi.FAILED_PRECONDITION,Pc)})},t.prototype.Co=function(t){var e=new wa(this.clientId,this.allowTabSynchronization,Date.now());return Vc(t).put(wa.key,e)},t.Wn=function(){return na.Wn()},t.prototype.Do=function(t){var e=this,n=Vc(t);return n.get(wa.key).next(function(t){return e.xo(t)?(ui("IndexedDbPersistence","Releasing primary lease."),n.delete(wa.key)):ta.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ai("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ao=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ao=function(){t.no.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.mo()})},this.document.addEventListener("visibilitychange",this.ao),this.inForeground="visible"===this.document.visibilityState)},t.prototype.qo=function(){this.ao&&(this.document.removeEventListener("visibilitychange",this.ao),this.ao=null)},t.prototype.Ro=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.co=function(){e.Bo(),e.no.ys(function(){return e.$o()})},this.window.addEventListener("unload",this.co))},t.prototype.Uo=function(){this.co&&(this.window.removeEventListener("unload",this.co),this.co=null)},t.prototype.Lo=function(t){var e;try{var n=null!==(null===(e=this.Io)||void 0===e?void 0:e.getItem(this.Mo(t)));return ui("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return ai("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Bo=function(){if(this.Io)try{this.Io.setItem(this.Mo(this.clientId),String(Date.now()))}catch(t){ai("Failed to set zombie client id.",t)}},t.prototype.Qo=function(){if(this.Io)try{this.Io.removeItem(this.Mo(this.clientId))}catch(t){}},t.prototype.Mo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Vc(t){return La(t,wa.store)}function Lc(t){return La(t,xa.store)}function Uc(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Rc=function(){function t(t,e,n){this.Eo=t,this.Ho=e,this.Ii=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.Eo.di(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Ns(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=Zs();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Ns(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.Eo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Di(t,e).next(function(r){var i=n.Xo(t,e,r),o=Ys();return i.forEach(function(t,e){e||(e=new Oo(t,Li.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return Gi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):Xo(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new Gi(e)).next(function(t){var e=eu();return t instanceof Io&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=eu();return this.Ii.Ks(t,i).next(function(s){return ta.forEach(s,function(s){var u=function(t,e){return new zo(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.Eo.jr(t,e,n).next(function(n){return r=n,o.Ho.xi(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=As(a,h,h,o.Ds);r=f instanceof Io?r.Ht(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){is(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=ou(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ps&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Eo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Io&&(c=c.Ht(t,e))}),c})},t}(),Fc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=ou(),i=ou(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),qc=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(Li.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return($o(e)||Jo(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(si()<=tt.a.DEBUG&&ui("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),rs(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new Ws(os(t));return e.forEach(function(e,r){r instanceof Io&&is(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return si()<=tt.a.DEBUG&&ui("QueryEngine","Using full collection scan to execute query:",rs(e)),this.uc.jr(t,e,Li.min())},t}(),Gc=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Ks(bi),this.wc=new uc(function(t){return jo(t)},No),this.Ec=Li.min(),this.Ho=t.Wo(n),this.Tc=t.kr(),this.wo=t.Cr(),this.Ic=new Rc(this.Tc,this.Ho,this.persistence.jo()),this.To=t.Go(),this.fc.ac(this.Ic)}return t.prototype.Ar=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.br(n,e.dc)})},t}();function Bc(t,e,n,r){return new Gc(t,e,n,r)}function zc(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(ii.d)(this,function(s){switch(s.label){case 0:return n=pi(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.vi(t).next(function(s){return o=s,r=n.persistence.Wo(e),i=new Rc(n.Tc,r,n.persistence.jo()),r.vi(t)}).next(function(e){for(var n=[],r=[],s=ou(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,b=d.mutations;v<b.length;v++)s=s.add(b[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function Hc(t,e){var n=pi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Gr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=ta.resolve();return o.forEach(function(t){s=s.next(function(){return r.di(e,t)}).next(function(e){var o=e,s=n.ks.get(t);li(null!==s),(!o||o.version.u(s)<0)&&(o=i.Cs(t,o,n))&&r.hi(o,n.Os)})}),s.next(function(){return t.Ho.Ni(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.ki(t)}).next(function(){return n.Ic.Zo(t,r)})})}function Kc(t){var e=pi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.wo.Wi(t)})}function $c(t,e){var n=pi(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Gr:!0});i=n.dc;var s=[];e.Oe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.wo.rr(t,e.Ke,o).next(function(){return n.wo.sr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.Ss);i=i.Ht(o,c),function(t,e,n){return li(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.j()-t.Mt.j()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.wo.Yi(t,c))}}});var u=Ys();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.mi.Mr(t,r))}),s.push(Jc(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(Li.min())){var a=n.wo.Wi(t).next(function(e){return n.wo.Gi(t,t.Ss,r)});s.push(a)}return ta.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function Jc(t,e,n,r,i){var o=ou();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Ys();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Oo&&s.version.isEqual(Li.min())?(e.fi(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.hi(s,a),o=o.Ht(n,s)):ui("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function Wc(t,e){var n=pi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.pi(t,e)})}function Qc(t,e){var n=pi(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.wo.nr(t,e).next(function(i){return i?ta.resolve(r=i):n.wo.Ui(t).next(function(i){return r=new us(e,i,0,t.Ss),n.wo.zi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function Xc(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:r=pi(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.mi.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!oa(s=u.sent()))throw s;return ui("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function Yc(t,e,n){var r=pi(t),i=Li.min(),o=ou();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=pi(t),i=r.wc.get(n);return void 0!==i?ta.resolve(r.dc.get(i)):r.wo.nr(e,n)}(r,t,Zo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.wo.ar(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:Li.min(),n?o:ou())}).next(function(t){return{documents:t,Pc:o}})})}function Zc(t,e){var n=pi(t),r=pi(n.wo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function th(t){var e=pi(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=pi(t),i=Ys(),o=Ba(n),s=Dc(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:ja.readTimeIndex,range:u},function(t,e){var n=qa(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{gs:i,readTime:za(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.gs;return e.Ec=t.readTime,n})}function eh(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){return[2,(e=pi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Dc(t),n=Li.min();return e.ls({index:ja.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=za(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function nh(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(ii.d)(this,function(d){switch(d.label){case 0:for(i=pi(t),o=ou(),s=Ys(),u=ru(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Gr:!0}),[4,Qc(i,function(t){return Zo(Ko(Ri.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Jc(t,l,s,Li.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.wo.Zi(t,p.targetId).next(function(){return i.wo.sr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function rh(t,e,n){return void 0===n&&(n=ou()),Object(ii.b)(this,void 0,void 0,function(){var r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return[4,Qc(t,Zo(Qa(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=pi(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=ju(e.readTime);if(r.Mt.u(o)>=0)return i.To.qs(t,e);var s=r.$t(mi.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.wo.Yi(t,s).next(function(){return i.wo.Zi(t,r.targetId)}).next(function(){return i.wo.sr(t,n,r.targetId)}).next(function(){return i.To.qs(t,e)})})]}})})}var ih=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ls=function(t,e){return ta.resolve(this.bc.get(e))},t.prototype.$s=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:ju(n.createTime)}),ta.resolve()},t.prototype.Bs=function(t,e){return ta.resolve(this.vc.get(e))},t.prototype.qs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:Qa(t.bundledQuery),readTime:ju(t.readTime)}}(e)),ta.resolve()},t}(),oh=function(){function t(){this.Sc=new Ws(sh.Dc),this.Cc=new Ws(sh.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.ir=function(t,e){var n=new sh(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},t.prototype.cr=function(t,e){this.Fc(new sh(t,e))},t.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.cr(t,e)})},t.prototype.kc=function(t){var e=this,n=new Gi(new Ri([])),r=new sh(n,t),i=new sh(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Fc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Fc(e)})},t.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new Gi(new Ri([])),n=new sh(e,t),r=new sh(e,t+1),i=ou();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Mi=function(t){var e=new sh(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),sh=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return Gi.J(t.key,e.key)||bi(t.$c,e.$c)},t.xc=function(t,e){return bi(t.$c,e.$c)||Gi.J(t.key,e.key)},t}(),uh=function(){function t(t,e){this.Ii=t,this.mi=e,this.Ho=[],this.Bc=1,this.qc=new Ws(sh.Dc)}return t.prototype.Pi=function(t){return ta.resolve(0===this.Ho.length)},t.prototype.yi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new Ua(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new sh(a.key,i)),this.Ii.Qs(t,a.key.path.Z())}return ta.resolve(o)},t.prototype.gi=function(t,e){return ta.resolve(this.Uc(e))},t.prototype.pi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return ta.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.bi=function(){return ta.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.vi=function(t){return ta.resolve(this.Ho.slice())},t.prototype.Si=function(t,e){var n=this,r=new sh(e,0),i=new sh(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),ta.resolve(o)},t.prototype.Di=function(t,e){var n=this,r=new Ws(bi);return e.forEach(function(t){var e=new sh(t,0),i=new sh(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),ta.resolve(this.Kc(r))},t.prototype.xi=function(t,e){var n=e.path,r=n.length+1,i=n;Gi.Et(i)||(i=i.child(""));var o=new sh(new Gi(i),0),s=new Ws(bi);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),ta.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.Ni=function(t,e){var n=this;li(0===this.Wc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return ta.forEach(e.mutations,function(i){var o=new sh(i.key,e.batchId);return r=r.delete(o),n.mi.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Fi=function(t){},t.prototype.Mi=function(t,e){var n=new sh(e,0),r=this.qc.Pe(n);return ta.resolve(e.isEqual(r&&r.key))},t.prototype.ki=function(t){return ta.resolve()},t.prototype.Wc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),ah=function(){function t(t,e){this.Ii=t,this.jc=e,this.docs=new Ks(Gi.J),this.size=0}return t.prototype.hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jc(e);return this.docs=this.docs.Ht(r,{_i:e,size:s,readTime:n}),this.size+=s-o,this.Ii.Qs(t,r.path.Z())},t.prototype.fi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.di=function(t,e){var n=this.docs.get(e);return ta.resolve(n?n._i:null)},t.prototype.getEntries=function(t,e){var n=this,r=Zs();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e._i:null)}),ta.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=eu(),i=new Gi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u._i,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof Io&&is(e,a)&&(r=r.Ht(a.key,a))}return ta.resolve(r)},t.prototype.Gc=function(t,e){return ta.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new ch(this)},t.prototype.Lr=function(t){return ta.resolve(this.size)},t}(),ch=function(t){function e(e){var n=this;return(n=t.call(this)||this).zr=e,n}return Object(ii.c)(e,t),e.prototype.Ti=function(t){var e=this,n=[];return this.ci.forEach(function(r,i){i&&i._i?n.push(e.zr.hi(t,i._i,e.ui(r))):e.zr.fi(r)}),ta.$n(n)},e.prototype.wi=function(t,e){return this.zr.di(t,e)},e.prototype.Ei=function(t,e){return this.zr.getEntries(t,e)},e}(ac),hh=function(){function t(t){this.persistence=t,this.zc=new uc(function(t){return jo(t)},No),this.lastRemoteSnapshotVersion=Li.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new oh,this.targetCount=0,this.Yc=bc.Bi()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),ta.resolve()},t.prototype.Wi=function(t){return ta.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return ta.resolve(this.Hc)},t.prototype.Ui=function(t){return this.highestTargetId=this.Yc.next(),ta.resolve(this.highestTargetId)},t.prototype.Gi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ta.resolve()},t.prototype.Hi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new bc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.zi=function(t,e){return this.Hi(e),this.targetCount+=1,ta.resolve()},t.prototype.Yi=function(t,e){return this.Hi(e),ta.resolve()},t.prototype.Xi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,ta.resolve()},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Zi(t,u.targetId)),i++)}),ta.$n(o).next(function(){return i})},t.prototype.er=function(t){return ta.resolve(this.targetCount)},t.prototype.nr=function(t,e){var n=this.zc.get(e)||null;return ta.resolve(n)},t.prototype.sr=function(t,e,n){return this.Jc.Nc(e,n),ta.resolve()},t.prototype.rr=function(t,e,n){this.Jc.Oc(e,n);var r=this.persistence.mi,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),ta.$n(i)},t.prototype.Zi=function(t,e){return this.Jc.kc(e),ta.resolve()},t.prototype.ar=function(t,e){var n=this.Jc.Lc(e);return ta.resolve(n)},t.prototype.Mi=function(t,e){return ta.resolve(this.Jc.Mi(e))},t}(),fh=function(){function t(t,e){var n=this;this.Xc={},this.ro=new Mi(0),this.oo=!1,this.oo=!0,this.mi=t(this),this.wo=new hh(this),this.Ii=new tc,this.Eo=function(t,e){return new ah(t,function(t){return n.mi.Zc(t)})}(this.Ii),this.Kt=new Fa(e),this.To=new ih(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.$o=function(){return this.oo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Vo=function(){},t.prototype.po=function(){},t.prototype.jo=function(){return this.Ii},t.prototype.Wo=function(t){var e=this.Xc[t.R()];return e||(e=new uh(this.Ii,this.mi),this.Xc[t.R()]=e),e},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r=this;ui("MemoryPersistence","Starting transaction:",t);var i=new lh(this.ro.next());return this.mi.ta(),n(i).next(function(t){return r.mi.ea(i).next(function(){return t})}).Mn().then(function(t){return i.bs(),t})},t.prototype.na=function(t,e){return ta.Bn(Object.values(this.Xc).map(function(n){return function(){return n.Mi(t,e)}}))},t}(),lh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ss=e,n}return Object(ii.c)(e,t),e}(da),ph=function(){function t(t){this.persistence=t,this.sa=new oh,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw fi()},enumerable:!1,configurable:!0}),t.prototype.ir=function(t,e,n){return this.sa.ir(n,e),this.oa.delete(n.toString()),ta.resolve()},t.prototype.cr=function(t,e,n){return this.sa.cr(n,e),this.oa.add(n.toString()),ta.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),ta.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Cr();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Xi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.kr().Or();return ta.forEach(this.oa,function(r){var i=Gi.ft(r);return e.ca(t,i).next(function(t){t||n.fi(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.Mr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return ta.Bn([function(){return ta.resolve(n.sa.Mi(e))},function(){return n.persistence.Cr().Mi(t,e)},function(){return n.persistence.na(t,e)}])},t}();function dh(t,e){return"firestore_clients_"+t+"_"+e}function vh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function bh(t,e){return"firestore_targets_"+t+"_"+e}var yh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Ii(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(ai("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),gh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ii(r.error.code,r.error.message)),i?new t(e,r.state,o):(ai("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),mh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=uu(),s=0;i&&s<r.activeTargetIds.length;++s)i=no(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ai("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),wh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ai("SharedClientState","Failed to parse online state: "+e),null)},t}(),Ih=function(){function t(){this.activeTargetIds=uu()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Oh=function(){function t(t,e,n,r,i){this.window=t,this.no=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Ks(bi),this.Ir=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=dh(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new Ih),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.Wn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(ii.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Ko()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(dh(this.persistenceKey,r)))&&(o=mh.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.$o()}),this.Ir=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(bh(this.persistenceKey,t));if(n){var r=gh.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(bh(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.Wa(t)},t.prototype.ja=function(){this.Ga()},t.prototype.$o=function(){this.Ir&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Ir=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ui("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ui("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ui("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(ui("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void ai("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.no.vo(function(){return Object(ii.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(ii.d)(this,function(u){if(this.Ir){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=Mi.U;if(null!=t)try{var n=JSON.parse(t);li("number"==typeof n),e=n}catch(t){ai("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Mi.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new yh(this.currentUser,t,e,n),i=vh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Oa=function(t){var e=vh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Wa=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=bh(this.persistenceKey,t),i=new gh(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return mh.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return yh.aa(new Ai(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return gh.aa(r,e)},t.prototype.ba=function(t){return wh.aa(t)},t.prototype.Xa=function(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(ui("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=uu();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),Eh=function(){function t(){this.ru=new Ih,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Fa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new Ih,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.$o=function(){},t.prototype.q=function(t){},t.prototype.ja=function(){},t}(),_h=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.$o=function(){},t}(),Th=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){ui("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){ui("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),jh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Nh=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Sh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(ii.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new ri;s.listenOnce(ti.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Zr.NO_ERROR:var e=s.getResponseJson();ui("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Zr.TIMEOUT:ui("Connection",'RPC "'+t+'" timed out'),o(new Ii(wi.DEADLINE_EXCEEDED,"Request time out"));break;case Zr.HTTP_ERROR:var n=s.getStatus();if(ui("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(wi).indexOf(e)>=0?e:wi.UNKNOWN}(r.status);o(new Ii(u,r.message))}else o(new Ii(wi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ii(wi.UNAVAILABLE,"Connection failed."));break;default:fi()}}finally{ui("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Jr,i=Qe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(et.l)()||Object(et.n)()||Object(et.j)()||Object(et.k)()||Object(et.o)()||Object(et.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");ui("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Nh({du:function(t){c?ui("Connection","Not sending because WebChannel is closed:",t):(a||(ui("Connection","Opening WebChannel transport."),u.open(),a=!0),ui("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,ni.EventType.OPEN,function(){c||ui("Connection","WebChannel transport opened.")}),f(u,ni.EventType.CLOSE,function(){c||(c=!0,ui("Connection","WebChannel transport closed"),h.Pu())}),f(u,ni.EventType.ERROR,function(t){c||(c=!0,ci("Connection","WebChannel transport errored:",t),h.Pu(new Ii(wi.UNAVAILABLE,"The operation could not be completed")))}),f(u,ni.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];li(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){ui("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Rs[t];if(void 0!==e)return Hs(e)}(i),s=r.message;void 0===o&&(o=wi.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new Ii(o,s)),u.close()}else ui("Connection","WebChannel received:",n),h.yu(n)}}),f(i,ei.STAT_EVENT,function(t){10===t.stat?ui("Connection","Detected buffering proxy"):11===t.stat&&ui("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);ui("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return ui("RestConnection","Received: ",t),t},function(e){throw ci("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.1",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+jh[t]},t}());function Ah(){return"undefined"!=typeof window?window:null}function Dh(){return"undefined"!=typeof document?document:null}function Ch(t){return new Ou(t,!0)}var xh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.no=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Ou},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&ui("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.no.mr(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),kh=function(){function t(t,e,n,r,i,o){this.no=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new xh(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.no.mr(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==t?this.zu.reset():e&&e.code===wi.RESOURCE_EXHAUSTED?(ai(e.toString()),ai("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===wi.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.ju),n=this.ju;this.Wu.getToken().then(function(e){t.ju===n&&t.rh(e)},function(n){e(function(){var e=new Ii(wi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(ii.b)(t,void 0,void 0,function(){return Object(ii.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return ui("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.no.ys(function(){return e.ju===t?n():(ui("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Ph=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(ii.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:fi()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(li(void 0===e||"string"==typeof e),mi.fromBase64String(e||"")):(li(void 0===e||e instanceof Uint8Array),mi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?wi.UNKNOWN:Hs(t.code);return new Ii(e,t.message||"")}(u);n=new vu(r,i,o,s||null)}else if("documentChange"in e){i=Du(t,(r=e.documentChange).document.name),o=ju(r.document.updateTime);var u=new yo({mapValue:{fields:r.document.fields}}),a=(s=new Io(i,o,u,{}),r.targetIds||[]);n=new pu(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Du(t,(r=e.documentDelete).document),o=r.readTime?ju(r.readTime):Li.min(),u=new Oo(i,o),n=new pu([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=Du(t,(r=e.documentRemove).document),n=new pu([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return fi();var c=e.filter;i=new Bs(r=c.count||0),n=new du(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return Li.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Li.min():e.readTime?ju(e.readTime):Li.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=ku(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=So(r)?{documents:Ru(t,r)}:{query:Fu(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=_u(t,e.resumeToken):e.Mt.u(Li.min())>0&&(n.readTime=Eu(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return fi()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=ku(this.Kt),e.removeTarget=t,this.eh(e)},e}(kh),Mh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(li(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(li(void 0!==e),t.map(function(t){return function(t,e){var n=ju(t.updateTime?t.updateTime:e);n.isEqual(Li.min())&&(n=ju(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new _s(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=ju(t.commitTime);return this.listener.wh(n,e)}return li(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=ku(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Lu(e.Kt,t)})};this.eh(n)},e}(kh),Vh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(ii.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new Ii(wi.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===wi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===wi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),Lh=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.mr("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(ai(e),this.Ph=!1):ui("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),Uh=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(ii.b)(o,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return $h(this)?(ui("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return(e=pi(t)).Fh.add(4),[4,Fh(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Rh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Lh(n,r)};function Rh(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:if(!$h(t))return[3,4];e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Fh(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function qh(t,e){var n=pi(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),Kh(n)?Hh(n):cf(n).Ju()&&Bh(n,e))}function Gh(t,e){var n=pi(t),r=cf(n);n.Nh.delete(e),r.Ju()&&zh(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():$h(n)&&n.Mh.set("Unknown"))}function Bh(t,e){t.Lh.cn(e.targetId),cf(t).hh(e)}function zh(t,e){t.Lh.cn(e),cf(t).lh(e)}function Hh(t){t.Lh=new yu({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),cf(t).start(),t.Mh.yh()}function Kh(t){return $h(t)&&!cf(t).Hu()&&t.Nh.size>0}function $h(t){return 0===pi(t).Fh.size}function Jh(t){t.Lh=void 0}function Wh(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){return t.Nh.forEach(function(e,n){Bh(t,e)}),[2]})})}function Qh(t,e){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(n){return Jh(t),Kh(t)?(t.Mh.ph(e),Hh(t)):t.Mh.set("Unknown"),[2]})})}function Xh(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o;return Object(ii.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof vu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(ii.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),ui("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Yh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof pu?t.Lh.wn(e):e instanceof du?t.Lh.yn(e):t.Lh.In(e),n.isEqual(Li.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Kc(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Oe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(mi.h,n.Mt)),zh(t,e);var r=new us(n.target,e,1,n.sequenceNumber);Bh(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return ui("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Yh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Yh(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r=this;return Object(ii.d)(this,function(i){switch(i.label){case 0:if(!oa(e))throw e;return t.Fh.add(1),[4,Fh(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return Kc(t.Sh)}),t.fs.vo(function(){return Object(ii.b)(r,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return ui("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Fh.delete(1),[4,Rh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Zh(t,e){return e().catch(function(n){return Yh(t,n,e)})}function tf(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(ii.d)(this,function(s){switch(s.label){case 0:e=pi(t),n=hf(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return $h(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Wc(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=hf(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Yh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return ef(e)&&nf(e),[2]}})})}function ef(t){return $h(t)&&!hf(t).Hu()&&t.xh.length>0}function nf(t){hf(t).start()}function rf(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){return hf(t).Th(),[2]})})}function of(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n,r;return Object(ii.d)(this,function(i){for(e=hf(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function sf(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=Ra.from(r,e,n),[4,Zh(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,tf(t)];case 2:return o.sent(),[2]}})})}function uf(t,e){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(n){switch(n.label){case 0:return e&&hf(t).fh?[4,function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:return zs(r=e.code)&&r!==wi.ABORTED?(n=t.xh.shift(),hf(t).Xu(),[4,Zh(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,tf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ef(t)&&nf(t),[2]}})})}function af(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n;return Object(ii.d)(this,function(r){switch(r.label){case 0:return n=pi(t),e?(n.Fh.delete(2),[4,Rh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Fh.add(2),[4,Fh(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function cf(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=pi(t);return r.mh(),new Ph(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Wh.bind(null,t),Iu:Qh.bind(null,t),uh:Xh.bind(null,t)}),t.Oh.push(function(n){return Object(ii.b)(e,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),Kh(t)?Hh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),Jh(t),e.label=3;case 3:return[2]}})})})),t.Qh}function hf(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=pi(t);return r.mh(),new Mh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:rf.bind(null,t),Iu:uf.bind(null,t),Eh:of.bind(null,t),wh:sf.bind(null,t)}),t.Oh.push(function(n){return Object(ii.b)(e,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,tf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(ui("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var ff=function(){this.Wh=void 0,this.listeners=[]},lf=function(){this.queries=new uc(function(t){return ns(t)},es),this.onlineState="Unknown",this.jh=new Set};function pf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(ii.d)(this,function(c){switch(c.label){case 0:if(n=pi(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new ff),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.Wh=c.sent(),[3,4];case 3:return u=c.sent(),a=fa(u,"Initialization of query '"+rs(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.Wh&&e.Hh(o.Wh)&&yf(n),[2]}})})}function df(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(ii.d)(this,function(u){return n=pi(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function vf(t,e){for(var n=pi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&yf(n)}function bf(t,e,n){var r=pi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function yf(t){t.jh.forEach(function(t){t.next()})}var gf=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new hu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=hu.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),mf=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),wf=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return Du(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Vu(this.Kt,t.document,!1):new Oo(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return ju(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new wf(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||ou()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return[4,nh(this.Sh,new wf(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,rh(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new la(Object.assign({},this.progress),t))]}})})}}();var If=function(t){this.key=t},Of=function(t){this.key=t},Ef=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=ou(),this.Ce=ou(),this.ll=os(t),this._l=new au(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new cu,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=$o(this.query)&&i.size===this.query.limit?i.last():null,c=Jo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof Io?e:null;f&&(f=is(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),$o(this.query)||Jo(this.query))for(;s.size>this.query.limit;){var h=$o(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ti=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fi()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new hu(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({_l:this._l,wl:new cu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=ou(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new Of(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new If(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=ou();var e=this.dl(t.documents);return this.Ti(e,!0)},t.prototype.Pl=function(){return hu.Fe(this.query,this._l,this.Ce,0===this.ul)},t}(),_f=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Tf=function(t){this.key=t,this.yl=!1},jf=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new uc(function(t){return ns(t)},es),this.Dl=new Map,this.Cl=[],this.xl=new Ks(Gi.J),this.Nl=new Map,this.Fl=new oh,this.Ol={},this.kl=new Map,this.Ml=bc.qi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Nf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:return n=nl(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,Qc(n.Sh,Zo(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,Sf(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&qh(n.gl,o),u.label=4;case 4:return[2,r]}})})}function Sf(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(ii.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,Yc(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Oe.get(e.targetId),s=e.view.Ti(i,t.$l,o),[2,(qf(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,Yc(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Ef(e,i.Pc),s=o.dl(i.documents),u=lu.Be(n,r&&"Offline"!==t.onlineState),a=o.Ti(s,t.$l,u),qf(t,n,a.ml),c=new _f(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Af(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return n=pi(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!es(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,Xc(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),Gh(n.gl,r.targetId),Rf(n,r.targetId)}).catch(sc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Rf(n,r.targetId),[4,Xc(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Df(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:r=rl(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=pi(t),i=Vi.now(),o=e.reduce(function(t,e){return t.add(e.key)},ou());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Ds(c,n.get(c.key));null!=h&&s.push(new Ps(c.key,h,mo(h.proto.mapValue),Ts.exists(!0)))}return r.Ho.yi(t,i,s,e)})}).then(function(t){var e=t.Fs(n);return{batchId:t.batchId,ci:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Ol[t.currentUser.R()];r||(r=new Ks(bi)),r=r.Ht(e,n),t.Ol[t.currentUser.R()]=r}(r,i.batchId,n),[4,zf(r,i.ci)];case 3:return u.sent(),[4,tf(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=fa(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Cf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:n=pi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,$c(n.Sh,e)];case 2:return r=i.sent(),e.Oe.forEach(function(t,e){var r=n.Nl.get(e);r&&(li(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?li(r.yl):t.Ke.size>0&&(li(r.yl),r.yl=!1))}),[4,zf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,sc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function xf(t,e,n){var r=pi(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=pi(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&yf(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function kf(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(ii.d)(this,function(c){switch(c.label){case 0:return(r=pi(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new Ks(Gi.J)).Ht(o,new Oo(o,Li.min())),u=ou().add(o),a=new fu(Li.min(),new Map,new Ws(bi),s,u),[4,Cf(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),Bf(r),[3,4];case 2:return[4,Xc(r.Sh,e,!1).then(function(){return Rf(r,e,n)}).catch(sc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Pf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:n=pi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Hc(n.Sh,e)];case 2:return i=o.sent(),Uf(n,r,null),Lf(n,r),n.pl.Fa(r,"acknowledged"),[4,zf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Mf(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:r=pi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=pi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.gi(t,e).next(function(e){return li(null!==e),r=e.keys(),n.Ho.Ni(t,e)}).next(function(){return n.Ho.ki(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),Uf(r,e,n),Lf(r,e),r.pl.Fa(e,"rejected",n),[4,zf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Vf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:$h((n=pi(t)).gl)||ui("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=pi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.bi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=fa(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Lf(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Uf(t,e,n){var r=pi(t),i=r.Ol[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i}}function Rf(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Fl.kc(e).forEach(function(e){t.Fl.Mi(e)||Ff(t,e)})}function Ff(t,e){var n=t.xl.get(e);null!==n&&(Gh(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Bf(t))}function qf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof If?(t.Fl.ir(o.key,e),Gf(t,o)):o instanceof Of?(ui("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.cr(o.key,e),t.Fl.Mi(o.key)||Ff(t,o.key)):fi()}}function Gf(t,e){var n=e.key;t.xl.get(n)||(ui("SyncEngine","New document in limbo: "+n),t.Cl.push(n),Bf(t))}function Bf(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Tf(e)),t.xl=t.xl.Ht(e,n),qh(t.gl,new us(Zo(Ko(e.path)),n,2,Mi.U))}}function zf(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:return r=pi(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Fc.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(ii.d)(this,function(h){switch(h.label){case 0:n=pi(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ta.forEach(e,function(e){return ta.forEach(e.rc,function(r){return n.persistence.mi.ir(t,e.targetId,r)}).next(function(){return ta.forEach(e.oc,function(r){return n.persistence.mi.cr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!oa(r=h.sent()))throw r;return ui("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Hf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:return(n=pi(t)).currentUser.isEqual(e)?[3,3]:(ui("SyncEngine","User change. New user:",e.R()),[4,zc(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new Ii(wi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,zf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Kf(t,e){var n=pi(t),r=n.Nl.get(e);if(r&&r.yl)return ou().add(r.key);var i=ou(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function $f(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return[4,Yc((n=pi(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&qf(n,e.targetId,i.ml),i)]}})})}function Jf(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){return[2,th((e=pi(t)).Sh).then(function(t){return zf(e,t)})]})})}function Wf(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o;return Object(ii.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=pi(t),r=pi(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Vi(t,e).next(function(e){return e?n.Ic.Zo(t,e):ta.resolve(null)})})}((i=pi(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,tf(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Uf(i,e,r||null),Lf(i,e),function(t,e){pi(pi(t).Ho).Fi(e)}(i.Sh,e)):fi(),s.label=4;case 4:return[4,zf(i,o)];case 5:return s.sent(),[3,7];case 6:ui("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Qf(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(ii.d)(this,function(c){switch(c.label){case 0:return nl(n=pi(t)),rl(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,Xf(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,af(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)qh(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return Rf(n,e),Xc(n.Sh,e,!0)}),Gh(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,Xf(n,u)];case 5:return c.sent(),function(t){var e=pi(t);e.Nl.forEach(function(t,n){Gh(e.gl,n)}),e.Fl.Mc(),e.Nl=new Map,e.xl=new Ks(Gi.J)}(n),n.Ll=!1,[4,af(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Xf(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(ii.d)(this,function(v){switch(v.label){case 0:n=pi(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,Qc(n.Sh,Zo(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,$f(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Zc(n.Sh,u)];case 8:return d=v.sent(),[4,Qc(n.Sh,d)];case 9:return a=v.sent(),[4,Sf(n,Yf(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function Yf(t){return Ho(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Zf(t){var e=pi(t);return pi(pi(e.Sh).persistence).Ko()}function tl(t,e,n,r){return Object(ii.b)(this,void 0,void 0,function(){var i,o,s;return Object(ii.d)(this,function(u){switch(u.label){case 0:return(i=pi(t)).Ll?(ui("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,th(i.Sh)];case 3:return o=u.sent(),s=fu.$e(e,"current"===n),[4,zf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,Xc(i.Sh,e,!0)];case 6:return u.sent(),Rf(i,e,r),[3,8];case 7:fi(),u.label=8;case 8:return[2]}})})}function el(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(ii.d)(this,function(l){switch(l.label){case 0:if(!(r=nl(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(ui("SyncEngine","Adding an already active target "+s),[3,5]):[4,Zc(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,Qc(r.Sh,u)];case 3:return a=l.sent(),[4,Sf(r,Yf(u),a.targetId,!1)];case 4:l.sent(),qh(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(ii.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,Xc(r.Sh,t,!1).then(function(){Gh(r.gl,t),Rf(r,t)}).catch(sc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function nl(t){var e=pi(t);return e.gl.Ch.Bh=Cf.bind(null,e),e.gl.Ch.Sn=Kf.bind(null,e),e.gl.Ch.$h=kf.bind(null,e),e.vl.uh=vf.bind(null,e.Vl),e.vl.ql=bf.bind(null,e.Vl),e}function rl(t){var e=pi(t);return e.gl.Ch.qh=Pf.bind(null,e),e.gl.Ch.Uh=Mf.bind(null,e),e}var il=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return this.Kt=Ch(t.gu.T),this.pl=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Bc(this.persistence,new qc,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new fh(ph.ra,this.Kt)},t.prototype.jl=function(t){return new Eh},t.prototype.terminate=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},t}(),ol=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(ii.c)(e,t),e.prototype.initialize=function(e){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,eh(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,rl(this.Xl.fa)];case 4:return n.sent(),[4,tf(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return Bc(this.persistence,new qc,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new Ec(this.persistence.mi.dr,t.fs)},e.prototype.Gl=function(t){var e=Uc(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?oc.Zs(this.cacheSizeBytes):oc.ni;return new Mc(this.synchronizeTabs,e,t.clientId,n,t.fs,Ah(),Dh(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.jl=function(t){return new Eh},e}(il),sl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(ii.c)(e,t),e.prototype.initialize=function(e){return Object(ii.b)(this,void 0,void 0,function(){var n,r=this;return Object(ii.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Oh?(this.pl.fa={nu:Wf.bind(null,n),su:tl.bind(null,n),iu:el.bind(null,n),Ko:Zf.bind(null,n),eu:Jf.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.yo(function(t){return Object(ii.b)(r,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return[4,Qf(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Ir?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=Ah();if(!Oh.Wn(e))throw new Ii(wi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Uc(t.gu.T,t.gu.persistenceKey);return new Oh(e,t.fs,n,t.clientId,t.Yl)},e}(ol),ul=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n=this;return Object(ii.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return xf(n.fa,t,1)},this.gl.Ch.s_=Hf.bind(null,this.fa),[4,af(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new lf},t.prototype.Zl=function(t){var e=Ch(t.gu.T),n=new Sh(t.gu);return function(t,e,n){return new Vh(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return xf(s.fa,t,0)},o=Th.Wn()?new Th:new _h,new Uh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new jf(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return e=pi(t),ui("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,Fh(e)];case 1:return n.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),al=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),cl=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new Zu,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new mf(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ii(wi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new qi(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),hl=function(t){this._methodName=t};function fl(t,e,n){if(!n)throw new Ii(wi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function ll(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ii(wi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function pl(t,e,n,r){if(!0===e&&!0===r)throw new Ii(wi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function dl(t){if(!Gi.Et(t))throw new Ii(wi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function vl(t){if(Gi.Et(t))throw new Ii(wi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function bl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":fi()}function yl(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ii(wi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=bl(t);throw new Ii(wi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function gl(t,e){if(e<=0)throw new Ii(wi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ml=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ii(wi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ii(wi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,pl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),wl=new Map,Il=function(){function t(t,e){this.w_="(lite)",this.E_=new ml({}),this.T_=!1,t instanceof Si?(this.I_=t,this.m_=new Ci):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ii(wi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Si(t.options.projectId)}(t),this.m_=new xi(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Ii(wi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Ii(wi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new ml(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Ci;switch(t.type){case"gapi":var e=t.client;return li(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pi(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ii(wi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=wl.get(this))&&(ui("ComponentProvider","Removing Datastore"),wl.delete(this),t.terminate()),Promise.resolve();var t},t}(),Ol=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new _l(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),El=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),_l=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Ko(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Ol(this.firestore,null,new Gi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(El);function Tl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ei&&(t=t._),fl("collection","path",e),t instanceof Il)return vl(n=Ri.ct.apply(Ri,Object(ii.g)([e],r))),new _l(t,null,n);if(!(t instanceof Ol||t instanceof _l))throw new Ii(wi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return vl(n=Ri.ct.apply(Ri,Object(ii.g)([t.path],r)).child(Ri.ct(e))),new _l(t.firestore,null,n)}function jl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ei&&(t=t._),1===arguments.length&&(e=vi.t()),fl("doc","path",e),t instanceof Il)return dl(n=Ri.ct.apply(Ri,Object(ii.g)([e],r))),new Ol(t,null,new Gi(n));if(!(t instanceof Ol||t instanceof _l))throw new Ii(wi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return dl(n=t.D_.child(Ri.ct.apply(Ri,Object(ii.g)([e],r)))),new Ol(t.firestore,t instanceof _l?t.v_:null,new Gi(n))}function Nl(t,e){return t instanceof Ei&&(t=t._),e instanceof Ei&&(e=e._),(t instanceof Ol||t instanceof _l)&&(e instanceof Ol||e instanceof _l)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Sl(t,e){return t instanceof Ei&&(t=t._),e instanceof Ei&&(e=e._),t instanceof El&&e instanceof El&&t.firestore===e.firestore&&es(t.C_,e.C_)&&t.v_===e.v_}var Al=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ii(wi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ii(wi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return bi(this.x_,t.x_)||bi(this.N_,t.N_)},t}(),Dl=/^__.*__$/,Cl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.zt?new Ps(t,this.data,this.zt,e,this.fieldTransforms):new ks(t,this.data,e,this.fieldTransforms)},t}(),xl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Ps(t,this.data,this.zt,e,this.fieldTransforms)},t}();function kl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fi()}}var Pl=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return tp(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(kl(this.k_)&&Dl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Ml=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Ch(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Pl({k_:t,methodName:e,j_:n,path:qi.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function Vl(t){var e=t.p_(),n=Ch(t.I_);return new Ml(t.I_,!!e.ignoreUndefinedProperties,n)}function Ll(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Ql("Data must be an object, but it was:",s,r);var u,a,c=Jl(r,s);if(o.merge)u=new Ki(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Xl(e,l[f],n);if(!s.contains(p))throw new Ii(wi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ep(h,p)||h.push(p)}u=new Ki(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Cl(new yo(c),u,a)}var Ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(hl);function Rl(t,e,n){return new Pl({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Fl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.z_=function(t){return new Es(t.path,new vs)},e.prototype.isEqual=function(t){return t instanceof e},e}(hl),ql=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(ii.c)(e,t),e.prototype.z_=function(t){var e=Rl(this,t,!0),n=this.H_.map(function(t){return $l(t,e)}),r=new bs(n);return new Es(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hl),Gl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(ii.c)(e,t),e.prototype.z_=function(t){var e=Rl(this,t,!0),n=this.H_.map(function(t){return $l(t,e)}),r=new gs(n);return new Es(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hl),Bl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(ii.c)(e,t),e.prototype.z_=function(t){var e=new ws(t.Kt,hs(t.Kt,this.J_));return new Es(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(hl);function zl(t,e,n,r){var i=t.G_(1,e,n);Ql("Data must be an object, but it was:",i,r);var o=[],s=new go;zi(r,function(t,r){var u=Zl(e,t,n);r instanceof Ei&&(r=r._);var a=i.U_(u);if(r instanceof Ul)o.push(u);else{var c=$l(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new Ki(o);return new xl(s.yt(),u,i.fieldTransforms)}function Hl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Xl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ii(wi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Xl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new go,l=u.length-1;l>=0;--l)if(!ep(h,u[l])){var p=u[l],d=a[l];d instanceof Ei&&(d=d._);var v=s.U_(p);if(d instanceof Ul)h.push(p);else{var b=$l(d,v);null!=b&&(h.push(p),f.set(p,b))}}var y=new Ki(h);return new xl(f.yt(),y,s.fieldTransforms)}function Kl(t,e,n,r){return void 0===r&&(r=!1),$l(n,t.G_(r?4:3,e))}function $l(t,e){if(t instanceof Ei&&(t=t._),Wl(t))return Ql("Unsupported field value:",e,t),Jl(t,e);if(t instanceof hl)return function(t,e){if(!kl(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=$l(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Ei&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return hs(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vi.fromDate(t);return{timestampValue:Eu(e.Kt,n)}}if(t instanceof Vi)return n=new Vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Eu(e.Kt,n)};if(t instanceof Al)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Oi)return{bytesValue:_u(e.Kt,t.l)};if(t instanceof Ol){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Nu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+bl(t))}(t,e)}function Jl(t,e){var n={};return Hi(t)?e.path&&e.path.length>0&&e.zt.push(e.path):zi(t,function(t,r){var i=$l(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Wl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vi||t instanceof Al||t instanceof Oi||t instanceof Ol||t instanceof hl)}function Ql(t,e,n){if(!Wl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=bl(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function Xl(t,e,n){if(e instanceof Ei&&(e=e._),e instanceof cl)return e.d_;if("string"==typeof e)return Zl(t,e);throw tp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Yl=new RegExp("[~\\*/\\[\\]]");function Zl(t,e,n){if(e.search(Yl)>=0)throw tp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(cl.bind.apply(cl,Object(ii.g)([void 0],e.split("."))))).d_}catch(r){throw tp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function tp(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Ii(wi.INVALID_ARGUMENT,(u+=". ")+t+a)}function ep(t,e){return t.some(function(t){return t.isEqual(e)})}var np=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n=this;return Object(ii.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Ii(wi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(ii.d)(this,function(a){switch(a.label){case 0:return n=pi(t),r=ku(n.Kt)+"/documents",i={documents:e.map(function(t){return Au(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){li(!!e.found);var n=Du(t,e.found.name),r=ju(e.found.updateTime),i=new yo({mapValue:{fields:e.found.fields}});return new Io(n,r,i,{})}(t,e):"missing"in e?function(t,e){li(!!e.missing),li(!!e.readTime);var n=Du(t,e.missing),r=ju(e.readTime);return new Oo(n,r)}(t,e):fi()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());li(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Oo||t instanceof Io?n.sf(t):fi()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new qs(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e=this;return Object(ii.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Gi.ft(n);e.mutations.push(new Gs(r,e.Gt(r)))}),[4,function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return n=pi(t),r=ku(n.Kt)+"/documents",i={writes:e.map(function(t){return Lu(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Io)e=t.version;else{if(!(t instanceof Oo))throw fi();e=Li.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ii(wi.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ts.updateTime(e):Ts.Wt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Li.min()))throw new Ii(wi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ts.updateTime(e)}return Ts.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),rp=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new xh(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(ii.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(ii.d)(this,function(r){return t=new np(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!to(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!zs(e)}return!1},t}(),ip=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Ai.UNAUTHENTICATED,this.clientId=vi.t(),this._f=function(){},this.N=new Zu,this.credentials.S(function(t){ui("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new Ii(wi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new Zu;return this.fs.Tf(function(){return Object(ii.b)(t,void 0,void 0,function(){var t,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=fa(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function op(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(ii.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),ui("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.vo(function(){return Object(ii.b)(i,void 0,void 0,function(){return Object(ii.d)(this,function(t){switch(t.label){case 0:return[4,zc(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.Vo(function(){return t.terminate()}),t.mf=e,[2]}})})}function sp(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,up(t)];case 1:return n=i.sent(),ui("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.vo(function(){return function(t,e){return Object(ii.b)(this,void 0,void 0,function(){var n,r;return Object(ii.d)(this,function(i){switch(i.label){case 0:return(n=pi(t)).fs.Af(),ui("RemoteStore","RemoteStore received new credentials"),r=$h(n),n.Fh.add(3),[4,Fh(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Fh.delete(3),[4,Rh(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function up(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(ui("FirestoreClient","Using default OfflineComponentProvider"),[4,op(t,new il)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function ap(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(ui("FirestoreClient","Using default OnlineComponentProvider"),[4,sp(t,new ul)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function cp(t){return up(t).then(function(t){return t.persistence})}function hp(t){return up(t).then(function(t){return t.Sh})}function fp(t){return ap(t).then(function(t){return t.gl})}function lp(t){return ap(t).then(function(t){return t.fa})}function pp(t){return Object(ii.b)(this,void 0,void 0,function(){var e,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:return[4,ap(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Nf.bind(null,e.fa),n.Jh=Af.bind(null,e.fa),n)]}})})}function dp(t,e,n){var r=this;void 0===n&&(n={});var i=new Zu;return t.fs.ys(function(){return Object(ii.b)(r,void 0,void 0,function(){var r;return Object(ii.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new al({next:function(o){e.ys(function(){return df(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Ii(wi.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Ii(wi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new gf(Ko(n.path),o,{includeMetadataChanges:!0,sl:!0});return pf(t,s)},[4,pp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function vp(t,e,n){var r=this;void 0===n&&(n={});var i=new Zu;return t.fs.ys(function(){return Object(ii.b)(r,void 0,void 0,function(){var r;return Object(ii.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new al({next:function(n){e.ys(function(){return df(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Ii(wi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new gf(n,o,{includeMetadataChanges:!0,sl:!0});return pf(t,s)},[4,pp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var bp=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new xh(this,"async_queue_retry"),this.vf=function(){var e=Dh();e&&ui("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Dh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Dh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.vo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(ii.b)(this,void 0,void 0,function(){var t,e=this;return Object(ii.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!oa(t=n.sent()))throw t;return ui("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,ai("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.mr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=ha.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&fi()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(ii.b)(this,void 0,void 0,function(){var t;return Object(ii.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),yp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new bp,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(ii.c)(e,t),e.prototype.b_=function(){return this.Lf||mp(this),this.Lf.terminate()},e}(Il);function gp(t){return t.Lf||mp(t),t.Lf.df(),t.Lf}function mp(t){var e=t.p_(),n=function(t,e,n){return new Ni(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new ip(t.m_,t.Mf,n)}function wp(t,e,n){var r=this,i=new Zu;return t.fs.enqueue(function(){return Object(ii.b)(r,void 0,void 0,function(){var r;return Object(ii.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,op(t,n)];case 1:return o.sent(),[4,sp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===wi.FAILED_PRECONDITION||t.code===wi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Ip(t){if(t.R_||t.P_)throw new Ii(wi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Op=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Wi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Qi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw fi()}},t.prototype.jf=function(t,e){var n=this,r={};return zi(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Al(Wi(t.latitude),Wi(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=Yi(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Zi(t));default:return null}},t.prototype.Bf=function(t){var e=Ji(t);return new Vi(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=Ri.ct(t);li(Yu(n));var r=new Si(n.get(1),n.get(3)),i=new Gi(n.X(5));return r.isEqual(e)||ai("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Ep=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ol(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new _p(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Tp("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),_p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Ep);function Tp(t,e){return"string"==typeof e?Zl(t,e):e instanceof Ei?e._.d_:e.d_}function jp(t){if(Jo(t)&&0===t.Nt.length)throw new Ii(wi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Np=function(){};function Sp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Ap=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(ii.c)(e,t),e.prototype.Yf=function(t){var e=Vl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new Ii(wi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Vp(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Mp(r,t,h[c]));u={arrayValue:{values:a}}}else u=Mp(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Vp(s,o),u=Kl(n,"where",s,"in"===o||"not-in"===o);var f=Ao.create(i,o,u);return function(t,e){if(e.xt()){var n=Qo(t);if(null!==n&&!n.isEqual(e.field))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Wo(t);null!==r&&Lp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Ii(wi.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new El(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new zo(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Np),Dp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(ii.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Fo(e,n);return function(t,e){if(null===Wo(t)){var n=Qo(t);null!==n&&Lp(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new El(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new zo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Np),Cp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(ii.c)(e,t),e.prototype.Yf=function(t){return new El(t.firestore,t.v_,ts(t.C_,this.nd,this.sd))},e}(Np),xp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(ii.c)(e,t),e.prototype.Yf=function(t){var e=Pp(t,this.type,this.rd,this.od);return new El(t.firestore,t.v_,function(t,e){return new zo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Np),kp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(ii.c)(e,t),e.prototype.Yf=function(t){var e=Pp(t,this.type,this.rd,this.od);return new El(t.firestore,t.v_,function(t,e){return new zo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Np);function Pp(t,e,n,r){if(n[0]instanceof Ei&&(n[0]=n[0]._),n[0]instanceof Ep)return function(t,e,n,r,i){if(!r)throw new Ii(wi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Yo(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(ho(e,r.key));else{var c=r.field(a.field);if(Xi(c))throw new Ii(wi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Uo(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=Vl(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Ii(wi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Xo(t)&&-1!==c.indexOf("/"))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Ri.ct(c));if(!Gi.Et(h))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Gi(h);u.push(ho(e,f))}else{var l=Kl(n,r,c);u.push(l)}}return new Uo(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Mp(t,e,n){if(n instanceof Ei&&(n=n._),"string"==typeof n){if(""===n)throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xo(e)&&-1!==n.indexOf("/"))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Ri.ct(n));if(!Gi.Et(r))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ho(t,new Gi(r))}if(n instanceof Ol)return ho(t,n.S_);throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+bl(n)+".")}function Vp(t,e){if(!Array.isArray(t)||0===t.length)throw new Ii(wi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ii(wi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Lp(t,e,n){if(!n.isEqual(e))throw new Ii(wi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Up(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Rp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Fp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ii.c)(e,t),e.prototype.Uf=function(t){return new Oi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Ol(this.firestore,null,e)},e}(Op),qp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Gp=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(ii.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Bp(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Tp("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Ep),Bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Gp),zp=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new qp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new Bp(n.zf,n.Hf,r.key,r,new qp(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new Ii(wi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new Bp(t.zf,t.Hf,e.doc.key,e.doc,new qp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Bp(t.zf,t.Hf,e.doc.key,e.doc,new qp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Hp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function Hp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fi()}}function Kp(t,e){return t instanceof Gp&&e instanceof Gp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof zp&&e instanceof zp&&t.zf===e.zf&&Sl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var $p=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ii.c)(e,t),e.prototype.Uf=function(t){return new Oi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Ol(this.firestore,null,e)},e}(Op);function Jp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=yl(t,Ol);var o=yl(t.firestore,yp),s=Vl(o);return e instanceof Ei&&(e=e._),Qp(o,[("string"==typeof e||e instanceof cl?Hl(s,"updateDoc",t.S_,e,n,r):zl(s,"updateDoc",t.S_,e)).F_(t.S_,Ts.exists(!0))])}function Wp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Ei&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Up(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Up(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Ol)c=yl(t.firestore,yp),h=Ko(t.S_.path),a={next:function(e){i[u]&&i[u](Xp(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=yl(t,El);c=yl(p.firestore,yp),h=p.C_;var d=new $p(c);a={next:function(t){i[u]&&i[u](new zp(c,d,p,t))},error:i[u+1],complete:i[u+2]},jp(t.C_)}return function(t,e,n,r){var i=this,o=new al(r),s=new gf(e,o,n);return t.fs.ys(function(){return Object(ii.b)(i,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return e=pf,[4,pp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(ii.b)(i,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return e=df,[4,pp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(gp(c),h,f,a)}function Qp(t,e){return function(t,e){var n=this,r=new Zu;return t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var n;return Object(ii.d)(this,function(i){switch(i.label){case 0:return n=Df,[4,lp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(gp(t),e)}function Xp(t,e,n){var r=n.docs.get(e.S_),i=new $p(t);return new Gp(t,i,e.S_,r,new qp(n.hasPendingWrites,n.fromCache),e.v_)}var Yp=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Vl(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=Zp(t,this.zf),i=Rp(r.v_,e,n),o=Ll(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,Ts.Wt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=Zp(t,this.zf);return e instanceof Ei&&(e=e._),o="string"==typeof e||e instanceof cl?Hl(this.wd,"WriteBatch.update",s.S_,e,n,r):zl(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.F_(s.S_,Ts.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=Zp(t,this.zf);return this.fd=this.fd.concat(new qs(e.S_,Ts.Wt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new Ii(wi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Zp(t,e){if(t instanceof Ei&&(t=t._),t.firestore!==e)throw new Ii(wi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var td=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(ii.c)(e,t),e.prototype.get=function(e){var n=this,r=Zp(e,this.zf),i=new $p(this.zf);return t.prototype.get.call(this,e).then(function(t){return new Gp(n.zf,i,r.S_,t.Jf,new qp(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Vl(t)}return t.prototype.get=function(t){var e=this,n=Zp(t,this.zf),r=new Fp(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return fi();var i=t[0];if(i instanceof Oo)return new Ep(e.zf,r,n.S_,null,n.v_);if(i instanceof Io)return new Ep(e.zf,r,i.key,i,n.v_);throw fi()})},t.prototype.set=function(t,e,n){var r=Zp(t,this.zf),i=Rp(r.v_,e,n),o=Ll(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Zp(t,this.zf);return e instanceof Ei&&(e=e._),o="string"==typeof e||e instanceof cl?Hl(this.wd,"Transaction.update",s.S_,e,n,r):zl(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=Zp(t,this.zf);return this.Td.delete(e.S_),this},t}()),ed=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Ip(t=yl(t,yp));var n=gp(t),r=t.p_(),i=new ul;return wp(n,i,new ol(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Ip(t=yl(t,yp));var e=gp(t),n=t.p_(),r=new ul;return wp(e,r,new sl(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Ii(wi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Zu;return t.Mf.Tf(function(){return Object(ii.b)(e,void 0,void 0,function(){var e;return Object(ii.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(ii.b)(this,void 0,void 0,function(){return Object(ii.d)(this,function(e){switch(e.label){case 0:return na.Wn()?[4,na.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Uc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),nd=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Si||(i.md=e),i}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.V_().host&&ci("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(ii.b)(e,void 0,void 0,function(){var e,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:return[4,cp(t)];case 1:return e=r.sent(),[4,fp(t)];case 2:return n=r.sent(),[2,(e.po(!0),function(t){var e=pi(t);return e.Fh.delete(0),Rh(e)}(n))]}})})})}(gp(yl(this._,yp)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(ii.b)(e,void 0,void 0,function(){var e,n;return Object(ii.d)(this,function(r){switch(r.label){case 0:return[4,cp(t)];case 1:return e=r.sent(),[4,fp(t)];case 2:return n=r.sent(),[2,(e.po(!1),function(t){return Object(ii.b)(this,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return(e=pi(t)).Fh.add(0),[4,Fh(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(gp(yl(this._,yp)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&pl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Zu;return t.fs.ys(function(){return Object(ii.b)(e,void 0,void 0,function(){var e;return Object(ii.d)(this,function(r){switch(r.label){case 0:return e=Vf,[4,lp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(gp(yl(this._,yp)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new al(e);return t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){pi(t).jh.add(e),e.next()},[4,pp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var e;return Object(ii.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){pi(t).jh.delete(e)},[4,pp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(gp(t=yl(t,yp)),Up(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new Ii(wi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new vd(this,Tl(this._,t))}catch(t){throw ud(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new sd(this,jl(this._,t))}catch(t){throw ud(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new ld(this,function(t,e){if(t=yl(t,Il),fl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ii(wi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new El(t,null,function(t){return new zo(Ri.at(),t)}(e))}(this._,t))}catch(t){throw ud(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Zu;return t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var n;return Object(ii.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return ap(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new rp(t.fs,n,e,r).run(),[2]}})})}),r.promise}(gp(t),function(n){return e(new td(t,n))})}(this._,function(n){return t(new id(e,n))})},e.prototype.batch=function(){var t=this;return gp(this._),new od(new Yp(this._,function(e){return Qp(t._,e)}))},e.prototype.loadBundle=function(t){throw new Ii(wi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Ii(wi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Ei),rd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ii.c)(e,t),e.prototype.Uf=function(t){return new ji(new Oi(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return sd.Ad(e,this.firestore,null)},e}(Op),id=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(ii.c)(e,t),e.prototype.get=function(t){var e=this,n=bd(t);return this._.get(n).then(function(t){return new hd(e.zf,t)})},e.prototype.set=function(t,e,n){var r=bd(t);return n?(ll("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=bd(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(ii.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=bd(t);return this._.delete(e),this},e}(Ei),od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.set=function(t,e,n){var r=bd(t);return n?(ll("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=bd(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(ii.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=bd(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Ei),sd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new rd(e),r}return Object(ii.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new Ii(wi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Ol(n._,r,new Gi(t)))},e.Ad=function(t,n,r){return new e(n,new Ol(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new vd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new vd(this.firestore,Tl(this._,t))}catch(t){throw ud(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Ei&&(t=t._),t instanceof Ol&&Nl(this._,t)},e.prototype.set=function(t,e){e=ll("DocumentReference.set",e);try{return function(t,e,n){t=yl(t,Ol);var r=yl(t.firestore,yp),i=Rp(t.v_,e,n);return Qp(r,[Ll(Vl(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Ts.Wt())])}(this._,t,e)}catch(t){throw ud(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Jp(this._,t):Jp.apply(void 0,Object(ii.g)([this._,t,e],n))}catch(t){throw ud(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Qp(yl((t=this._).firestore,yp),[new qs(t.S_,Ts.Wt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ad(e),i=cd(e,function(e){return new hd(t.firestore,new Gp(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return Wp(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=yl(t,Ol);var e=yl(t.firestore,yp),n=gp(e),r=new $p(e);return function(t,e){var n=this,r=new Zu;return t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var n;return Object(ii.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i;return Object(ii.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=pi(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Io?n.resolve(i):i instanceof Oo?n.resolve(null):n.reject(new Ii(wi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=fa(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,hp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Gp(e,r,t.S_,n,new qp(n instanceof Io&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=yl(t,Ol);var e=yl(t.firestore,yp);return dp(gp(e),t.S_,{source:"server"}).then(function(n){return Xp(e,t,n)})}(this._):function(t){t=yl(t,Ol);var e=yl(t.firestore,yp);return dp(gp(e),t.S_).then(function(n){return Xp(e,t,n)})}(this._)).then(function(t){return new hd(e.firestore,new Gp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Ei);function ud(t,e,n){return t.message=t.message.replace(e,n),t}function ad(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Up(r))return r}return{}}function cd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Up(t[0])?t[0]:Up(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var hd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new sd(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return Kp(this._,t._)},e}(Ei),fd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(hd),ld=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new rd(e),r}return Object(ii.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Sp(this._,function(t,e,n){var r=e,i=Tp("where",t);return new Ap(i,r,n)}(t,n,r)))}catch(t){throw ud(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Sp(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Tp("orderBy",t);return new Dp(r,n)}(t,n)))}catch(t){throw ud(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Sp(this._,function(t){return gl("limit",t),new Cp("limit",t,"F")}(t)))}catch(t){throw ud(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Sp(this._,function(t){return gl("limitToLast",t),new Cp("limitToLast",t,"L")}(t)))}catch(t){throw ud(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Sp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw ud(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Sp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw ud(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Sp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw ud(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Sp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw ud(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Sl(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=yl(t,El);var e=yl(t.firestore,yp),n=gp(e),r=new $p(e);return function(t,e){var n=this,r=new Zu;return t.fs.ys(function(){return Object(ii.b)(n,void 0,void 0,function(){var n;return Object(ii.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(ii.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(ii.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Yc(t,e,!0)];case 1:return u=a.sent(),r=new Ef(e,u.Pc),i=r.dl(u.documents),o=r.Ti(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=fa(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,hp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new zp(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=yl(t,El);var e=yl(t.firestore,yp),n=gp(e),r=new $p(e);return vp(n,t.C_,{source:"server"}).then(function(n){return new zp(e,r,t,n)})}(this._):function(t){t=yl(t,El);var e=yl(t.firestore,yp),n=gp(e),r=new $p(e);return jp(t.C_),vp(n,t.C_).then(function(n){return new zp(e,r,t,n)})}(this._)).then(function(t){return new dd(e.firestore,new zp(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ad(e),i=cd(e,function(e){return new dd(t.firestore,new zp(t.firestore._,t.Hf,t._,e.ud))});return Wp(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Ei),pd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new fd(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Ei),dd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new ld(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new fd(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new pd(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new fd(n.zf,r))})},e.prototype.isEqual=function(t){return Kp(this._,t._)},e}(Ei),vd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(ii.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new sd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new sd(this.firestore,void 0===t?jl(this._):jl(this._,t))}catch(t){throw ud(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=yl(t.firestore,yp),r=jl(t),i=Rp(t.v_,e);return Qp(n,[Ll(Vl(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Ts.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new sd(e.firestore,t)})},e.prototype.isEqual=function(t){return Nl(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(ld);function bd(t){return t instanceof Ei&&(t=t._),yl(t,Ol)}var yd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(cl.bind.apply(cl,Object(ii.g)([void 0],e))))||this}return Object(ii.c)(e,t),e.documentId=function(){return new e(qi.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Ei&&(t=t._),t instanceof cl&&this._.d_.isEqual(t.d_)},e}(Ei),gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ii.c)(e,t),e.serverTimestamp=function(){var t=new Fl("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Ul("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ql("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Gl("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Bl("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Ei);!function(){function t(){this.Pd={},this.yd=new Zu,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.Wl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var md,wd=n("/6Yf"),Id={Firestore:nd,GeoPoint:Al,Timestamp:Vi,Blob:ji,Transaction:id,WriteBatch:od,DocumentReference:sd,DocumentSnapshot:hd,Query:ld,QueryDocumentSnapshot:fd,QuerySnapshot:dd,CollectionReference:vd,FieldPath:yd,FieldValue:gd,setLogLevel:function(t){oi.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new wd.a("firestore",function(t){return function(t,e){return new nd(t,new yp(t,e),new ed)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Id)))})(md=Z.a),md.registerVersion("@firebase/firestore","2.1.1");var Od=n("Jgta"),Ed=n("UbJi");function _d(t,e){return function(t,e=z.b){return new H.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Td(t,e){return _d(t,e).pipe(Object(J.a)(t=>({payload:t,type:"query"})))}function jd(t,e){return Td(t,e).pipe(Object(J.a)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function Nd(t,e,n){return Td(t,n).pipe(Object(J.a)(t=>t.payload.docChanges()),Object(W.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),Object(J.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Sd(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class Ad{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(J.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(Q.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):jd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(W.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Sd(t);return Nd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Td(this.query,this.afs.schedulers.outsideAngular).pipe(Object(J.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(K.a)(this.query.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new Dd(this.ref.doc(t),this.afs)}}class Dd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=Vd(n,e);return new Ad(r,i,this.afs)}snapshotChanges(){return _d(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(J.a)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(J.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(K.a)(this.ref.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}}class Cd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(J.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(Q.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):jd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(W.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Sd(t);return Nd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Td(this.query,this.afs.schedulers.outsideAngular).pipe(Object(J.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(K.a)(this.query.get(t)).pipe(Object(X.b)(this.afs.schedulers.insideAngular))}}const xd=new s.s("angularfire2.enableFirestorePersistence"),kd=new s.s("angularfire2.firestore.persistenceSettings"),Pd=new s.s("angularfire2.firestore.settings"),Md=new s.s("angularfire2.firestore.use-emulator");function Vd(t,e=(t=>t)){return{query:e(t),ref:t}}let Ld=(()=>{class t{constructor(t,e,n,i,o,s,u,a,c){this.schedulers=new Y.d(s),this.keepUnstableUntilFirst=Object(Y.h)(this.schedulers);const h=Object(Y.g)(t,s,e);!Od.a.auth&&c&&Object(Y.j)();const f=a;[this.firestore,this.persistenceEnabled$]=Object(Y.f)(h.name+".firestore","AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),f&&t.useEmulator(...f),n&&!Object(r.u)(o)){const e=()=>{try{return Object(K.a)(t.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(md){return"undefined"!=typeof console&&console.warn(md),Object($.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object($.a)(!1)]},[i,f,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=Vd(n,e),o=this.schedulers.ngZone.run(()=>r);return new Ad(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new Cd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new Dd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(Y.c),s.Zb(Y.b,8),s.Zb(xd,8),s.Zb(Pd,8),s.Zb(s.D),s.Zb(s.B),s.Zb(kd,8),s.Zb(Md,8),s.Zb(Ed.b,8))},t.\u0275prov=Object(s.Lb)({factory:function(){return new t(Object(s.Zb)(Y.c),Object(s.Zb)(Y.b,8),Object(s.Zb)(xd,8),Object(s.Zb)(Pd,8),Object(s.Zb)(s.D),Object(s.Zb)(s.B),Object(s.Zb)(kd,8),Object(s.Zb)(Md,8),Object(s.Zb)(Ed.b,8))},token:t,providedIn:"any"}),t})(),Ud=(()=>{class t{constructor(t,e){this.afs=t,this.store=e}listenForIssueChanges(){this.readCollectionsOnChanges("issues",t=>{console.log(t.size),t.docChanges().forEach(t=>{console.log(t.type,t.doc.data()),this.updateIssuesStore(t)})},t=>{},()=>{console.log("issue listenered stopped.")})}updateIssuesStore(t){switch(t.type){case"added":case"modified":case"removed":return}}createDocument(t,e){return this.afs.doc(e).set(t)}createDocId(){return this.afs.createId()}updatePartialDocument(t,e){return this.afs.doc(e).update(t.changes)}deleteDocument(t,e="issues"){return this.afs.collection(e).doc(t.id).delete()}readCollections(t,e){const n=this.afs.collection(t);return e?n.ref.where("description",">=",e).get():n.ref.orderBy("dateCreated","desc").get()}readCollectionsOnChanges(t,e,n,r){return this.afs.collection(t).ref.orderBy("dateCreated","desc").onSnapshot(e,n,r)}addNewIssue(t,e){this.store.dispatch(p.g({data:t,url:e}))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(Ld),s.Zb(c.h))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Rd=n("bv9b"),Fd=n("NFeN"),qd=n("MutI"),Gd=n("A5z7"),Bd=n("mrSG"),zd=n("oC0T"),Hd=n.n(zd),Kd=n("WEJZ");let $d=(()=>{class t{transform(t){let e="prior-";switch(t){case Kd.a.Low:e+="low";break;case Kd.a.Medium:e+="medium";break;case Kd.a.High:e+="high"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"priorToCssClass",type:t,pure:!0}),Object(Bd.a)([Hd()()],t.prototype,"transform",null),t})(),Jd=(()=>{class t{transform(t){return t?"issue-open":"issue-closed"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"openToCssClass",type:t,pure:!0}),Object(Bd.a)([Hd()()],t.prototype,"transform",null),t})(),Wd=(()=>{class t{transform(t,e){return t?e?"opened":"open":"closed"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"issueOpenStatusDisplay",type:t,pure:!0}),t})(),Qd=(()=>{class t{transform(t){return t?(t+"").trim().length:0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"getValueCountDisplay",type:t,pure:!0}),t})();var Xd=n("B6IJ");function Yd(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",9),s.cc("click",function(){return s.vc(t),s.gc(2).onEditToggle()}),s.Gc(1),s.hc(2,"async"),s.Ub()}if(2&t){const t=s.gc(2);s.Db(1),s.Ic(" ",s.ic(2,1,t.cs.getIssueEditMode$)?"Cancel edit":"Edit issue"," ")}}function Zd(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Ec(1,Yd,3,3,"button",7),s.Vb(2,"button",8),s.cc("click",function(){return s.vc(t),s.gc().deleteIssue()}),s.Gc(3,"Delete issue"),s.Ub(),s.Sb()}if(2&t){const t=s.gc();s.Db(1),s.mc("ngIf",null==t.issue?null:t.issue.open)}}function tv(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Vb(1,"button",10),s.cc("click",function(){return s.vc(t),s.gc().onOpenCloseToggleIssue()}),s.Gc(2),s.Ub(),s.Sb()}if(2&t){const t=s.gc();s.Db(2),s.Ic(" ",null!=t.issue&&t.issue.open?"Close issue":"Reopen issue"," ")}}function ev(t,e){1&t&&(s.Tb(0),s.Vb(1,"div",11),s.Vb(2,"div",12),s.Qb(3,"mat-progress-bar",13),s.Ub(),s.Ub(),s.Sb())}function nv(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"div",14),s.Vb(2,"div",12),s.Vb(3,"div",15),s.Vb(4,"mat-icon",16),s.hc(5,"priorToCssClass"),s.Gc(6,"error_outline"),s.Ub(),s.Gc(7),s.Vb(8,"span",17),s.Gc(9),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(10,"div",18),s.Vb(11,"div",12),s.Vb(12,"div",19),s.Vb(13,"mat-chip-list",20),s.Vb(14,"mat-chip",21),s.hc(15,"openToCssClass"),s.Gc(16),s.hc(17,"issueOpenStatusDisplay"),s.Ub(),s.Ub(),s.Vb(18,"div",22),s.Gc(19),s.hc(20,"dateDisplay"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Qb(21,"hr"),s.Sb()),2&t){const t=s.gc();s.Db(4),s.Fb(s.ic(5,10,null==t.issue||null==t.issue.priority?null:t.issue.priority.id)),s.mc("title","Priority: "+(null==t.issue||null==t.issue.priority?null:t.issue.priority.display)),s.Db(3),s.Ic(" ",null==t.issue?null:t.issue.title," "),s.Db(2),s.Ic(" #",null==t.issue?null:t.issue.issueNumber," "),s.Db(5),s.Fb(s.ic(15,12,null==t.issue?null:t.issue.open)),s.Db(2),s.Ic(" ",s.jc(17,14,null==t.issue?null:t.issue.open,!1)," "),s.Db(3),s.Jc(" ",null==t.issue?null:t.issue.author," created this issue on ",s.jc(20,17,null==t.issue?null:t.issue.dateCreated,"FULLANDFROMNOW")," ")}}const rv=function(){return["/","issues"]};function iv(t,e){1&t&&(s.Tb(0),s.Vb(1,"div",14),s.Vb(2,"div",23),s.Gc(3," This issue does not exist anymore. "),s.Vb(4,"a",24),s.Gc(5,"Go back"),s.Ub(),s.Ub(),s.Ub(),s.Sb()),2&t&&(s.Db(4),s.mc("routerLink",s.nc(1,rv)))}function ov(t,e){if(1&t&&(s.Ec(0,iv,6,2,"ng-container",3),s.hc(1,"async")),2&t){const t=s.gc();s.mc("ngIf",!s.ic(1,1,t.cs.issueOverallLoading$))}}let sv=(()=>{class t{constructor(t,e,n,r,i,s){this.router=t,this.route=e,this.cs=n,this.store=r,this.crs=i,this.dialog=s,this.compDest$=new o.a,this.issue=void 0,this.editMode=!1}ngOnInit(){F.d("action-row"),this.cs.getIssueBySelectedId$.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.issue=t}),this.route.paramMap.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.cs.setSelectedIssueId(t.get("id"))}),this.cs.getIssueEditMode$.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.editMode=t})}goBackToAll(){this.router.navigate(["/","issues"],{relativeTo:this.route})}onOpenCloseToggleIssue(){var t;if(this.issue){const e=(null===(t=this.issue)||void 0===t?void 0:t.open)?"close":"reopen";this.openConfirmDialog(e).subscribe(t=>{t&&this.issue&&this.cs.toggleOpenCloseIssue(this.issue)})}}openConfirmDialog(t){return this.dialog.open(B,{minWidth:"300px",data:{actionName:t+" this issue?"}}).afterClosed().pipe(Object(R.a)(this.compDest$))}onEditToggle(){this.router.navigate(this.editMode?["./","view"]:["./","edit"],{relativeTo:this.route})}deleteIssue(){this.openConfirmDialog("delete").subscribe(t=>{t&&this.issue&&this.cs.deleteIssue(this.issue,V)})}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(i.f),s.Pb(i.a),s.Pb(L),s.Pb(c.h),s.Pb(Ud),s.Pb(q.b))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-display-detail"]],decls:14,vars:7,consts:[["id","action-row",1,"row","my-3","py-1"],[1,"col-6","col-lg-10"],["type","button",1,"btn","btn-outline-primary","mr-2","mb-2",3,"click"],[4,"ngIf"],[1,"col-6","col-lg-2"],[4,"ngIf","ngIfElse"],["issueDoesNotExist",""],["type","button","class","btn btn-warning mr-2 mb-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","mr-2","mb-2",3,"click"],["type","button",1,"btn","btn-warning","mr-2","mb-2",3,"click"],["type","button",1,"btn","btn-success","float-right",3,"click"],[1,"row","mb-2"],[1,"col-lg-12"],["mode","indeterminate"],[1,"row"],[1,"title"],["mat-list-icon","",3,"title"],[1,"count"],[1,"row","mt-2"],[1,"meta"],[1,"mr-2"],["color","primary","selected",""],[1,"v-center"],[1,"col-lg-12","if","fs-18","f-w-700"],[3,"routerLink"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"div",1),s.Vb(2,"button",2),s.cc("click",function(){return e.goBackToAll()}),s.Gc(3,"Back"),s.Ub(),s.Ec(4,Zd,4,1,"ng-container",3),s.Ub(),s.Vb(5,"div",4),s.Ec(6,tv,3,1,"ng-container",3),s.Ub(),s.Ub(),s.Qb(7,"hr"),s.Ec(8,ev,4,0,"ng-container",3),s.hc(9,"async"),s.Ec(10,nv,22,20,"ng-container",5),s.Qb(11,"router-outlet"),s.Ec(12,ov,2,3,"ng-template",null,6,s.Fc)),2&t){const t=s.sc(13);s.Db(4),s.mc("ngIf",e.issue),s.Db(2),s.mc("ngIf",e.issue),s.Db(2),s.mc("ngIf",s.ic(9,5,e.cs.issueOverallLoading$)),s.Db(2),s.mc("ngIf",e.issue)("ngIfElse",t)}},directives:[r.k,i.j,Rd.a,Fd.a,qd.b,Gd.b,Gd.a,i.h],pipes:[r.b,$d,Jd,Wd,Xd.a],styles:[".action-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.title[_ngcontent-%COMP%]{font-size:32px;font-weight:400;line-height:33px;word-break:break-word}.count[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{min-height:35px}.count[_ngcontent-%COMP%]{color:#6a737d;font-weight:100}.meta[_ngcontent-%COMP%]{font-size:14px;color:#586069;display:flex}.desc[_ngcontent-%COMP%]{font-size:23px}mat-chip.issue-open[_ngcontent-%COMP%]{background-color:#28a745!important}mat-chip.issue-closed[_ngcontent-%COMP%]{background-color:#888!important}p.desc[_ngcontent-%COMP%]{font-size:14px;color:#24292e}"]}),t})();var uv=n("Kj3r"),av=n("/uUt"),cv=n("D7s6"),hv=n("kmnG"),fv=n("qFsG"),lv=n("3Pt+"),pv=n("FKr1"),dv=n("Xa2L");function vv(t,e){1&t&&(s.Vb(0,"div",8),s.Qb(1,"mat-spinner",9),s.Gc(2," Loading... "),s.Ub())}function bv(t,e){if(1&t&&(s.Vb(0,"div",10),s.Gc(1),s.hc(2,"async"),s.hc(3,"dateDisplay"),s.Ub()),2&t){const t=s.gc().ngIf,e=s.gc();s.Db(1),s.Kc(" #",s.ic(2,3,e.cs.getIssueCounterNumber(null==t?null:t.id))," created ",s.jc(3,5,null==t?null:t.dateCreated,"FROMNOW")," by ",null==t?null:t.author," ")}}const yv=function(t,e,n){return{"issue-open":t,"issue-closed":e,"loading-bg":n}};function gv(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Vb(1,"mat-list-item",1),s.Vb(2,"mat-icon",2),s.hc(3,"priorToCssClass"),s.Gc(4,"error_outline"),s.Ub(),s.Vb(5,"div",3),s.Vb(6,"div",4),s.cc("click",function(){return s.vc(t),s.gc().onIssueClick()}),s.Gc(7),s.Ub(),s.Ec(8,vv,3,0,"div",5),s.Ub(),s.Vb(9,"div",6),s.Gc(10),s.Ub(),s.Ec(11,bv,4,8,"div",7),s.Ub(),s.Sb()}if(2&t){const t=e.ngIf;s.Db(1),s.mc("ngClass",s.qc(11,yv,null==t?null:t.open,!(null!=t&&t.open),!(null!=t&&t.created))),s.Db(1),s.Fb(s.ic(3,9,null==t||null==t.priority?null:t.priority.id)),s.mc("title","Priority: "+(null==t||null==t.priority?null:t.priority.display)),s.Db(5),s.Jc(" ",null==t?null:t.title," ",null!=t&&t.created?"":"(creating...)"," "),s.Db(1),s.mc("ngIf",null==t?null:t.loading),s.Db(2),s.Ic(" ",null==t?null:t.description," "),s.Db(1),s.mc("ngIf",null==t?null:t.created)}}let mv=(()=>{class t{constructor(t,e,n){this.cs=t,this.router=e,this.route=n}ngOnInit(){}onIssueClick(){var t,e;(null===(t=this.issue)||void 0===t?void 0:t.id)&&this.router.navigate(["../",null===(e=this.issue)||void 0===e?void 0:e.id],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(L),s.Pb(i.f),s.Pb(i.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-display-issue"]],inputs:{issue:"issue"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"issue-border",3,"ngClass"],["mat-list-icon","",3,"title"],["mat-line","",1,"issue-title"],["mat-line","",1,"text",3,"click"],["class","d-flex",4,"ngIf"],["mat-line","",1,"issue-desc","mb-1"],["mat-line","","class","issue-meta",4,"ngIf"],[1,"d-flex"],["color","primary","diameter","20",1,"mr-2"],["mat-line","",1,"issue-meta"]],template:function(t,e){1&t&&s.Ec(0,gv,12,15,"ng-container",0),2&t&&s.mc("ngIf",e.issue)},directives:[r.k,qd.c,r.i,Fd.a,qd.b,pv.j,dv.b],pipes:[$d,r.b,Xd.a],styles:[".issue-border[_ngcontent-%COMP%]{border-right:1px solid #e1e4e8;border-bottom:1px solid #e1e4e8}.mat-line.issue-desc[_ngcontent-%COMP%]{color:#666;font-size:13px!important;line-height:22px}.mat-line.issue-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;display:flex;justify-content:space-between}.mat-line.issue-meta[_ngcontent-%COMP%]{font-size:13px!important;color:#888}.mat-line.issue-title[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]:hover{cursor:pointer;color:#33f}"]}),t})(),wv=(()=>{class t{constructor(){this.wholePage=!1,this.loading=!0,this.logoShakeState=!1,this.compDest$=new o.a}ngOnChanges(t){this.parentClass=this.wholePage?"whole-page loading-container":"container loading-container mt-5"}ngOnInit(){}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Jb({type:t,selectors:[["app-shared-loading"]],inputs:{wholePage:"wholePage"},features:[s.Bb],decls:13,vars:2,consts:[[1,"row"],[1,"col-sm-12"],[1,"d-flex","loading-parent"],[1,"loading-logo"],["src","assets/banner/resolved2.png","alt","logo",1,"logo-img","d-inline-block"],[1,"lds-facebook"],[1,"d-flex","loading-parent","secfont"]],template:function(t,e){1&t&&(s.Vb(0,"div"),s.Vb(1,"div",0),s.Vb(2,"div",1),s.Vb(3,"div",2),s.Vb(4,"div",3),s.Qb(5,"img",4),s.Ub(),s.Ub(),s.Vb(6,"div",2),s.Vb(7,"div",5),s.Qb(8,"div"),s.Qb(9,"div"),s.Qb(10,"div"),s.Ub(),s.Ub(),s.Vb(11,"div",6),s.Gc(12," Loading... "),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t&&s.Fb(e.parentClass)},styles:[".loading-logo[_ngcontent-%COMP%]{height:3rem}.loading-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.loading-container[_ngcontent-%COMP%], .loading-parent[_ngcontent-%COMP%]{justify-content:center;align-items:center}.loading-container[_ngcontent-%COMP%]{display:flex;height:100%}.whole-page[_ngcontent-%COMP%]{position:fixed;width:100%}.lds-facebook[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;position:absolute;left:8px;width:16px;background:#007bff;animation:lds-facebook 1.2s cubic-bezier(0,.5,.5,1) infinite}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{left:8px;animation-delay:-.24s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:32px;animation-delay:-.12s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:56px;animation-delay:0}@keyframes lds-facebook{0%{top:8px;height:64px}50%,to{top:24px;height:32px}}"]}),t})();function Iv(t,e){if(1&t&&(s.Tb(0),s.Qb(1,"app-core-issue-display-issue",10),s.Sb()),2&t){const t=e.$implicit;s.Db(1),s.mc("issue",t)}}function Ov(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Iv,2,1,"ng-container",9),s.Sb()),2&t){const t=s.gc().ngIf;s.Db(1),s.mc("ngForOf",t)}}function Ev(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Ov,2,1,"ng-container",5),s.Sb()),2&t){const t=e.ngIf;s.gc(2);const n=s.sc(17);s.Db(1),s.mc("ngIf",t&&t.length>0)("ngIfElse",n)}}function _v(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Ev,2,2,"ng-container",8),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("ngIf",s.ic(2,1,t.cs.getAllIssues$))}}const Tv=function(){return["./"]},jv=function(){return{newIssuePane:"open"}};function Nv(t,e){1&t&&(s.Vb(0,"div",11),s.Qb(1,"img",12),s.Ub(),s.Vb(2,"div",13),s.Gc(3," No isses were found. "),s.Ub(),s.Vb(4,"div",14),s.Vb(5,"a",15),s.Gc(6," Would you like to create a new issue? "),s.Ub(),s.Ub()),2&t&&(s.Db(5),s.mc("routerLink",s.nc(2,Tv))("queryParams",s.nc(3,jv)))}function Sv(t,e){1&t&&(s.Vb(0,"div",16),s.Qb(1,"app-shared-loading"),s.Ub())}let Av=(()=>{class t{constructor(t){this.cs=t,this.compDest$=new o.a}ngOnInit(){}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(L))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-display"]],decls:20,vars:13,consts:[[1,"issues-header"],["mat-line","",1,"d-flex"],[1,"open"],[3,"title"],[1,"closed"],[4,"ngIf","ngIfElse"],["noIssuesReturned",""],["issueLoading",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"issue"],[1,"lg-img-parent","mt-5","mb-3"],["src","assets/banner/empty-cb.png","alt","logo",1,"lg-img","d-inline-block"],[1,"no-issues","if","mb-3"],[1,"no-issues","if"],[3,"routerLink","queryParams"],[1,"my-5"]],template:function(t,e){if(1&t&&(s.Vb(0,"mat-list"),s.Vb(1,"mat-list-item",0),s.Vb(2,"div",1),s.Vb(3,"mat-icon",2),s.Gc(4,"error_outline"),s.Ub(),s.Vb(5,"div",3),s.hc(6,"async"),s.Gc(7),s.hc(8,"async"),s.Ub(),s.Vb(9,"mat-icon",4),s.Gc(10,"check_circle_outline"),s.Ub(),s.Vb(11,"div"),s.Gc(12),s.hc(13,"async"),s.Ub(),s.Ub(),s.Ub(),s.Ec(14,_v,3,3,"ng-container",5),s.hc(15,"async"),s.Ub(),s.Ec(16,Nv,7,4,"ng-template",null,6,s.Fc),s.Ec(18,Sv,2,0,"ng-template",null,7,s.Fc)),2&t){const t=s.sc(19);s.Db(5),s.mc("title",s.ic(6,5,e.cs.totalIssueCount$)+" total issues"),s.Db(2),s.Ic(" ",s.ic(8,7,e.cs.openIssueCount$)," Open "),s.Db(5),s.Ic(" ",s.ic(13,9,e.cs.closedIssueCount$)," Closed"),s.Db(2),s.mc("ngIf",!s.ic(15,11,e.cs.issuesRefreshLoading$))("ngIfElse",t)}},directives:[qd.a,qd.c,pv.j,Fd.a,r.k,r.j,mv,i.h,wv],pipes:[r.b],styles:[".issues-header[_ngcontent-%COMP%]{background-color:#f6f8fa;border:1px solid #e1e4e8}.mat-line[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:15px}.mat-line[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px}mat-list-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{border-radius:15px;color:#fff}mat-list-item[_ngcontent-%COMP%]   .mat-icon.open[_ngcontent-%COMP%]{background-color:#28a745}mat-list-item[_ngcontent-%COMP%]   .mat-icon.closed[_ngcontent-%COMP%]{background-color:#888}.no-issues[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:22px;font-weight:400}"]}),t})();function Dv(t){const e=t.value;if(!e||""===(""+e).trim())return{fieldRequired:!0}}function Cv(t){const e=t.value;if(!(e&&""!==(""+e).trim()&&(e+"").trim().length<=256))return{fieldTooLong:!0}}let xv=(()=>{class t{confirm(t){const e=window.confirm(t||"Is it OK?");return Object($.a)(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var kv=n("Wp6s"),Pv=n("ihCf"),Mv=n("QibW");const Vv=["titleInput"];function Lv(t,e){if(1&t){const t=s.Wb();s.Vb(0,"mat-card-header"),s.Qb(1,"div",6),s.Vb(2,"mat-card-title",7),s.Vb(3,"div"),s.Gc(4),s.Ub(),s.Ub(),s.Vb(5,"mat-card-subtitle",8),s.Vb(6,"div"),s.Gc(7),s.Ub(),s.Vb(8,"div"),s.Vb(9,"button",9),s.cc("click",function(){return s.vc(t),s.gc().onIssueCancel()}),s.Gc(10,"Cancel"),s.Ub(),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=s.gc();s.Db(4),s.Ic(" Add Issue ",null!=t.issueFg&&t.issueFg.pristine?"":"*"," "),s.Db(3),s.Ic(" #",t.cos.currentIssueCounter," ")}}function Uv(t,e){if(1&t&&(s.Vb(0,"mat-radio-button",19),s.hc(1,"priorToCssClass"),s.Vb(2,"span",20),s.Gc(3),s.Ub(),s.Ub()),2&t){const t=e.$implicit;s.Fb(s.ic(1,4,t.id)),s.mc("value",t),s.Db(3),s.Hc(t.display)}}function Rv(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"form",10),s.Vb(2,"mat-form-field",11),s.Vb(3,"mat-label"),s.Gc(4,"Title"),s.Ub(),s.Qb(5,"input",12,13),s.Vb(7,"mat-hint",14),s.Gc(8),s.hc(9,"getValueCountDisplay"),s.Ub(),s.Ub(),s.Vb(10,"mat-form-field",15),s.Vb(11,"mat-label"),s.Gc(12,"Description"),s.Ub(),s.Qb(13,"textarea",16),s.Ub(),s.Vb(14,"mat-radio-group",17),s.Ec(15,Uv,4,6,"mat-radio-button",18),s.Ub(),s.Ub(),s.Ub()),2&t){const t=s.gc();s.Db(1),s.mc("formGroup",t.issueFg),s.Db(7),s.Ic("",s.ic(9,5,null==t.titleValue?null:t.titleValue.value)," / 256"),s.Db(5),s.mc("cdkTextareaAutosize",!0)("cdkAutosizeMinRows",3),s.Db(2),s.mc("ngForOf",t.priorityList)}}function Fv(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",9),s.cc("click",function(){return s.vc(t),s.gc().onFormReset()}),s.Gc(1,"Reset"),s.Ub()}}const qv=function(t,e){return{"mat-elevation-z0":t,"mat-elevation-z5":e}};let Gv=(()=>{class t{constructor(t,e,n,r,i,o){this.fb=t,this.cs=e,this.router=n,this.route=r,this.cos=i,this.confirmService=o,this.issueData=void 0,this.isEditMode=!1,this.priorityList=F.a,this.issueFg=void 0,this.createInitIssueFg()}unloadNotification(t){return!!this.changesSaved}get titleValue(){if(this.issueFg&&this.issueFg.get("title"))return this.issueFg.get("title")}get changesSaved(){var t;return null===(t=this.issueFg)||void 0===t?void 0:t.pristine}ngOnChanges(){this.createIssueFg(this.issueData)}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{var t;null===(t=this.titleInput)||void 0===t||t.nativeElement.focus()},300)}createIssueFg(t){if(t){const e=this.priorityList.find(e=>{var n;return e.id===(null===(n=t.priority)||void 0===n?void 0:n.id)});this.issueFg.patchValue(Object.assign(Object.assign({},t),{priority:e}))}}onFormReset(){this.issueData&&this.createIssueFg(this.issueData)}onSubmit(){var t,e,n,r;let i=null===(t=this.issueFg)||void 0===t?void 0:t.value;if(null===(e=this.issueFg)||void 0===e?void 0:e.valid)if(this.isEditMode&&this.issueData){const t={id:null===(n=this.issueData)||void 0===n?void 0:n.id,changes:Object.assign(Object.assign({},i),{loading:!0})};this.cos.editIssue(t,this.issueData)}else{const t=this.createFullIssueObject(i);this.cs.addNewIssue(t,"issues/"+t.id),this.onIssueCancel()}null===(r=this.issueFg)||void 0===r||r.markAsPristine()}createFullIssueObject(t){return Object.assign(Object.assign({},t),{dateCreated:(new Date).getTime(),id:this.cs.createDocId(),open:!0,author:"Tester",reactions:0,created:!1,loading:!0,issueNumber:this.cos.currentIssueCounter})}onIssueCancel(){this.router.navigate(["./"])}createInitIssueFg(){this.issueFg=this.fb.group({title:F.c(null,!1,[Dv,Cv]),description:F.c(null,!1,[Dv]),priority:F.c(this.priorityList[1],!1,[lv.q.required])})}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(lv.d),s.Pb(Ud),s.Pb(i.f),s.Pb(i.a),s.Pb(L),s.Pb(xv))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-creator"]],viewQuery:function(t,e){if(1&t&&s.Lc(Vv,!0),2&t){let t;s.rc(t=s.dc())&&(e.titleInput=t.first)}},hostBindings:function(t,e){1&t&&s.cc("beforeunload",function(t){return e.unloadNotification(t)},!1,s.uc)},inputs:{issueData:"issueData",isEditMode:"isEditMode"},features:[s.Bb],decls:12,vars:17,consts:[[1,"creator-card",3,"ngClass"],[4,"ngIf"],[1,"mt-2"],[1,"actions"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button","class","btn btn-info",3,"click",4,"ngIf"],["mat-card-avatar","",1,"creator-header-image"],[1,"if","f-w-700"],[1,"title-parent"],["type","button",1,"btn","btn-info",3,"click"],[1,"issue-form",3,"formGroup"],[1,"full-w"],["matInput","","placeholder","Add NgRx to app...","formControlName","title"],["titleInput",""],["align","end"],[1,"full-w","mb-2"],["matInput","","placeholder","Install latest NgRx...","cdkTextareaAutosize","","formControlName","description",3,"cdkTextareaAutosize","cdkAutosizeMinRows"],["formControlName","priority",1,"priority-radio"],["color","primary",3,"value","class",4,"ngFor","ngForOf"],["color","primary",3,"value"],[1,"priority-val"]],template:function(t,e){1&t&&(s.Vb(0,"mat-card",0),s.hc(1,"async"),s.hc(2,"async"),s.Ec(3,Lv,11,2,"mat-card-header",1),s.hc(4,"async"),s.Vb(5,"mat-card-content",2),s.Ec(6,Rv,16,7,"div",1),s.Ub(),s.Vb(7,"mat-card-actions",3),s.Vb(8,"button",4),s.cc("click",function(){return e.onSubmit()}),s.Gc(9),s.hc(10,"async"),s.Ub(),s.Ec(11,Fv,2,0,"button",5),s.Ub(),s.Ub()),2&t&&(s.mc("ngClass",s.pc(14,qv,s.ic(1,6,e.cos.getIssueEditMode$),!s.ic(2,8,e.cos.getIssueEditMode$))),s.Db(3),s.mc("ngIf",!s.ic(4,10,e.cos.getIssueEditMode$)),s.Db(3),s.mc("ngIf",e.issueFg),s.Db(2),s.mc("disabled",null==e.issueFg?null:e.issueFg.invalid),s.Db(1),s.Ic(" ",s.ic(10,12,e.cos.getIssueEditMode$)?"Save edits":"Submit new issue"," "),s.Db(2),s.mc("ngIf",!(null!=e.issueFg&&e.issueFg.pristine)))},directives:[kv.a,r.i,r.k,kv.d,kv.b,kv.e,kv.c,kv.h,kv.g,lv.r,lv.n,lv.h,hv.c,hv.g,fv.b,lv.c,lv.m,lv.g,hv.f,Pv.b,Mv.b,r.j,Mv.a],pipes:[r.b,Qd,$d],styles:[".creator-card[_ngcontent-%COMP%]{width:100%}.creator-header-image[_ngcontent-%COMP%]{background-image:url(/assets/banner/resolved2.png);background-size:95%;background-repeat:no-repeat}.issue-form[_ngcontent-%COMP%]{width:100%}.mat-radio-button[_ngcontent-%COMP%] ~ .mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.priority-val[_ngcontent-%COMP%]{font-size:15px;font-weight:700}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:19px}.title-parent[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.btn.btn-info[_ngcontent-%COMP%]{font-family:Roboto}mat-card-subtitle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px}"]}),t})();function Bv(t,e){if(1&t&&(s.Vb(0,"div",8),s.Vb(1,"div",9),s.Qb(2,"app-core-issue-creator",10),s.Ub(),s.Ub()),2&t){const t=s.gc();s.Db(2),s.mc("issueData",t.newIssue)}}function zv(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Vb(3,"p",3),s.Gc(4),s.Ub(),s.Ub(),s.Ub(),s.Sb()),2&t){const t=s.gc();s.Db(4),s.Ic(" ",null==t.issue?null:t.issue.description," ")}}function Hv(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Qb(3,"app-core-issue-creator",3),s.hc(4,"async"),s.Ub(),s.Ub(),s.Sb()),2&t){const t=e.ngIf,n=s.gc();s.Db(3),s.mc("issueData",t)("isEditMode",s.ic(4,2,n.cs.getIssueEditMode$))}}const Kv=[{path:"",component:U,children:[{path:"",redirectTo:"all",pathMatch:"full"},{path:"all",component:(()=>{class t{constructor(t,e,n,r){this.cs=t,this.router=e,this.route=n,this.ims=r,this.compDest$=new o.a,this.showIssueCreatePane=!1,this.newIssue=void 0,this.searchCtrl=F.c(null,!1)}ngOnInit(){this.cs.getQueryParamById$.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.showIssueCreatePane=!!t}),this.searchCtrl.valueChanges.pipe(Object(uv.a)(500),Object(av.a)((t,e)=>t===e),Object(R.a)(this.compDest$)).subscribe(t=>{this.searchForIssues(t)}),this.cs.getUserSearchTerm$.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.searchCtrl.setValue(t,{emitEvent:!1})})}onInputActionClick(){this.searchCtrl.pristine?this.searchForIssues(this.searchCtrl.value):this.searchCtrl.reset()}searchForIssues(t){let e=null;t&&""!==t.trim()&&(e=t.trim()),this.cs.getAllIssues(e)}onNewIssue(){this.router.navigate(["./"],{queryParams:{newIssuePane:"open"}}),this.newIssue=void 0}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(L),s.Pb(i.f),s.Pb(i.a),s.Pb(cv.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-all-issues"]],decls:17,vars:5,consts:[[1,"row","mt-3"],[1,"col-lg-12"],[1,"actions"],["matInput","","placeholder","NgRx upgrade",3,"formControl","keyup.enter"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"],[1,"btn-parent"],["type","button",1,"btn","btn-success",3,"click"],["class","row my-3",4,"ngIf"],[1,"row","my-3"],[1,"offset-lg-1","col-lg-10"],[3,"issueData"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Vb(3,"div"),s.Vb(4,"mat-form-field"),s.Vb(5,"mat-label"),s.Gc(6,"Search issues.."),s.Ub(),s.Vb(7,"input",3),s.cc("keyup.enter",function(){return e.searchForIssues(e.searchCtrl.value)}),s.Ub(),s.Vb(8,"button",4),s.cc("click",function(){return e.onInputActionClick()}),s.Vb(9,"mat-icon"),s.Gc(10),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(11,"div",5),s.Vb(12,"button",6),s.cc("click",function(){return e.onNewIssue()}),s.Gc(13,"New issue"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ec(14,Bv,3,1,"div",7),s.Qb(15,"hr"),s.Qb(16,"app-core-issue-display")),2&t&&(s.Db(3),s.Fb(e.ims.mediaQList.matches?"":"input-parent-min-width"),s.Db(4),s.mc("formControl",e.searchCtrl),s.Db(3),s.Ic(" ",e.searchCtrl.pristine?"search":"clear"," "),s.Db(4),s.mc("ngIf",e.showIssueCreatePane))},directives:[hv.c,hv.g,fv.b,lv.c,lv.m,lv.f,G.a,hv.h,Fd.a,r.k,Av,Gv],styles:[".row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.actions[_ngcontent-%COMP%]   .btn-parent[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-form-field[_ngcontent-%COMP%]{width:100%}.input-parent-min-width[_ngcontent-%COMP%]{min-width:500px}button.issue[_ngcontent-%COMP%]{background-color:#2ea44f;color:#fff}"]}),t})()},{path:":id",component:sv,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:(()=>{class t{constructor(t,e,n,r){this.store=t,this.router=e,this.route=n,this.cs=r,this.compDest$=new o.a,this.issue=void 0}ngOnInit(){this.cs.getIssueBySelectedId$.pipe(Object(R.a)(this.compDest$)).subscribe(t=>{this.issue=t})}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(c.h),s.Pb(i.f),s.Pb(i.a),s.Pb(L))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-detail-view"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[1,"desc"]],template:function(t,e){1&t&&s.Ec(0,zv,5,1,"ng-container",0),2&t&&s.mc("ngIf",e.issue)},directives:[r.k],styles:[""]}),t})()},{path:"edit",component:(()=>{class t{constructor(t){this.cs=t,this.cs.toggleIssueEditMode(!0)}ngOnInit(){}ngOnDestroy(){this.cs.toggleIssueEditMode(!1)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(L))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-core-issue-detail-edit"]],viewQuery:function(t,e){if(1&t&&s.Lc(Gv,!0),2&t){let t;s.rc(t=s.dc())&&(e.issueCreator=t.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[3,"issueData","isEditMode"]],template:function(t,e){1&t&&(s.Ec(0,Hv,5,4,"ng-container",0),s.hc(1,"async")),2&t&&s.mc("ngIf",s.ic(1,1,e.cs.getIssueBySelectedId$))},directives:[r.k,Gv],pipes:[r.b],styles:[""]}),t})(),canDeactivate:[(()=>{class t{constructor(t){this.cs=t}canDeactivate(t,e,n){return!(!t.issueCreator||!t.issueCreator.changesSaved)||this.cs.confirm("There are unsaved changes, would you like to navigate away?")}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(xv))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}]}]}];let $v=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[i.i.forChild(Kv)],i.i]}),t})();var Jv=n("oJm8"),Wv=n("9jGm"),Qv=n("5+tZ"),Xv=n("eIep"),Yv=n("XqQ8"),Zv=n("vkgz"),tb=n("bOdf"),eb=n("25EC"),nb=n("mAmA");const rb=[(()=>{class t{constructor(t,e,n,r){this.actions$=t,this.ts=e,this.cs=n,this.cos=r,this.onAddIssue$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.g),Object(Qv.a)(t=>{const e=t.data,n=t.url;return this.cs.createDocument(e,n).then(t=>{const r=(new Date).getTime();return p.h({data:{id:e.id,changes:{created:!0,loading:!1}},dateFinished:r,url:n})},t=>{console.log("err: ",t);const n=eb.a(t);return p.f({errMsg:n,data:e})})}))),this.onSuccessfullyIssueAdded$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.h),Object(Qv.a)(t=>this.cs.updatePartialDocument(t.data,t.url).then(t=>p.e(),t=>{const e=eb.a(t);return p.d({errorMsg:e})})))),this.onSuccessfullyCleanup$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.e),Object(J.a)(()=>(this.ts.getSnackbar("Issue created successfully"),p.p({url:V,searchTerm:null,showLoadMask:!1}))))),this.loadAllIssues$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.p),Object(Xv.a)(t=>this.cs.readCollections(t.url,t.searchTerm).then(t=>{let e=[];const n=(new Date).getTime();return t.docs.forEach(t=>{e.push(t.data())}),p.q({data:e,updatedTime:n})},t=>{const e=eb.a(t);return p.o({errMsg:e})})))),this.closeAIssue$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.b),Object(Yv.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{open:!1,loading:!0}},"issues/"+e.id).then(t=>p.c({data:e}),t=>{const n=eb.a(t);return p.a({data:e,errMsg:n})})}))),this.closeAIssueSuccess$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.c),Object(Qv.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{loading:!1}},"issues/"+e.id).then(t=>{this.ts.getSnackbar("Issue closed successfully!")},t=>{const e=eb.a(t);this.ts.getError("Error occured closing issue. "+e)})})),{dispatch:!1}),this.openAIssue$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.s),Object(Yv.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{open:!0,loading:!0}},"issues/"+e.id).then(t=>p.t({data:e}),t=>{const n=eb.a(t);return p.r({data:e,errMsg:n})})}))),this.openAIssueSuccess$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.t),Object(Qv.a)(t=>{const e=t.data;return this.cs.updatePartialDocument({id:e.id,changes:{loading:!1}},"issues/"+e.id).then(t=>{this.ts.getSnackbar("Issue reopened successfully!")},t=>{const e=eb.a(t);this.ts.getError("Error occured closing issue. "+e)})})),{dispatch:!1}),this.onFailedCleanup$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.d),Object(Zv.a)(()=>{this.ts.getSnackbar("Error occured creating the issue")})),{dispatch:!1}),this.onDeleteIssue$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.j),Object(Yv.a)(t=>{const e=t.issue;return this.cs.deleteDocument(e,t.url).then(t=>p.k({issue:e}),t=>{const n=eb.a(t);return p.i({issue:e,errMsg:n})})}))),this.onDeleteIssueSuccess$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.k),Object(Zv.a)(t=>{this.ts.getSnackbar("Issue #"+t.issue.issueNumber+" was deleted successfully"),this.cos.goBackToIssuesPage()})),{dispatch:!1}),this.onEditIssue$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.m),Object(tb.a)(t=>{const e=t.issue,n=t.updates;let r={id:t.issue.id,changes:Object.assign(Object.assign({},t.updates.changes),{loading:!1})};return this.cs.updatePartialDocument(r,t.url).then(t=>p.n({issue:n}),t=>{const n=eb.a(t);return p.l({errMsg:n,issue:e})})}))),this.onEditIssueSuccess$=Object(Wv.c)(()=>this.actions$.pipe(Object(Wv.d)(p.n),Object(Zv.a)(t=>{this.ts.getSnackbar("Issue #"+t.issue.changes.issueNumber+" was edited"),this.cos.goToIssueDetailView(t.issue.id)})),{dispatch:!1})}ngrxOnInitEffects(){return p.p({url:V,searchTerm:null,showLoadMask:!0})}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(Wv.a),s.Zb(nb.a),s.Zb(Ud),s.Zb(L))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac}),t})()];var ib=n("37S3"),ob=n("PCNd");let sb=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c]]}),t})(),ub=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c,lv.p,lv.i,Jv.a,c.j.forFeature("issues",I),Wv.b.forFeature(rb),ib.a,ob.a,sb,$v]]}),t})()}}]);