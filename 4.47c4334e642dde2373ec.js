(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{pKmL:function(t,e,n){"use strict";n.r(e),n.d(e,"CoreModule",function(){return $d});var r=n("ofXK"),i=n("tyNb"),o=n("XNiG"),s=n("1G5W"),u=n("fXoL"),a=n("+Rhh"),c=n("99NH"),h=n("l7P3");const f=Object(h.o)("myRouter"),{selectQueryParam:l}=c.b(f),p=Object(h.n)("[Issue Creator/API] Create new issue start",Object(h.s)()),d=Object(h.n)("[Issue Creator/API] Create new issue success",Object(h.s)()),v=Object(h.n)("[Issue Creator/API] Create new issue failed",Object(h.s)()),y=Object(h.n)("[Issue Creator/API] Clean up and set loading to false success"),b=Object(h.n)("[Issue Creator/API] Clean up and set loading to false failed",Object(h.s)()),g=Object(h.n)("[Issue Display/API] Load all issues from database",Object(h.s)());Object(h.n)("[Issue Display/API] Load all issues success",Object(h.s)()),Object(h.n)("[Issue Display/API] Load all issues failed",Object(h.s)());let m=(()=>{class t{constructor(t){this.store=t,this.getQueryParamById$=this.store.select(l("newIssuePane"))}toggleNewIssuePane(t){this.store.dispatch(a.a({open:t}))}getAllIssues(t){this.store.dispatch(g({url:t}))}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(h.h))},t.\u0275prov=u.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var w=n("kmnG"),O=n("qFsG"),I=n("bTqV"),_=n("NFeN");let E=(()=>{class t{constructor(t){this.cs=t,this.compDest$=new o.a}ngOnInit(){this.cs.getAllIssues("issues")}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Ob(m))},t.\u0275cmp=u.Ib({type:t,selectors:[["app-core-issue-display"]],decls:22,vars:0,consts:[[1,"mb-5"]],template:function(t,e){1&t&&(u.Ub(0,"div"),u.Bc(1," List of Issues\n"),u.Tb(),u.Ub(2,"div"),u.Bc(3," List of Issues\n"),u.Tb(),u.Ub(4,"div"),u.Bc(5," List of Issues\n"),u.Tb(),u.Ub(6,"div",0),u.Bc(7," List of Issues\n"),u.Tb(),u.Ub(8,"div",0),u.Bc(9," List of Issues\n"),u.Tb(),u.Ub(10,"div",0),u.Bc(11," List of Issues\n"),u.Tb(),u.Ub(12,"div",0),u.Bc(13," List of Issues\n"),u.Tb(),u.Ub(14,"div"),u.Bc(15," List of Issues\n"),u.Tb(),u.Ub(16,"div"),u.Bc(17," List of Issues\n"),u.Tb(),u.Ub(18,"div"),u.Bc(19," List of Issues\n"),u.Tb(),u.Ub(20,"div"),u.Bc(21," List of Issues\n"),u.Tb())},styles:[""]}),t})();var T=n("3Pt+"),j=function(t){return t.High="High",t.Medium="Medium",t.Low="Low",t}({});function A(t,e,n=[],r=[]){return new T.e({value:t,disabled:e},n,r)}const N=[{id:j.High,display:"High"},{id:j.Medium,display:"Medium"},{id:j.Low,display:"Low"}];var k=n("D0XW"),C=n("HDdC"),x=n("Cfvw"),D=n("LRne"),S=n("lJxs"),P=n("Kqap"),R=n("pLZG"),U=n("pxpQ"),L=n("spgP"),M=n("30Go"),V=n("zIRd"),q=n("q/0M"),F=n("qOnz"),B=function(t,e){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function z(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var G,K="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},W=W||{},Y=K||self;function H(){}function Q(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function X(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var $="closure_uid_"+(1e9*Math.random()>>>0),J=0;function Z(t,e,n){return t.call.apply(t.bind,arguments)}function tt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function et(t,e,n){return(et=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Z:tt).apply(null,arguments)}function nt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function rt(){return Date.now()}function it(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ot(){this.j=this.j,this.i=this.i}ot.prototype.j=!1,ot.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,$)&&t[$]||(t[$]=++J)}(this)},ot.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var st=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ut=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function at(t){return Array.prototype.concat.apply([],arguments)}function ct(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function ht(t){return/^[\s\xa0]*$/.test(t)}var ft,lt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function pt(t,e){return-1!=t.indexOf(e)}function dt(t,e){return t<e?-1:t>e?1:0}t:{var vt=Y.navigator;if(vt){var yt=vt.userAgent;if(yt){ft=yt;break t}}ft=""}function bt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function gt(t){var e={};for(var n in t)e[n]=t[n];return e}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ot(t){return Ot[" "](t),t}Ot[" "]=H;var It,_t,Et=pt(ft,"Opera"),Tt=pt(ft,"Trident")||pt(ft,"MSIE"),jt=pt(ft,"Edge"),At=jt||Tt,Nt=pt(ft,"Gecko")&&!(pt(ft.toLowerCase(),"webkit")&&!pt(ft,"Edge"))&&!(pt(ft,"Trident")||pt(ft,"MSIE"))&&!pt(ft,"Edge"),kt=pt(ft.toLowerCase(),"webkit")&&!pt(ft,"Edge");function Ct(){var t=Y.document;return t?t.documentMode:void 0}t:{var xt="",Dt=(_t=ft,Nt?/rv:([^\);]+)(\)|;)/.exec(_t):jt?/Edge\/([\d\.]+)/.exec(_t):Tt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(_t):kt?/WebKit\/(\S+)/.exec(_t):Et?/(?:Version)[ \/]?(\S+)/.exec(_t):void 0);if(Dt&&(xt=Dt?Dt[1]:""),Tt){var St=Ct();if(null!=St&&St>parseFloat(xt)){It=String(St);break t}}It=xt}var Pt={};function Rt(t){return function(t,e){var n=Pt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=lt(String(It)).split("."),r=lt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=dt(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||dt(0==s[2].length,0==u[2].length)||dt(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var Ut=Y.document&&Tt&&(Ct()||parseInt(It,10))||void 0,Lt=!Tt||9<=Number(Ut),Mt=Tt&&!Rt("9"),Vt=function(){if(!Y.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Y.addEventListener("test",H,e),Y.removeEventListener("test",H,e)}catch(n){}return t}();function qt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Ft(t,e){if(qt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Nt){t:{try{Ot(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Bt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}qt.prototype.b=function(){this.defaultPrevented=!0},it(Ft,qt);var Bt={2:"touch",3:"pen",4:"mouse"};Ft.prototype.b=function(){Ft.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Mt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var zt="closure_listenable_"+(1e6*Math.random()|0),Gt=0;function Kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Gt,this.Y=this.Z=!1}function Wt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Yt(t){this.src=t,this.a={},this.b=0}function Ht(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=st(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Wt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Qt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Yt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Qt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Xt="closure_lm_"+(1e6*Math.random()|0),$t={};function Jt(t,e,n,r,i){if(r&&r.once)return te(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Jt(t,e[o],n,r,i);return null}return n=ae(n),t&&t[zt]?t.va(e,n,X(r)?!!r.capture:!!r,i):Zt(t,e,n,!1,r,i)}function Zt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=X(i)?!!i.capture:!!i;if(s&&!Lt)return null;var u=se(t);if(u||(t[Xt]=u=new Yt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=oe,e=Lt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Vt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(re(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function te(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)te(t,e[o],n,r,i);return null}return n=ae(n),t&&t[zt]?t.wa(e,n,X(r)?!!r.capture:!!r,i):Zt(t,e,n,!0,r,i)}function ee(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ee(t,e[o],n,r,i);else r=X(r)?!!r.capture:!!r,n=ae(n),t&&t[zt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Qt(o=t.a[e],n,r,i))&&(Wt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=se(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Qt(e,n,r,i)),(n=-1<t?e[t]:null)&&ne(n))}function ne(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[zt])Ht(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(re(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=se(e))?(Ht(n,t),0==n.b&&(n.src=null,e[Xt]=null)):Wt(t)}}}function re(t){return t in $t?$t[t]:$t[t]="on"+t}function ie(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&ne(t),n.call(r,e)}function oe(t,e){if(t.Y)return!0;if(!Lt){if(!e)t:{e=["window","event"];for(var n=Y,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ie(t,e=new Ft(e,this))}return ie(t,new Ft(e,this))}function se(t){return(t=t[Xt])instanceof Yt?t:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function ae(t){return"function"==typeof t?t:(t[ue]||(t[ue]=function(e){return t.handleEvent(e)}),t[ue])}function ce(){ot.call(this),this.c=new Yt(this),this.J=this,this.C=null}function he(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new qt(e,t);else if(e instanceof qt)e.target=e.target||t;else{var i=e;wt(e=new qt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=fe(s,r,!0,e)&&i}if(i=fe(s=e.a=t,r,!0,e)&&i,i=fe(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=fe(s=e.a=n[o],r,!1,e)&&i}function fe(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Ht(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}it(ce,ot),ce.prototype[zt]=!0,(G=ce.prototype).addEventListener=function(t,e,n,r){Jt(this,t,e,n,r)},G.removeEventListener=function(t,e,n,r){ee(this,t,e,n,r)},G.G=function(){if(ce.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Wt(n[r]);delete e.a[t],e.b--}}this.C=null},G.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},G.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var le=Y.JSON.stringify;function pe(){this.b=this.a=null}var de,ve=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new be},function(t){t.reset()});function ye(){var t=Oe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function be(){this.next=this.b=this.a=null}function ge(t){Y.setTimeout(function(){throw t},0)}function me(t,e){de||function(){var t=Y.Promise.resolve(void 0);de=function(){t.then(Ie)}}(),we||(de(),we=!0),Oe.add(t,e)}pe.prototype.add=function(t,e){var n=ve.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},be.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},be.prototype.reset=function(){this.next=this.b=this.a=null};var we=!1,Oe=new pe;function Ie(){for(var t;t=ye();){try{t.a.call(t.b)}catch(n){ge(n)}var e=ve;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}we=!1}function _e(t,e){ce.call(this),this.b=t||1,this.a=e||Y,this.f=et(this.Za,this),this.g=rt()}function Ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Te(t,e,n){if("function"==typeof t)n&&(t=et(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=et(t.handleEvent,t)}return 2147483647<Number(e)?-1:Y.setTimeout(t,e||0)}function je(t){t.a=Te(function(){t.a=null,t.c&&(t.c=!1,je(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}it(_e,ce),(G=_e.prototype).aa=!1,G.M=null,G.Za=function(){if(this.aa){var t=rt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),he(this,"tick"),this.aa&&(Ee(this),this.start()))}},G.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=rt())},G.G=function(){_e.X.G.call(this),Ee(this),delete this.a};var Ae=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}B(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:je(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(Y.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(ot);function Ne(t){ot.call(this),this.b=t,this.a={}}it(Ne,ot);var ke=[];function Ce(t,e,n,r){Array.isArray(n)||(n&&(ke[0]=n.toString()),n=ke);for(var i=0;i<n.length;i++){var o=Jt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function xe(t){bt(t.a,function(t,e){this.a.hasOwnProperty(e)&&ne(t)},t),t.a={}}function De(){this.a=!0}function Se(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return le(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}Ne.prototype.G=function(){Ne.X.G.call(this),xe(this)},Ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},De.prototype.info=function(){};var Pe={},Re=null;function Ue(){return Re=Re||new ce}function Le(t){qt.call(this,Pe.Fa,t)}function Me(t){var e=Ue();he(e,new Le(e,t))}function Ve(t,e){qt.call(this,Pe.STAT_EVENT,t),this.stat=e}function qe(t){var e=Ue();he(e,new Ve(e,t))}function Fe(t){qt.call(this,Pe.Ga,t)}function Be(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Y.setTimeout(function(){t()},e)}Pe.Fa="serverreachability",it(Le,qt),Pe.STAT_EVENT="statevent",it(Ve,qt),Pe.Ga="timingevent",it(Fe,qt);var ze={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ge={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ke(){}function We(){}Ke.prototype.a=null;var Ye,He={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Qe(){qt.call(this,"d")}function Xe(){qt.call(this,"c")}function $e(){}function Je(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ne(this),this.P=Ze,this.R=new _e(t=At?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}it(Qe,qt),it(Xe,qt),it($e,Ke),Ye=new $e;var Ze=45e3,tn={},en={};function nn(t,e,n){t.H=1,t.i=Tn(mn(e)),t.j=n,t.I=!0,rn(t,null)}function rn(t,e){t.u=rt(),un(t),t.l=mn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Mn(n.b,"t",r),t.D=0,t.a=Dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ae(et(t.Ca,t,t.a),t.O)),Ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?gt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Me(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function on(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=sn(t,n);if(i==en){4==e&&(t.h=4,qe(14),r=!1),Se(t.c,t.f,null,"[Incomplete Response]");break}if(i==tn){t.h=4,qe(15),Se(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Se(t.c,t.f,i,null),ln(t,i)}4==e&&0==n.length&&(t.h=1,qe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Er(e),e.F=!0,qe(11))):(Se(t.c,t.f,n,"[Invalid Chunked Response]"),fn(t),hn(t))}function sn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?en:(n=Number(e.substring(n,r)),isNaN(n)?tn:(r+=1)+n>e.length?en:(e=e.substr(r,n),t.D=r+n,e))}function un(t){t.T=rt()+t.P,an(t,t.P)}function an(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Be(et(t.Va,t),e)}function cn(t){t.o&&(Y.clearTimeout(t.o),t.o=null)}function hn(t){0==t.g.v||t.A||Ar(t.g,t)}function fn(t){cn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ee(t.R),xe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ln(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Kn(n.b,t)))if(n.I=t.N,!t.C&&Kn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Ip){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;jr(n),vr(n)}_r(n),qe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Be(et(n.Sa,n),6e3));if(1>=Gn(n.b)&&n.ea){try{n.ea()}catch(Ip){}n.ea=void 0}}else kr(n,11)}else if((t.C||n.a==t)&&jr(n),!ht(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(pt(h,"spdy")||pt(h,"quic")||pt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Wn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,En(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=rt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=xr(a,a.C?a.ga:null,a.fa),p.C){Yn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(cn(d),un(d)),a.a=p}else Ir(a);0<n.g.length&&gr(n)}else"stop"!=i[0]&&"close"!=i[0]||kr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?kr(n,7):dr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Me(4)}catch(Ip){}}function pn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Q(t)||"string"==typeof t)ut(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(Q(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(Q(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function dn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof dn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function vn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];yn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)yn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function yn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(G=Je.prototype).setTimeout=function(t){this.P=t},G.Xa=function(t){t=t.target;var e=this.F;e&&3==hr(t)?e.f():this.Ca(t)},G.Ca=function(t){try{if(t==this.a)t:{var e=hr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!At&&!this.a.$())){this.A||4!=e||7==n||Me(8==n||0>=r?3:2),cn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ht(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,qe(12),fn(this),hn(this);break t}Se(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ln(this,a)}this.I?(on(this,e,o),At&&this.b&&3==e&&(Ce(this.J,this.R,"tick",this.Wa),this.R.start())):(Se(this.c,this.f,o,null),ln(this,o)),4==e&&fn(this),this.b&&!this.A&&(4==e?Ar(this.g,this):(this.b=!1,un(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,qe(12)):(this.h=0,qe(13)),fn(this),hn(this)}}}catch(c){}},G.Wa=function(){if(this.a){var t=hr(this.a),e=this.a.$();this.D<e.length&&(cn(this),on(this,t,e),this.b&&4!=t&&un(this))}},G.cancel=function(){this.A=!0,fn(this)},G.Va=function(){this.o=null;var t=rt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Me(3),qe(17)),fn(this),this.h=2,hn(this)):an(this,this.T-t)},(G=dn.prototype).K=function(){vn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},G.L=function(){return vn(this),this.a.concat()},G.get=function(t,e){return yn(this.b,t)?this.b[t]:e},G.set=function(t,e){yn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},G.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var bn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof gn){this.a=void 0!==e?e:t.a,wn(this,t.f),this.j=t.j,On(this,t.c),In(this,t.h),this.g=t.g,e=t.b;var n=new Pn;n.c=e.c,e.a&&(n.a=new dn(e.a),n.b=e.b),_n(this,n),this.i=t.i}else t&&(n=String(t).match(bn))?(this.a=!!e,wn(this,n[1]||"",!0),this.j=jn(n[2]||""),On(this,n[3]||"",!0),In(this,n[4]),this.g=jn(n[5]||"",!0),_n(this,n[6]||"",!0),this.i=jn(n[7]||"")):(this.a=!!e,this.b=new Pn(null,this.a))}function mn(t){return new gn(t)}function wn(t,e,n){t.f=n?jn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function On(t,e,n){t.c=n?jn(e,!0):e}function In(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function _n(t,e,n){e instanceof Pn?(t.b=e,function(t,e){e&&!t.f&&(Rn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Un(this,e),Mn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=An(e,Dn)),t.b=new Pn(e,t.a))}function En(t,e,n){t.b.set(e,n)}function Tn(t){return En(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^rt()).toString(36)),t}function jn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function An(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}gn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(An(e,kn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(An(e,kn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(An(n,"/"==n.charAt(0)?xn:Cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",An(n,Sn)),t.join("")};var kn=/[#\/\?@]/g,Cn=/[#\?:]/g,xn=/[#\?]/g,Dn=/[#\?@]/g,Sn=/#/g;function Pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Rn(t){t.a||(t.a=new dn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Un(t,e){Rn(t),e=Vn(t,e),yn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,yn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&vn(t)))}function Ln(t,e){return Rn(t),e=Vn(t,e),yn(t.a.b,e)}function Mn(t,e,n){Un(t,e),0<n.length&&(t.c=null,t.a.set(Vn(t,e),ct(n)),t.b+=n.length)}function Vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(G=Pn.prototype).add=function(t,e){Rn(this),this.c=null,t=Vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},G.forEach=function(t,e){Rn(this),this.a.forEach(function(n,r){ut(n,function(n){t.call(e,n,r,this)},this)},this)},G.L=function(){Rn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},G.K=function(t){Rn(this);var e=[];if("string"==typeof t)Ln(this,t)&&(e=at(e,this.a.get(Vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=at(e,t[n])}return e},G.set=function(t,e){return Rn(this),this.c=null,Ln(this,t=Vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},G.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},G.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var qn=function(){return function(t,e){this.b=t,this.a=e}}();function Fn(t){this.g=t||Bn,t=Y.PerformanceNavigationTiming?0<(t=Y.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Y.ia&&Y.ia.ya&&Y.ia.ya()&&Y.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Bn=10;function zn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Gn(t){return t.b?1:t.a?t.a.size:0}function Kn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Wn(t,e){t.a?t.a.add(e):t.b=e}function Yn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Hn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=z(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return ct(t.c)}function Qn(){}function Xn(){this.a=new Qn}function $n(t,e,n){var r=n||"";try{pn(t,function(t,n){var i=t;X(t)&&(i=le(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Jn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Fn.prototype.cancel=function(){var t,e;if(this.c=Hn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=z(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Qn.prototype.stringify=function(t){return Y.JSON.stringify(t,void 0)},Qn.prototype.parse=function(t){return Y.JSON.parse(t,void 0)};var Zn=Y.JSON.parse;function tr(t){ce.call(this),this.headers=new dn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=er,this.D=this.F=!1}it(tr,ce);var er="",nr=/^https?$/i,rr=["POST","PUT"];function ir(t){return"content-type"==t.toLowerCase()}function or(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,sr(t),ar(t)}function sr(t){t.u||(t.u=!0,he(t,"complete"),he(t,"error"))}function ur(t){if(t.b&&void 0!==W&&(!t.s[1]||4!=hr(t)||2!=t.W()))if(t.l&&4==hr(t))Te(t.za,0,t);else if(he(t,"readystatechange"),4==hr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(bn)[1]||null;if(!o&&Y.self&&Y.self.location){var s=Y.self.location.protocol;o=s.substr(0,s.length-1)}i=!nr.test(o?o.toLowerCase():"")}e=i}if(e)he(t,"complete"),he(t,"success");else{t.h=6;try{var u=2<hr(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",sr(t)}}finally{ar(t)}}}function ar(t,e){if(t.a){cr(t);var n=t.a,r=t.s[0]?H:null;t.a=null,t.s=null,e||he(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function cr(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(Y.clearTimeout(t.m),t.m=null)}function hr(t){return t.a?t.a.readyState:0}function fr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return bt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):En(t,e,n))}function lr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function pr(t){this.pa=0,this.g=[],this.c=new De,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=lr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=lr("baseRetryDelayMs",5e3,t),this.Ra=lr("retryDelaySeedMs",1e4,t),this.Ma=lr("forwardChannelMaxRetries",2,t),this.ma=lr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Fn(t&&t.concurrentRequestLimit),this.ka=new Xn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function dr(t){if(yr(t),3==t.v){var e=t.R++,n=mn(t.B);En(n,"SID",t.J),En(n,"RID",e),En(n,"TYPE","terminate"),wr(t,n),(e=new Je(t,t.c,e,void 0)).H=2,e.i=Tn(mn(n)),n=!1,Y.navigator&&Y.navigator.sendBeacon&&(n=Y.navigator.sendBeacon(e.i.toString(),"")),!n&&Y.Image&&((new Image).src=e.i,n=!0),n||(e.a=Dr(e.g,null),e.a.ba(e.i)),e.u=rt(),un(e)}Cr(t)}function vr(t){t.a&&(Er(t),t.a.cancel(),t.a=null)}function yr(t){vr(t),t.j&&(Y.clearTimeout(t.j),t.j=null),jr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&Y.clearTimeout(t.h),t.h=null)}function br(t,e){t.g.push(new qn(t.Oa++,e)),3==t.v&&gr(t)}function gr(t){zn(t.b)||t.h||(t.h=!0,me(t.Ba,t),t.u=0)}function mr(t,e){var n;n=e?e.f:t.R++;var r=mn(t.B);En(r,"SID",t.J),En(r,"RID",n),En(r,"AID",t.P),wr(t,r),t.i&&t.l&&fr(r,t.i,t.l),n=new Je(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Or(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Wn(t.b,n),nn(n,r,e)}function wr(t,e){t.f&&pn({},function(t,n){En(e,n,t)})}function Or(t,e,n){n=Math.min(t.g.length,n);var r=t.f?et(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{$n(h,s,"req"+c+"_")}catch(fi){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Ir(t){t.a||t.j||(t.T=1,me(t.Aa,t),t.o=0)}function _r(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Be(et(t.Aa,t),Nr(t,t.o)),t.o++,0))}function Er(t){null!=t.s&&(Y.clearTimeout(t.s),t.s=null)}function Tr(t){t.a=new Je(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=mn(t.la);En(e,"RID","rpc"),En(e,"SID",t.J),En(e,"CI",t.H?"0":"1"),En(e,"AID",t.P),wr(t,e),En(e,"TYPE","xmlhttp"),t.i&&t.l&&fr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Tn(mn(e)),n.j=null,n.I=!0,rn(n,t)}function jr(t){null!=t.m&&(Y.clearTimeout(t.m),t.m=null)}function Ar(t,e){var n=null;if(t.a==e){jr(t),Er(t),t.a=null;var r=2}else{if(!Kn(t.b,e))return;n=e.s,Yn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=rt()-e.u;var i=t.u;he(r=Ue(),new Fe(r,n,e,i)),gr(t)}else Ir(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Gn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Be(et(t.Ba,t,e),Nr(t,t.u)),t.u++,0)))}(t,e)||2==r&&_r(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:kr(t,5);break;case 4:kr(t,10);break;case 3:kr(t,6);break;default:kr(t,2)}}function Nr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function kr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=et(t.Ya,t);n||(n=new gn("//www.google.com/images/cleardot.gif"),Y.location&&"http"==Y.location.protocol||wn(n,"https"),Tn(n)),function(t,e){var n=new De;if(Y.Image){var r=new Image;r.onload=nt(Jn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=nt(Jn,n,r,"TestLoadImage: error",!1,e),r.onabort=nt(Jn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=nt(Jn,n,r,"TestLoadImage: timeout",!1,e),Y.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else qe(2);t.v=0,t.f&&t.f.ra(e),Cr(t),yr(t)}function Cr(t){t.v=0,t.I=-1,t.f&&(0==Hn(t.b).length&&0==t.g.length||(t.b.c.length=0,ct(t.g),t.g.length=0),t.f.qa())}function xr(t,e,n){var r=function(t){return t instanceof gn?mn(t):new gn(t,void 0)}(n);if(""!=r.c)e&&On(r,e+"."+r.c),In(r,r.h);else{var i=Y.location;r=function(t,e,n,r){var i=new gn(null,void 0);return t&&wn(i,t),e&&On(i,e),n&&In(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&bt(t.V,function(t,e){En(r,e,t)}),n=t.na,(e=t.A)&&n&&En(r,e,n),En(r,"VER",t.ha),wr(t,r),r}function Dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new tr(t.Na)).F=t.C,e}function Sr(){}function Pr(){if(Tt&&!(10<=Number(Ut)))throw Error("Environmental error: no available transport.")}function Rr(t,e){ce.call(this),this.a=new pr(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!ht(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ht(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Mr(this)}function Ur(t){Qe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Lr(){Xe.call(this),this.status=1}function Mr(t){this.a=t}(G=tr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:Ye),this.a.onreadystatechange=et(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void or(this,o)}t=n||"";var i=new dn(this.headers);r&&pn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=ir,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=Y.FormData&&t instanceof Y.FormData,!(0<=st(rr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{cr(this),0<this.o&&((this.D=function(t){return Tt&&Rt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=et(this.xa,this)):this.m=Te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){or(this,o)}},G.xa=function(){void 0!==W&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,he(this,"timeout"),this.abort(8))},G.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,he(this,"complete"),he(this,"abort"),ar(this))},G.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ar(this,!0)),tr.X.G.call(this)},G.za=function(){this.j||(this.A||this.l||this.g?ur(this):this.Ua())},G.Ua=function(){ur(this)},G.W=function(){try{return 2<hr(this)?this.a.status:-1}catch(_t){return-1}},G.$=function(){try{return this.a?this.a.responseText:""}catch(_t){return""}},G.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Zn(e)}},G.ua=function(){return this.h},G.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(G=pr.prototype).ha=8,G.v=1,G.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Je(this,this.c,t,void 0),r=this.l;if(this.O&&(r?wt(r=gt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Or(this,n,e),En(i=mn(this.B),"RID",t),En(i,"CVER",22),this.A&&En(i,"X-HTTP-Session-Id",this.A),wr(this,i),this.i&&r&&fr(i,this.i,r),Wn(this.b,n),this.Ia&&En(i,"TYPE","init"),this.da?(En(i,"$req",e),En(i,"SID","null"),n.U=!0,nn(n,i,null)):nn(n,i,e),this.v=2}}else 3==this.v&&(t?mr(this,t):0==this.g.length||zn(this.b)||mr(this))},G.Aa=function(){if(this.j=null,Tr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Be(et(this.Ta,this),t)}},G.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,qe(10),vr(this),Tr(this))},G.Sa=function(){null!=this.m&&(this.m=null,vr(this),_r(this),qe(19))},G.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),qe(2)):(this.c.info("Failed to ping google.com"),qe(1))},(G=Sr.prototype).ta=function(){},G.sa=function(){},G.ra=function(){},G.qa=function(){},G.Ja=function(){},Pr.prototype.a=function(t,e){return new Rr(t,e)},it(Rr,ce),Rr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;qe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=xr(t,null,t.fa),gr(t)},Rr.prototype.close=function(){dr(this.a)},Rr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,br(this.a,e)}else this.l?((e={}).__data__=le(t),br(this.a,e)):br(this.a,t)},Rr.prototype.G=function(){this.a.f=null,delete this.f,dr(this.a),delete this.a,Rr.X.G.call(this)},it(Ur,Qe),it(Lr,Xe),it(Mr,Sr),Mr.prototype.ta=function(){he(this.a,"a")},Mr.prototype.sa=function(t){he(this.a,new Ur(t))},Mr.prototype.ra=function(t){he(this.a,new Lr(t))},Mr.prototype.qa=function(){he(this.a,"b")},Pr.prototype.createWebChannel=Pr.prototype.a,Rr.prototype.send=Rr.prototype.h,Rr.prototype.open=Rr.prototype.g,Rr.prototype.close=Rr.prototype.close,ze.NO_ERROR=0,ze.TIMEOUT=8,ze.HTTP_ERROR=6,Ge.COMPLETE="complete",We.EventType=He,He.OPEN="a",He.CLOSE="b",He.ERROR="c",He.MESSAGE="d",ce.prototype.listen=ce.prototype.va,tr.prototype.listenOnce=tr.prototype.wa,tr.prototype.getLastError=tr.prototype.Qa,tr.prototype.getLastErrorCode=tr.prototype.ua,tr.prototype.getStatus=tr.prototype.W,tr.prototype.getResponseJson=tr.prototype.Pa,tr.prototype.getResponseText=tr.prototype.$,tr.prototype.send=tr.prototype.ba;var Vr=ze,qr=Ge,Fr=Pe,Br=We,zr=tr,Gr=n("/6Yf"),Kr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Wr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Yr=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Yr.UNAUTHENTICATED=new Yr(null),Yr.l=new Yr("google-credentials-uid"),Yr._=new Yr("first-party-uid");var Hr=new q.b("@firebase/firestore");function Qr(){return Hr.logLevel}function Xr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=q.a.DEBUG){var r=e.map(Zr);Hr.debug.apply(Hr,Object(M.g)(["Firestore (8.1.1): "+t],r))}}function $r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=q.a.ERROR){var r=e.map(Zr);Hr.error.apply(Hr,Object(M.g)(["Firestore (8.1.1): "+t],r))}}function Jr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=q.a.WARN){var r=e.map(Zr);Hr.warn.apply(Hr,Object(M.g)(["Firestore (8.1.1): "+t],r))}}function Zr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function ti(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw $r(e),new Error(e)}function ei(t,e){t||ti()}function ni(t,e){return t}var ri={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ii=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(M.c)(e,t),e}(Error),oi=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},si=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(Yr.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),ui=function(){function t(t){var e=this;this.P=null,this.currentUser=Yr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.V!==e?(Xr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ei("string"==typeof n.accessToken),new oi(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return ei(null===t||"string"==typeof t),new Yr(t)},t}(),ai=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Yr._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),ci=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new ai(this.v,this.S))},t.prototype.A=function(t){t(Yr._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function hi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var fi=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=hi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function li(t,e){return t<e?-1:t>e?1:0}function pi(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function di(t){return t+"\0"}var vi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ii(ri.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ii(ri.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ii(ri.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ii(ri.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?li(this.nanoseconds,t.nanoseconds):li(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),yi=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new vi(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),bi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ti(),void 0===n?n=t.length-e:n>t.length-e&&ti(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return this.L(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ii(ri.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.X=function(){return new e([])},e}(bi),mi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return mi.test(t)},e.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.Z(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ii(ri.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new ii(ri.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new ii(ri.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new ii(ri.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}(bi),Oi=function(){function t(t){this.path=t}return t.st=function(e){return new t(gi.Y(e))},t.it=function(e){return new t(gi.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===gi.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return gi.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new gi(e.slice()))},t}();function Ii(t){return null==t}function _i(t){return 0===t&&1/t==-1/0}function Ei(t){return"number"==typeof t&&Number.isInteger(t)&&!_i(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ti=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ti(t,e,n,r,i,o,s)}function Ai(t){var e=ni(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.J()+t.op.toString()+_o(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.J()+t.dir}(t)}).join(","),Ii(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Tu(e.startAt)),e.endAt&&(n+="|ub:",n+=Tu(e.endAt)),e.ut=n}return e.ut}function Ni(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Cu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!mo(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Au(t.startAt,e.startAt)&&Au(t.endAt,e.endAt)}function ki(t){return Oi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ci=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.at)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return li(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();Ci.lt=new Ci("");var xi,Di,Si=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=yi.min()),void 0===o&&(o=yi.min()),void 0===s&&(s=Ci.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),Pi=function(t){this.count=t};function Ri(t){switch(t){case ri.OK:return ti();case ri.CANCELLED:case ri.UNKNOWN:case ri.DEADLINE_EXCEEDED:case ri.RESOURCE_EXHAUSTED:case ri.INTERNAL:case ri.UNAVAILABLE:case ri.UNAUTHENTICATED:return!1;case ri.INVALID_ARGUMENT:case ri.NOT_FOUND:case ri.ALREADY_EXISTS:case ri.PERMISSION_DENIED:case ri.FAILED_PRECONDITION:case ri.ABORTED:case ri.OUT_OF_RANGE:case ri.UNIMPLEMENTED:case ri.DATA_LOSS:return!0;default:return ti()}}function Ui(t){if(void 0===t)return $r("GRPC error has no .code"),ri.UNKNOWN;switch(t){case xi.OK:return ri.OK;case xi.CANCELLED:return ri.CANCELLED;case xi.UNKNOWN:return ri.UNKNOWN;case xi.DEADLINE_EXCEEDED:return ri.DEADLINE_EXCEEDED;case xi.RESOURCE_EXHAUSTED:return ri.RESOURCE_EXHAUSTED;case xi.INTERNAL:return ri.INTERNAL;case xi.UNAVAILABLE:return ri.UNAVAILABLE;case xi.UNAUTHENTICATED:return ri.UNAUTHENTICATED;case xi.INVALID_ARGUMENT:return ri.INVALID_ARGUMENT;case xi.NOT_FOUND:return ri.NOT_FOUND;case xi.ALREADY_EXISTS:return ri.ALREADY_EXISTS;case xi.PERMISSION_DENIED:return ri.PERMISSION_DENIED;case xi.FAILED_PRECONDITION:return ri.FAILED_PRECONDITION;case xi.ABORTED:return ri.ABORTED;case xi.OUT_OF_RANGE:return ri.OUT_OF_RANGE;case xi.UNIMPLEMENTED:return ri.UNIMPLEMENTED;case xi.DATA_LOSS:return ri.DATA_LOSS;default:return ti()}}(Di=xi||(xi={}))[Di.OK=0]="OK",Di[Di.CANCELLED=1]="CANCELLED",Di[Di.UNKNOWN=2]="UNKNOWN",Di[Di.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Di[Di.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Di[Di.NOT_FOUND=5]="NOT_FOUND",Di[Di.ALREADY_EXISTS=6]="ALREADY_EXISTS",Di[Di.PERMISSION_DENIED=7]="PERMISSION_DENIED",Di[Di.UNAUTHENTICATED=16]="UNAUTHENTICATED",Di[Di.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Di[Di.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Di[Di.ABORTED=10]="ABORTED",Di[Di.OUT_OF_RANGE=11]="OUT_OF_RANGE",Di[Di.UNIMPLEMENTED=12]="UNIMPLEMENTED",Di[Di.INTERNAL=13]="INTERNAL",Di[Di.UNAVAILABLE=14]="UNAVAILABLE",Di[Di.DATA_LOSS=15]="DATA_LOSS";var Li=function(){function t(t,e){this.$=t,this.root=e||Vi.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,Vi.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,Vi.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Pt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new Mi(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new Mi(this.root,t,this.$,!1)},t.prototype.vt=function(){return new Mi(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new Mi(this.root,t,this.$,!0)},t}(),Mi=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),Vi=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw ti();if(this.right.Mt())throw ti();var t=this.left.Qt();if(t!==this.right.Qt())throw ti();return t+(this.Mt()?0:1)},t}();Vi.EMPTY=null,Vi.RED=!0,Vi.It=!1,Vi.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ti()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ti()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new Vi(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var qi=function(){function t(t){this.$=t,this.data=new Li(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt(function(e,n){return t(e),!1})},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new Fi(this.data.yt())},t.prototype.Vt=function(t){return new Fi(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),Fi=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),Bi=new Li(Oi.$);function zi(){return Bi}function Gi(){return zi()}var Ki=new Li(Oi.$);function Wi(){return Ki}var Yi=new Li(Oi.$),Hi=new qi(Oi.$);function Qi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Xi=new qi(li);function $i(){return Xi}var Ji=function(){function t(t){this.$=t?function(e,n){return t(e,n)||Oi.$(e.key,n.key)}:function(t,e){return Oi.$(t.key,e.key)},this.Ht=Wi(),this.Jt=new Li(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),Zi=function(){function t(){this.Xt=new Li(Oi.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):ti():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt(function(e,n){t.push(n)}),t},t}(),to=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}return t.ie=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Ji.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&hu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),eo=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,no.he(e,n)),new t(yi.min(),r,$i(),zi(),Qi())},t}(),no=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(Ci.lt,n,Qi(),Qi(),Qi())},t}(),ro=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},io=function(t,e){this.targetId=t,this.Te=e},oo=function(t,e,n,r){void 0===n&&(n=Ci.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},so=function(){function t(){this.Ie=0,this.me=co(),this.Ae=Ci.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=Qi(),e=Qi(),n=Qi();return this.me.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ti()}}),new no(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=co()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),uo=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=zi(),this.Me=ao(),this.ke=new qi(li)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof Xs?this.Le(r,t.Ee):t.Ee instanceof $s&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Be(o[i],t.key,t.Ee)},t.prototype.qe=function(t){var e=this;this.Ue(t,function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:ti()}})},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach(function(t,r){n.Ke(r)&&e(r)})},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(ki(i))if(0===n){var o=new Oi(i.path);this.Be(e,o,new $s(o,yi.min()))}else ei(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach(function(r,i){var o=e.Ge(i);if(o){if(r.le&&ki(o.target)){var s=new Oi(o.target.path);null!==e.Oe.get(s)||e.Je(i,s)||e.Be(i,s,new $s(s,t))}r.ye&&(n.set(i,r.pe()),r.ve())}});var r=Qi();this.Me.forEach(function(t,n){var i=!0;n.Wt(function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)}),i&&(r=r.add(t))});var i=new eo(t,n,this.ke,this.Oe,r);return this.Oe=zi(),this.Me=ao(),this.ke=new qi(li),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new so,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new qi(li),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Xr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new so),this.xe.Xe(t).forEach(function(n){e.Be(t,n,null)})},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function ao(){return new Li(Oi.$)}function co(){return new Li(Oi.$)}function ho(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vo(t){var e=t.mapValue.fields.__previous_value__;return po(e)?vo(e):e}function yo(t){var e=To(t.mapValue.fields.__local_write_time__.timestampValue);return new vi(e.seconds,e.nanos)}var bo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:ti()}function mo(t,e){var n=go(t);if(n!==go(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return yo(t).isEqual(yo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=To(t.timestampValue),r=To(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ao(t.bytesValue).isEqual(Ao(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return jo(t.geoPointValue.latitude)===jo(e.geoPointValue.latitude)&&jo(t.geoPointValue.longitude)===jo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return jo(t.integerValue)===jo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=jo(t.doubleValue),r=jo(e.doubleValue);return n===r?_i(n)===_i(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return pi(t.arrayValue.values||[],e.arrayValue.values||[],mo);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ho(n)!==ho(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!mo(n[i],r[i])))return!1;return!0}(t,e);default:return ti()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function Oo(t,e){var n=go(t),r=go(e);if(n!==r)return li(n,r);switch(n){case 0:return 0;case 1:return li(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=jo(t.integerValue||t.doubleValue),r=jo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(yo(t),yo(e));case 5:return li(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ao(t),r=Ao(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=li(n[i],r[i]);if(0!==o)return o}return li(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=li(jo(t.latitude),jo(e.latitude));return 0!==n?n:li(jo(t.longitude),jo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Oo(n[i],r[i]);if(o)return o}return li(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=li(r[s],o[s]);if(0!==u)return u;var a=Oo(n[r[s]],i[o[s]]);if(0!==a)return a}return li(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ti()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return li(t,e);var n=To(t),r=To(e),i=li(n.seconds,r.seconds);return 0!==i?i:li(n.nanos,r.nanos)}function _o(t){return Eo(t)}function Eo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=To(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ao(t.bytesValue).toBase64():"referenceValue"in t?Oi.it(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Eo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Eo(t.fields[o])}return e+"}"}(t.mapValue):ti();var e}function To(t){if(ei(!!t),"string"==typeof t){var e=0,n=bo.exec(t);if(ei(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:jo(t.seconds),nanos:jo(t.nanos)}}function jo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Ci.fromBase64String(t):Ci.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function ko(t){return!!t&&"integerValue"in t}function Co(t){return!!t&&"arrayValue"in t}function xo(t){return!!t&&"nullValue"in t}function Do(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function So(t){return!!t&&"mapValue"in t}var Po={asc:"ASCENDING",desc:"DESCENDING"},Ro={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uo=function(t,e){this.t=t,this.tn=e};function Lo(t){return{integerValue:""+t}}function Mo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_i(e)?"-0":e}}function Vo(t,e){return Ei(e)?Lo(e):Mo(t,e)}function qo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fo(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Bo(t,e){return qo(t,e.M())}function zo(t){return ei(!!t),yi.N(function(t){var e=To(t);return new vi(e.seconds,e.nanos)}(t))}function Go(t,e){return function(t){return new gi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function Ko(t){var e=gi.Y(t);return ei(ds(e)),e}function Wo(t,e){return Go(t.t,e.path)}function Yo(t,e){var n=Ko(e);if(n.get(1)!==t.t.projectId)throw new ii(ri.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new ii(ri.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Oi($o(n))}function Ho(t,e){return Go(t.t,e)}function Qo(t){var e=Ko(t);return 4===e.length?gi.X():$o(e)}function Xo(t){return new gi(["projects",t.t.projectId,"databases",t.t.database]).J()}function $o(t){return ei(t.length>4&&"documents"===t.get(4)),t.B(5)}function Jo(t,e,n){return{name:Wo(t,e),fields:n.proto.mapValue.fields}}function Zo(t,e){var n;if(e instanceof Ms)n={update:Jo(t,e.key,e.value)};else if(e instanceof Gs)n={delete:Wo(t,e.key)};else if(e instanceof Vs)n={update:Jo(t,e.key,e.data),updateMask:ps(e.en)};else if(e instanceof Fs)n={transform:{document:Wo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof ms)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof ws)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof Is)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof Es)return{fieldPath:e.field.J(),increment:n.nn};throw ti()}(0,t)})}};else{if(!(e instanceof Ks))return ti();n={verify:Wo(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Bo(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ti()}(t,e.rn)),n}function ts(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Cs.updateTime(zo(t.updateTime)):void 0!==t.exists?Cs.exists(t.exists):Cs.on()}(e.currentDocument):Cs.on();if(e.update){var r=Yo(t,e.update.name),i=new Ws({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new As((t.fieldPaths||[]).map(function(t){return wi.nt(t)}))}(e.updateMask);return new Vs(r,i,o,n)}return new Ms(r,i,n)}if(e.delete){var s=Yo(t,e.delete);return new Gs(s,n)}if(e.transform){var u=Yo(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(ei("REQUEST_TIME"===e.setToServerValue),n=new ms):"appendMissingElements"in e?n=new ws(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Is(e.removeAllFromArray.values||[]):"increment"in e?n=new Es(t,e.increment):ti();var r=wi.nt(e.fieldPath);return new Ns(r,n)}(t,e)});return ei(!0===n.exists),new Fs(u,a)}if(e.verify){var c=Yo(t,e.verify);return new Ks(c,n)}return ti()}function es(t,e){return{documents:[Ho(t,e.path)]}}function ns(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ho(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ho(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(xo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Do(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(xo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:as(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:cs(t.field),direction:us(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.tn||Ii(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=os(e.startAt)),e.endAt&&(n.structuredQuery.endAt=os(e.endAt)),n}function rs(t){var e=Qo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ei(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=is(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Nu(hs(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return Ii(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ss(n.startAt));var h=null;return n.endAt&&(h=ss(n.endAt)),tu(e,i,u,s,a,"F",c,h)}function is(t){return t?void 0!==t.unaryFilter?[ls(t)]:void 0!==t.fieldFilter?[fs(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return is(t)}).reduce(function(t,e){return t.concat(e)}):ti():[]}function os(t){return{before:t.before,values:t.position}}function ss(t){return new Eu(t.values||[],!!t.before)}function us(t){return Po[t]}function as(t){return Ro[t]}function cs(t){return{fieldPath:t.J()}}function hs(t){return wi.nt(t.fieldPath)}function fs(t){return vu.create(hs(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ti()}}(t.fieldFilter.op),t.fieldFilter.value)}function ls(t){switch(t.unaryFilter.op){case"IS_NAN":var e=hs(t.unaryFilter.field);return vu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=hs(t.unaryFilter.field);return vu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=hs(t.unaryFilter.field);return vu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=hs(t.unaryFilter.field);return vu.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ti()}}function ps(t){var e=[];return t.fields.forEach(function(t){return e.push(t.J())}),{fieldPaths:e}}function ds(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var vs=function(){this.cn=void 0};function ys(t,e,n){return t instanceof ms?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ws?Os(t,e):t instanceof Is?_s(t,e):function(t,e){var n=gs(t,e),r=Ts(n)+Ts(t.nn);return ko(n)&&ko(t.nn)?Lo(r):Mo(t.serializer,r)}(t,e)}function bs(t,e,n){return t instanceof ws?Os(t,e):t instanceof Is?_s(t,e):n}function gs(t,e){return t instanceof Es?ko(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ms=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e}(vs),ws=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(M.c)(e,t),e}(vs);function Os(t,e){for(var n=js(e),r=function(t){n.some(function(e){return mo(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Is=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(M.c)(e,t),e}(vs);function _s(t,e){for(var n=js(e),r=function(t){n=n.filter(function(e){return!mo(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Es=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return Object(M.c)(e,t),e}(vs);function Ts(t){return jo(t.integerValue||t.doubleValue)}function js(t){return Co(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var As=function(){function t(t){this.fields=t,t.sort(wi.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return pi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Ns=function(t,e){this.field=t,this.transform=e},ks=function(t,e){this.version=t,this.transformResults=e},Cs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function xs(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}var Ds=function(){};function Ss(t,e,n){return t instanceof Ms?function(t,e,n){return new Xs(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Vs?function(t,e,n){if(!xs(t.rn,e))return new Js(t.key,n.version);var r=qs(t,e);return new Xs(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Fs?function(t,e,n){if(ei(null!=n.transformResults),!xs(t.rn,e))return new Js(t.key,n.version);var r=Bs(0,e),i=function(t,e,n){var r=[];ei(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Xs&&(u=e.field(o.field)),r.push(bs(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=zs(t,r.data(),i);return new Xs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new $s(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Ps(t,e,n,r){return t instanceof Ms?function(t,e){if(!xs(t.rn,e))return e;var n=Ls(e);return new Xs(t.key,n,t.value,{an:!0})}(t,e):t instanceof Vs?function(t,e){if(!xs(t.rn,e))return e;var n=Ls(e),r=qs(t,e);return new Xs(t.key,n,r,{an:!0})}(t,e):t instanceof Fs?function(t,e,n,r){if(!xs(t.rn,e))return e;var i=Bs(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Xs&&(c=n.field(u.field)),null===c&&r instanceof Xs&&(c=r.field(u.field)),i.push(ys(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=zs(t,i.data(),o);return new Xs(t.key,i.version,s,{an:!0})}(t,e,r,n):function(t,e){return xs(t.rn,e)?new $s(t.key,yi.min()):e}(t,e)}function Rs(t,e){return t instanceof Fs?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Xs?e.field(o.field):void 0,u=gs(o.transform,s||null);null!=u&&(n=null==n?(new Ys).set(o.field,u):n.set(o.field,u))}return n?n.hn():null}(t,e):null}function Us(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||pi(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ws&&e instanceof ws||t instanceof Is&&e instanceof Is?pi(t.elements,e.elements,mo):t instanceof Es&&e instanceof Es?mo(t.nn,e.nn):t instanceof ms&&e instanceof ms}(t.transform,e.transform)}(t,e)}))}function Ls(t){return t instanceof Xs?t.version:yi.min()}var Ms=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return Object(M.c)(e,t),e}(Ds),Vs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return Object(M.c)(e,t),e}(Ds);function qs(t,e){return function(t,e){var n=new Ys(e);return t.en.fields.forEach(function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,e instanceof Xs?e.data():Ws.empty())}var Fs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=Cs.exists(!0),r}return Object(M.c)(e,t),e}(Ds);function Bs(t,e){return e}function zs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.hn()}var Gs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return Object(M.c)(e,t),e}(Ds),Ks=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return Object(M.c)(e,t),e}(Ds),Ws=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!So(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return mo(this.proto,t.proto)},t}(),Ys=function(){function t(t){void 0===t&&(t=Ws.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===go(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(wi.X(),this._n);return null!=t?new Ws(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=So(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.dn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Hs(t){var e=[];return fo(t.fields||{},function(t,n){var r=new wi([t]);if(So(n)){var i=Hs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new As(e)}var Qs=function(t,e){this.key=t,this.version=e},Xs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(M.c)(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Qs),$s=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(M.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Qs),Js=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Qs),Zs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null};function tu(t,e,n,r,i,o,s,u){return new Zs(t,e,n,r,i,o,s,u)}function eu(t){return new Zs(t)}function nu(t){return!Ii(t.limit)&&"F"===t.limitType}function ru(t){return!Ii(t.limit)&&"L"===t.limitType}function iu(t){return t.Tn.length>0?t.Tn[0].field:null}function ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function su(t){return null!==t.collectionGroup}function uu(t){var e=ni(t);if(null===e.In){e.In=[];var n=ou(e),r=iu(e);if(null!==n&&null===r)n.tt()||e.In.push(new Nu(n)),e.In.push(new Nu(wi.et(),"asc"));else{for(var i=!1,o=0,s=e.Tn;o<s.length;o++){var u=s[o];e.In.push(u),u.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new Nu(wi.et(),a))}}}return e.In}function au(t){var e=ni(t);if(!e.mn)if("F"===e.limitType)e.mn=ji(e.path,e.collectionGroup,uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=uu(e);r<i.length;r++){var o=i[r];n.push(new Nu(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Eu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Eu(e.startAt.position,!e.startAt.before):null;e.mn=ji(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.mn}function cu(t,e,n){return new Zs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hu(t,e){return Ni(au(t),au(e))&&t.limitType===e.limitType}function fu(t){return Ai(au(t))+"|lt:"+t.limitType}function lu(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.J()+" "+e.op+" "+_o(e.value);var e}).join(", ")+"]"),Ii(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Tu(t.startAt)),t.endAt&&(e+=", endAt: "+Tu(t.endAt)),"Target("+e+")"}(au(t))+"; limitType="+t.limitType+")"}function pu(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):Oi.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ju(t.startAt,uu(t),e)||t.endAt&&ju(t.endAt,uu(t),e))}(t,e)}function du(t){return function(e,n){for(var r=!1,i=0,o=uu(t);i<o.length;i++){var s=o[i],u=ku(s,e,n);if(0!==u)return u;r=r||s.field.tt()}return 0}}var vu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(M.c)(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new yu(t,n,r):"array-contains"===n?new wu(t,r):"in"===n?new Ou(t,r):"not-in"===n?new Iu(t,r):"array-contains-any"===n?new _u(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new bu(t,n):new gu(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(Oo(e,this.value)):null!==e&&go(this.value)===go(e)&&this.Pn(Oo(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ti()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),yu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Oi.it(r.referenceValue),i}return Object(M.c)(e,t),e.prototype.matches=function(t){var e=Oi.$(t.key,this.key);return this.Pn(e)},e}(vu),bu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=mu(0,n),r}return Object(M.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(vu),gu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=mu(0,n),r}return Object(M.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(vu);function mu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Oi.it(t.referenceValue)})}var wu=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(M.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Co(e)&&wo(e.arrayValue,this.value)},e}(vu),Ou=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(M.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&wo(this.value.arrayValue,e)},e}(vu),Iu=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(M.c)(e,t),e.prototype.matches=function(t){if(wo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!wo(this.value.arrayValue,e)},e}(vu),_u=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(M.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Co(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},e}(vu),Eu=function(t,e){this.position=t,this.before=e};function Tu(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return _o(t)}).join(",")}function ju(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.tt()?Oi.$(Oi.it(s.referenceValue),n.key):Oo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Au(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var Nu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ku(t,e,n){var r=t.field.tt()?Oi.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Oo(r,i):ti()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ti()}}function Cu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var xu=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ss(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Qi())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&pi(this.mutations,t.mutations,function(t,e){return Us(t,e)})&&pi(this.baseMutations,t.baseMutations,function(t,e){return Us(t,e)})},t}(),Du=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){ei(e.mutations.length===r.length);for(var i=Yi,o=e.mutations,s=0;s<o.length;s++)i=i.Tt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Su=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.Cn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){fo(this.Nn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.W=function(){return lo(this.Nn)},t}(),Pu=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&ti(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t(function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}})},t.prototype.Ln=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn(function(){return e(n)}):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.qn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.qn(r)},t}(),Ru=function(){function t(){this.Qn=new Su(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:yi.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?Pu.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),Uu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};function Lu(t){return new Uo(t,!0)}function Mu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Vu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qu=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach(function(t){return t()})},t}(),Fu=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next(function(r){return n.hs(t,e,r)})},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t})},t.prototype.ls=function(t,e,n){var r=Gi();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)}),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next(function(e){return n.fs(t,e)})},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next(function(r){var i=n.ls(t,e,r),o=zi();return i.forEach(function(t,e){e||(e=new $s(t,yi.min())),o=o.Tt(t,e)}),o})},t.prototype.ws=function(t,e,n){return function(t){return Oi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):su(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new Oi(e)).next(function(t){var e=Wi();return t instanceof Xs&&(e=e.Tt(t.key,t)),e})},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=Wi();return this.os.As(t,i).next(function(s){return Pu.forEach(s,function(s){var u=function(t,e){return new Zs(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Is(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Tt(t,e)})})}).next(function(){return o})})},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next(function(n){return r=n,o.rs.Rs(t,e)}).next(function(e){return o.Ps(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=Ps(a,h,h,o.gn);r=f instanceof Xs?r.Tt(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){pu(e,n)||(r=r.remove(t))}),r})},t.prototype.Ps=function(t,e,n){for(var r=Qi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(c=c.Tt(t,e))}),c})},t}(),Bu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=Qi(),i=Qi(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),zu=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();zu.Ds=-1;var Gu=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&Xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),Ku=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js(Object(F.g)())&&$r("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Xr("SimpleDb","Removing database:",t),$u(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=Object(F.g)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return Object(M.b)(this,void 0,void 0,function(){var e,n=this;return Object(M.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Yu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new ii(ri.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Yu(t,n))},i.onupgradeneeded=function(t){Xr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Ws.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Xr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}})})},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(M.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(M.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(M.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Xs(t)];case 2:return u.db=f.sent(),e=Qu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Pu.reject(t)}).Ln(),a={},s.catch(function(){}),[4,e.ei];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return Xr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Wu=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return $u(this.ni.delete())},t}(),Yu=function(t){function e(e,n){var r=this;return(r=t.call(this,ri.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(M.c)(e,t),e}(ii);function Hu(t){return"IndexedDbTransactionError"===t.name}var Qu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new Uu,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new Yu(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=Zu(e.target.error);n.ci.reject(new Yu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Yu(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Xu(e)},t}(),Xu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Xr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),$u(n)},t.prototype.add=function(t){return Xr("SimpleDb","ADD",this.store.name,t,t),$u(this.store.add(t))},t.prototype.get=function(t){var e=this;return $u(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Xr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Xr("SimpleDb","DELETE",this.store.name,t),$u(this.store.delete(t))},t.prototype.count=function(){return Xr("SimpleDb","COUNT",this.store.name),$u(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.hi=function(t,e){Xr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,function(t,e,n){return n.delete()})},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new Pu(function(n,r){e.onerror=function(t){var e=Zu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ai=function(t,e){var n=[];return new Pu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Wu(i),s=e(i.primaryKey,i.value,o);if(s instanceof Pu){var u=s.catch(function(t){return o.done(),Pu.reject(t)});n.push(u)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}}).next(function(){return Pu.qn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function $u(t){return new Pu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Zu(t.target.error);n(e)}})}var Ju=!1;function Zu(t){var e=Ku.js(Object(F.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ii("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ju||(Ju=!0,setTimeout(function(){throw r},0)),r}}return t}function ta(){return"undefined"!=typeof window?window:null}function ea(){return"undefined"!=typeof document?document:null}var na=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new Uu,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}return t.Ii=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new ii(ri.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri(function(){return null!==t.mi?(t.clearTimeout(),t.op().then(function(e){return t.Ti.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),ra=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Gu(this,"async_queue_retry"),this.Di=function(){var e=ea();e&&Xr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=ea();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=ea();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},t.prototype.ki=function(){return Object(M.b)(this,void 0,void 0,function(){var t,e=this;return Object(M.d)(this,function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Hu(t=n.sent()))throw t;return Xr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs(function(){return e.ki()}),n.label=5;case 5:return[2]}})})},t.prototype.Fi=function(t){var e=this,n=this.Pi.then(function(){return e.vi=!0,t().catch(function(t){throw e.pi=t,e.vi=!1,$r("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.vi=!1,t})});return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=na.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&ti()},t.prototype.Li=function(){},t.prototype.Bi=function(){return Object(M.b)(this,void 0,void 0,function(){var t;return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then(function(){e.Vi.sort(function(t,e){return t.wi-e.wi});for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()})},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function ia(t,e){if($r("AsyncQueue",e+": "+t),Hu(t))return new ii(ri.UNAVAILABLE,e+": "+t);throw t}function oa(t,e){var n=t[1],r=e[1],i=li(t[0],e[0]);return 0===i?li(n,r):i}var sa=function(){function t(t){this.Ki=t,this.buffer=new qi(oa),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();oa(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ua={zi:!1,Hi:0,Ji:0,Yi:0},aa=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();aa.nr=10,aa.sr=1e3,aa.ir=new aa(41943040,aa.nr,aa.sr),aa.rr=new aa(-1,0,0);var ca=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;Xr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,function(){return Object(M.b)(e,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return Hu(e=n.sent())?(Xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Uc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}})})})},t}(),ha=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Tr=function(t,e){var n=this;if(0===e)return Pu.resolve(zu.Ds);var r=new sa(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(Xr("LruGarbageCollector","Garbage collection skipped; disabled"),Pu.resolve(ua)):this.Pr(t).next(function(r){return r<n.params.Xi?(Xr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),ua):n.gr(t,e)})},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.wr(t,this.params.Zi).next(function(e){return e>c.params.tr?(Xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.tr+" from "+e),r=c.params.tr):r=e,o=Date.now(),c.Tr(t,r)}).next(function(r){return n=r,s=Date.now(),c.mr(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Ar(t,n)}).next(function(t){return a=Date.now(),Qr()<=q.a.DEBUG&&Xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Pu.resolve({zi:!0,Hi:r,Ji:i,Yi:t})})},t}();function fa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=pa(e)),e=la(t.get(n),e);return pa(e)}function la(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function pa(t){return t+"\x01\x01"}function da(t){var e=t.length;if(ei(e>=2),2===e)return ei("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),gi.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&ti(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:ti()}o=s+2}return new gi(r)}var va=function(t){this.yr=t};function ya(t,e){if(e.document)return function(t,e,n){var r=Yo(t,e.name),i=zo(e.updateTime),o=new Ws({mapValue:{fields:e.fields}});return new Xs(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Oi.ct(e.noDocument.path),r=Oa(e.noDocument.readTime);return new $s(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Oi.ct(e.unknownDocument.path),o=Oa(e.unknownDocument.version);return new Js(i,o)}return ti()}function ba(t,e,n){var r=ga(n),i=e.key.path.q().H();if(e instanceof Xs){var o=function(t,e){return{name:Wo(t,e.key),fields:e.En().mapValue.fields,updateTime:qo(t,e.version.M())}}(t.yr,e);return new Ha(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof $s){var s=e.key.path.H(),u=wa(e.version),a=e.hasCommittedMutations;return new Ha(null,new Wa(s,u),null,a,r,i)}if(e instanceof Js){var c=e.key.path.H(),h=wa(e.version);return new Ha(new Ya(c,h),null,null,!0,r,i)}return ti()}function ga(t){var e=t.M();return[e.seconds,e.nanoseconds]}function ma(t){var e=new vi(t[0],t[1]);return yi.N(e)}function wa(t){var e=t.M();return new Fa(e.seconds,e.nanoseconds)}function Oa(t){var e=new vi(t.seconds,t.nanoseconds);return yi.N(e)}function Ia(t,e){var n=(e.baseMutations||[]).map(function(e){return ts(t.yr,e)}),r=e.mutations.map(function(e){return ts(t.yr,e)}),i=vi.fromMillis(e.localWriteTimeMs);return new xu(e.batchId,i,n,r)}function _a(t){var e,n,r=Oa(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Oa(t.lastLimboFreeSnapshotVersion):yi.min();return void 0!==t.query.documents?(ei(1===(n=t.query).documents.length),e=au(eu(Qo(n.documents[0])))):e=function(t){return au(rs(t))}(t.query),new Si(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ci.fromBase64String(t.resumeToken))}function Ea(t,e){var n,r=wa(e.ft),i=wa(e.lastLimboFreeSnapshotVersion);n=ki(e.target)?es(t.yr,e.target):ns(t.yr,e.target);var o=e.resumeToken.toBase64();return new Xa(e.targetId,Ai(e.target),r,o,e.sequenceNumber,i,n)}function Ta(t){var e=rs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?cu(e,e.limit,"L"):e}var ja=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return ei(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ka(t)._i({index:Ga.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Sr=function(t,e,n,r){var i=this,o=Ca(t),s=ka(t);return s.add({}).next(function(u){ei("number"==typeof u);for(var a=new xu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Zo(t.yr,e)}),i=n.mutations.map(function(e){return Zo(t.yr,e)});return new Ga(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new qi(function(t,e){return li(t.J(),e.J())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Ka.key(i.userId,d.key.path,u);f=f.add(d.key.path.q()),h.push(s.put(c)),h.push(o.put(v,Ka.PLACEHOLDER))}return f.forEach(function(e){h.push(i.os.Dr(t,e))}),t.es(function(){i.pr[u]=a.keys()}),Pu.qn(h).next(function(){return a})})},t.prototype.Cr=function(t,e){var n=this;return ka(t).get(e).next(function(t){return t?(ei(t.userId===n.userId),Ia(n.serializer,t)):null})},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?Pu.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null})},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ka(t)._i({index:Ga.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(ei(e.batchId>=r),o=Ia(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ka(t)._i({index:Ga.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ka(t).ui(Ga.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ia(e.serializer,t)})})},t.prototype.us=function(t,e){var n=this,r=Ka.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ca(t)._i({range:i},function(r,i,s){var u=r[0],a=r[2],c=da(r[1]);if(u===n.userId&&e.path.isEqual(c))return ka(t).get(a).next(function(t){if(!t)throw ti();ei(t.userId===n.userId),o.push(Ia(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.ds=function(t,e){var n=this,r=new qi(li),i=[];return e.forEach(function(e){var o=Ka.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Ca(t)._i({range:s},function(t,i,o){var s=t[0],u=t[2],a=da(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),Pu.qn(i).next(function(){return n.kr(t,r)})},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ka.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new qi(li);return Ca(t)._i({range:s},function(t,e,o){var s=t[0],a=t[2],c=da(t[1]);s===n.userId&&r.j(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.kr(t,u)})},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ka(t).get(e).next(function(t){if(null===t)throw ti();ei(t.userId===n.userId),r.push(Ia(n.serializer,t))}))}),Pu.qn(i).next(function(){return r})},t.prototype.$r=function(t,e){var n=this;return Na(t.Lr,this.userId,e).next(function(r){return t.es(function(){n.Br(e.batchId)}),Pu.forEach(r,function(e){return n.Vr.qr(t,e)})})},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next(function(n){if(!n)return Pu.resolve();var r=IDBKeyRange.lowerBound(Ka.prefixForUser(e.userId)),i=[];return Ca(t)._i({range:r},function(t,n,r){if(t[0]===e.userId){var o=da(t[1]);i.push(o)}else r.done()}).next(function(){ei(0===i.length)})})},t.prototype.Qr=function(t,e){return Aa(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return xa(t).get(this.userId).next(function(t){return t||new za(e.userId,-1,"")})},t}();function Aa(t,e,n){var r=Ka.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ca(t)._i({range:o,li:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Na(t,e,n){var r=t.store(Ga.store),i=t.store(Ka.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r._i({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){ei(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Ka.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Pu.qn(o).next(function(){return c})}function ka(t){return bc.Ys(t,Ga.store)}function Ca(t){return bc.Ys(t,Ka.store)}function xa(t){return bc.Ys(t,za.store)}var Da=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return Ra(t).put(Ua(e),n)},t.prototype.Hn=function(t,e){var n=Ra(t),r=Ua(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Wr(t,r)})},t.prototype.Jn=function(t,e){var n=this;return Ra(t).get(Ua(e)).next(function(t){return n.jr(t)})},t.prototype.Gr=function(t,e){var n=this;return Ra(t).get(Ua(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:La(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Gi();return this.zr(t,e,function(t,e){var i=n.jr(e);r=r.Tt(t,i)}).next(function(){return r})},t.prototype.Hr=function(t,e){var n=this,r=Gi(),i=new Li(Oi.$);return this.zr(t,e,function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,La(e))):(r=r.Tt(t,null),i=i.Tt(t,0))}).next(function(){return{Jr:r,Yr:i}})},t.prototype.zr=function(t,e,n){if(e.W())return Pu.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return Ra(t)._i({range:r},function(t,e,r){for(var s=Oi.ct(t);o&&Oi.$(o,s)<0;)n(o,null),o=i.Ct();o&&o.isEqual(s)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null})},t.prototype.ws=function(t,e,n){var r=this,i=Wi(),o=e.path.length+1,s={};if(n.isEqual(yi.min())){var u=e.path.H();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.H(),c=ga(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ha.collectionReadTimeIndex}return Ra(t)._i(s,function(t,n,s){if(t.length===o){var u=ya(r.serializer,n);e.path.j(u.key.path)?u instanceof Xs&&pu(e,u)&&(i=i.Tt(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Xr=function(t){return new Sa(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Pa(t).get(Qa.key).next(function(t){return ei(!!t),t})},t.prototype.Wr=function(t,e){return Pa(t).put(Qa.key,e)},t.prototype.jr=function(t){if(t){var e=ya(this.serializer,t);return e instanceof $s&&e.version.isEqual(yi.min())?null:e}return null},t}(),Sa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new Su(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(M.c)(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new qi(function(t,e){return li(t.J(),e.J())});return this.Qn.forEach(function(o,s){var u=e.so.get(o);if(s.zn){var a=ba(e.no.serializer,s.zn,e.Wn(o));i=i.add(o.path.q());var c=La(a);r+=c-u,n.push(e.no.jn(t,o,a))}else if(r-=u,e.Zr){var h=ba(e.no.serializer,new $s(o,yi.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))}),i.forEach(function(r){n.push(e.no.os.Dr(t,r))}),n.push(this.no.updateMetadata(t,r)),Pu.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},e.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},e}(Ru);function Pa(t){return bc.Ys(t,Qa.store)}function Ra(t){return bc.Ys(t,Ha.store)}function Ua(t){return t.path.H()}function La(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ti();e=t.noDocument}return JSON.stringify(e).length}var Ma=function(){function t(){this.io=new Va}return t.prototype.Dr=function(t,e){return this.io.add(e),Pu.resolve()},t.prototype.As=function(t,e){return Pu.resolve(this.io.getEntries(e))},t}(),Va=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new qi(gi.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new qi(gi.$)).H()},t}(),qa=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;ei(n<r&&n>=0&&r<=11);var o=new Qu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ba.store)}(t),function(t){t.createObjectStore(za.store,{keyPath:za.keyPath}),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath,autoIncrement:!0}).createIndex(Ga.userMutationsIndex,Ga.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ka.store)}(t),tc(t),function(t){t.createObjectStore(Ha.store)}(t));var s=Pu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore($a.store),t.deleteObjectStore(Xa.store),t.deleteObjectStore(Ja.store)}(t),tc(t)),s=s.next(function(){return function(t){var e=t.store(Ja.store),n=new Ja(0,0,yi.min().M(),0);return e.put(Ja.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Ga.store).ui().next(function(n){t.deleteObjectStore(Ga.store),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath,autoIncrement:!0}).createIndex(Ga.userMutationsIndex,Ga.userMutationsKeyPath,{unique:!0});var r=e.store(Ga.store),i=n.map(function(t){return r.put(t)});return Pu.qn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ec.store,{keyPath:ec.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Qa.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ha.store);e.createIndex(Ha.readTimeIndex,Ha.readTimeIndexPath,{unique:!1}),e.createIndex(Ha.collectionReadTimeIndex,Ha.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(nc.store,{keyPath:nc.keyPath})}(t),function(t){t.createObjectStore(rc.store,{keyPath:rc.keyPath})}(t)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ha.store)._i(function(t,n){e+=La(n)}).next(function(){var n=new Qa(e);return t.store(Qa.store).put(Qa.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(za.store),r=t.store(Ga.store);return n.ui().next(function(n){return Pu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(Ga.userMutationsIndex,i).next(function(r){return Pu.forEach(r,function(r){ei(r.userId===n.userId);var i=Ia(e.serializer,r);return Na(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store($a.store),n=t.store(Ha.store);return t.store(Ja.store).get(Ja.key).next(function(t){var r=[];return n._i(function(n,i){var o=new gi(n),s=function(t){return[0,fa(t)]}(o);r.push(e.get(s).next(function(n){return n?Pu.resolve():function(n){return e.put(new $a(0,fa(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Pu.qn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Za.store,{keyPath:Za.keyPath});var n=e.store(Za.store),r=new Va,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:fa(i)})}};return e.store(Ha.store)._i({li:!0},function(t,e){var n=new gi(t);return i(n.q())}).next(function(){return e.store(Ka.store)._i({li:!0},function(t,e){var n=da(t[1]);return i(n.q())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Xa.store);return n._i(function(t,r){var i=_a(r),o=Ea(e.serializer,i);return n.put(o)})},t}(),Fa=function(t,e){this.seconds=t,this.nanoseconds=e},Ba=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ba.store="owner",Ba.key="owner";var za=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};za.store="mutationQueues",za.keyPath="userId";var Ga=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ga.store="mutations",Ga.keyPath="batchId",Ga.userMutationsIndex="userMutationsIndex",Ga.userMutationsKeyPath=["userId","batchId"];var Ka=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,fa(e)]},t.key=function(t,e,n){return[t,fa(e),n]},t}();Ka.store="documentMutations",Ka.PLACEHOLDER=new Ka;var Wa=function(t,e){this.path=t,this.readTime=e},Ya=function(t,e){this.path=t,this.version=e},Ha=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ha.store="remoteDocuments",Ha.readTimeIndex="readTimeIndex",Ha.readTimeIndexPath="readTime",Ha.collectionReadTimeIndex="collectionReadTimeIndex",Ha.collectionReadTimeIndexPath=["parentPath","readTime"];var Qa=function(t){this.byteSize=t};Qa.store="remoteDocumentGlobal",Qa.key="remoteDocumentGlobalKey";var Xa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xa.store="targets",Xa.keyPath="targetId",Xa.queryTargetsIndexName="queryTargetsIndex",Xa.queryTargetsKeyPath=["canonicalId","targetId"];var $a=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};$a.store="targetDocuments",$a.keyPath=["targetId","path"],$a.documentTargetsIndex="documentTargetsIndex",$a.documentTargetsKeyPath=["path","targetId"];var Ja=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ja.key="targetGlobalKey",Ja.store="targetGlobal";var Za=function(t,e){this.collectionId=t,this.parent=e};function tc(t){t.createObjectStore($a.store,{keyPath:$a.keyPath}).createIndex($a.documentTargetsIndex,$a.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xa.store,{keyPath:Xa.keyPath}).createIndex(Xa.queryTargetsIndexName,Xa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ja.store)}Za.store="collectionParents",Za.keyPath=["collectionId","parent"];var ec=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ec.store="clientMetadata",ec.keyPath="clientId";var nc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};nc.store="bundles",nc.keyPath="bundleId";var rc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};rc.store="namedQueries",rc.keyPath="name";var ic=Object(M.g)(Object(M.g)(Object(M.g)(Object(M.g)([za.store,Ga.store,Ka.store,Ha.store,Xa.store,Ba.store,Ja.store,$a.store],[ec.store]),[Qa.store]),[Za.store]),[nc.store,rc.store]),oc=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return sc(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Oa(e.createTime),version:e.version};var e})},t.prototype.oo=function(t,e){return sc(t).put({bundleId:(n=e).id,createTime:wa(zo(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return uc(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Ta(e.bundledQuery),readTime:Oa(e.readTime)};var e})},t.prototype.uo=function(t,e){return uc(t).put(function(t){return{name:t.name,readTime:wa(zo(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function sc(t){return bc.Ys(t,nc.store)}function uc(t){return bc.Ys(t,rc.store)}var ac=function(){function t(){this.ao=new Va}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});var o={collectionId:r,parent:fa(i)};return cc(t).put(o)}return Pu.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[di(e),""],!1,!0);return cc(t).ui(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(da(o.parent))}return n})},t}();function cc(t){return bc.Ys(t,Za.store)}var hc=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),fc=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next(function(n){var r=new hc(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next(function(){return n.highestTargetId})})},t.prototype.To=function(t){return this.wo(t).next(function(t){return yi.N(new vi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)})},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next(function(){return n.wo(t).next(function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)})})},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next(function(){return lc(t).delete(e.targetId)}).next(function(){return n.wo(t)}).next(function(e){return ei(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)})},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return lc(t)._i(function(s,u){var a=_a(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))}).next(function(){return Pu.qn(o)}).next(function(){return i})},t.prototype.Ue=function(t,e){return lc(t)._i(function(t,n){var r=_a(n);e(r)})},t.prototype.wo=function(t){return pc(t).get(Ja.key).next(function(t){return ei(null!==t),t})},t.prototype.Eo=function(t,e){return pc(t).put(Ja.key,e)},t.prototype.Ro=function(t,e){return lc(t).put(Ea(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},t.prototype.bo=function(t,e){var n=Ai(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return lc(t)._i({range:r,index:Xa.queryTargetsIndexName},function(t,n,r){var o=_a(n);Ni(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.So=function(t,e,n){var r=this,i=[],o=dc(t);return e.forEach(function(e){var s=fa(e.path);i.push(o.put(new $a(n,s))),i.push(r.Vr.Do(t,n,e))}),Pu.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=dc(t);return Pu.forEach(e,function(e){var o=fa(e.path);return Pu.qn([i.delete([n,o]),r.Vr.No(t,n,e)])})},t.prototype.po=function(t,e){var n=dc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=dc(t),i=Qi();return r._i({range:n,li:!0},function(t,e,n){var r=da(t[1]),o=new Oi(r);i=i.add(o)}).next(function(){return i})},t.prototype.Qr=function(t,e){var n=fa(e.path),r=IDBKeyRange.bound([n],[di(n)],!1,!0),i=0;return dc(t)._i({index:$a.documentTargetsIndex,li:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Ze=function(t,e){return lc(t).get(e).next(function(t){return t?_a(t):null})},t}();function lc(t){return bc.Ys(t,Xa.store)}function pc(t){return bc.Ys(t,Ja.store)}function dc(t){return bc.Ys(t,$a.store)}var vc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return Object(M.c)(e,t),e}(qu),bc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=s,this.document=u,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new ii(ri.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new wc(this,i),this.Ko=n+"main",this.serializer=new va(a),this.Wo=new Ku(this.Ko,11,new qa(this.serializer)),this.jo=new fc(this.Vr,this.serializer),this.os=new ac,this.ss=function(t,e){return new Da(t,e)}(this.serializer,this.os),this.Go=new oc(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&$r("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof yc)return Ku.Ys(t.Lr,e);throw ti()},t.prototype.start=function(){var t=this;return this.Ho().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ii(ri.FAILED_PRECONDITION,vc);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.jo.Io(e)})}).then(function(e){t.ko=new zu(e,t.Oo)}).then(function(){t.$o=!0}).catch(function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)})},t.prototype.Zo=function(t){var e=this;return this.Qo=function(n){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){return this.lr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.tc=function(t){var e=this;this.Wo.ti(function(n){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return mc(e).put(new ec(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.nc(e).next(function(e){e||(t.isPrimary=!1,t.Cs.Mi(function(){return t.Qo(!1)}))})}).next(function(){return t.sc(e)}).next(function(n){return t.isPrimary&&!n?t.ic(e).next(function(){return!1}):!!n&&t.rc(e).next(function(){return!0})})}).catch(function(e){if(Hu(e))return Xr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Cs.Mi(function(){return t.Qo(e)}),t.isPrimary=e})},t.prototype.nc=function(t){var e=this;return gc(t).get(Ba.key).next(function(t){return Pu.resolve(e.oc(t))})},t.prototype.cc=function(t){return mc(t).delete(this.clientId)},t.prototype.uc=function(){return Object(M.b)(this,void 0,void 0,function(){var e,n,r,i=this;return Object(M.d)(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ys(e,ec.store);return n.ui().next(function(t){var e=i.hc(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return Pu.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=o.sent(),this.zo)for(n=0,r=e;n<r.length;n++)this.zo.removeItem(this.lc(r[n].clientId));o.label=2;case 2:return[2]}})})},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?Pu.resolve(!0):gc(t).get(Ba.key).next(function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new ii(ri.FAILED_PRECONDITION,vc);return!1}}return!(!e.networkEnabled||!e.inForeground)||mc(t).ui().next(function(t){return void 0===e.hc(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.fc=function(){return Object(M.b)(this,void 0,void 0,function(){var t=this;return Object(M.d)(this,function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Ba.store,ec.store],function(e){var n=new yc(e,zu.Ds);return t.ic(n).next(function(){return t.cc(n)})})];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}})})},t.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return mc(e).ui().next(function(e){return t.hc(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return ja.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Xr("IndexedDbPersistence","Starting transaction:",t),this.Wo.runTransaction(t,"readonly"===e?"readonly":"readwrite",ic,function(o){return r=new yc(o,i.ko?i.ko.next():zu.Ds),"readwrite-primary"===e?i.nc(r).next(function(t){return!!t||i.sc(r)}).next(function(e){if(!e)throw $r("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new ii(ri.FAILED_PRECONDITION,Vu);return n(r)}).next(function(t){return i.rc(r).next(function(){return t})}):i.yc(r).next(function(){return n(r)})}).then(function(t){return r.ns(),t})},t.prototype.yc=function(t){var e=this;return gc(t).get(Ba.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ii(ri.FAILED_PRECONDITION,vc)})},t.prototype.rc=function(t){var e=new Ba(this.clientId,this.allowTabSynchronization,Date.now());return gc(t).put(Ba.key,e)},t.Gs=function(){return Ku.Gs()},t.prototype.ic=function(t){var e=this,n=gc(t);return n.get(Ba.key).next(function(t){return e.oc(t)?(Xr("IndexedDbPersistence","Releasing primary lease."),n.delete(Ba.key)):Pu.resolve()})},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&($r("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Xr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return $r("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){$r("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function gc(t){return bc.Ys(t,Ba.store)}function mc(t){return bc.Ys(t,ec.store)}var wc=function(){function t(t,e){this.db=t,this.cr=new ha(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,function(t,n){return e(n)})},t.prototype.Do=function(t,e,n){return Oc(t,n)},t.prototype.No=function(t,e,n){return Oc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return Oc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return xa(t).fi(function(r){return Aa(t,r,e).next(function(t){return t&&(n=!0),Pu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,function(s,u){if(u<=e){var a=n.bc(t,s).next(function(e){if(!e)return o++,r.Jn(t,s).next(function(){return r.Hn(s),dc(t).delete([0,fa(s.path)])})});i.push(a)}}).next(function(){return Pu.qn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return Oc(t,e)},t.prototype.vc=function(t,e){var n,r=dc(t),i=zu.Ds;return r._i({index:$a.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==zu.Ds&&e(new Oi(da(n)),i),i=s,n=o):i=zu.Ds}).next(function(){i!==zu.Ds&&e(new Oi(da(n)),i)})},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function Oc(t,e){return dc(t).put(function(t,e){return new $a(0,fa(t.path),e)}(e,t.Fo))}function Ic(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var _c=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Li(li),this.Nc=new Su(function(t){return Ai(t)},Ni),this.xc=yi.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new Fu(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Rr(n,e.Cc)})},t}();function Ec(t,e,n,r){return new _c(t,e,n,r)}function Tc(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:return n=ni(t),r=n.rs,i=n.Oc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.rs.Mr(t).next(function(s){return o=s,r=n.persistence.mc(e),i=new Fu(n.Fc,r,n.persistence.Pc()),r.Mr(t)}).next(function(e){for(var n=[],r=[],s=Qi(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i._s(t,s).next(function(t){return{kc:t,$c:n,Lc:r}})})})];case 1:return o=s.sent(),[2,(n.rs=r,n.Oc=i,n.Dc.Mc(n.Oc),o)]}})})}function jc(t,e){var n=ni(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Pu.resolve();return o.forEach(function(t){s=s.next(function(){return r.Jn(e,t)}).next(function(e){var o=e,s=n.Sn.get(t);ei(null!==s),(!o||o.version.F(s)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)})}),s.next(function(){return t.rs.$r(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}function Ac(t){var e=ni(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Nc(t,e){var n=ni(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var s=[];e.re.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.jo.Co(t,e.de,o).next(function(){return n.jo.So(t,e._e,o)}));var a=e.resumeToken;if(a.ht()>0){var c=u.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return ei(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(u,c,e)&&s.push(n.jo.yo(t,c))}}});var u=zi();if(e.ce.forEach(function(r,i){e.ue.has(r)&&s.push(n.persistence.Vr.Sc(t,r))}),s.push(function(t,e,n,r,i){var o=Qi();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=zi();return n.forEach(function(n,o){var s=t.get(n),u=r;o instanceof $s&&o.version.isEqual(yi.min())?(e.Hn(n,u),i=i.Tt(n,o)):null==s||o.version.F(s.version)>0||0===o.version.F(s.version)&&s.hasPendingWrites?(e.jn(o,u),i=i.Tt(n,o)):Xr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),i})}(t,o,e.ce,r).next(function(t){u=t})),!r.isEqual(yi.min())){var a=n.jo.To(t).next(function(e){return n.jo.mo(t,t.Fo,r)});s.push(a)}return Pu.qn(s).next(function(){return o.apply(t)}).next(function(){return n.Oc.fs(t,u)})}).then(function(t){return n.Cc=i,t})}function kc(t,e){var n=ni(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)})}function Cc(t,e){var n=ni(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.jo.bo(t,e).next(function(i){return i?Pu.resolve(r=i):n.jo.fo(t).next(function(i){return r=new Si(e,i,0,t.Fo),n.jo.Ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t})}function xc(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:r=ni(t),i=r.Cc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Vr.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Hu(s=u.sent()))throw s;return Xr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Cc=r.Cc.remove(e),r.Nc.delete(i.target),[2]}})})}function Dc(t,e,n){var r=ni(t),i=yi.min(),o=Qi();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=ni(t),i=r.Nc.get(n);return void 0!==i?Pu.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,au(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Dc.ws(t,e,n?i:yi.min(),n?o:Qi())}).next(function(t){return{documents:t,Bc:o}})})}function Sc(t,e){var n=ni(t),r=ni(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Pc(t){var e=ni(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=ni(t),i=zi(),o=ga(n),s=Ra(e),u=IDBKeyRange.lowerBound(o,!0);return s._i({index:Ha.readTimeIndex,range:u},function(t,e){var n=ya(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:ma(o)}})}(e.Fc,t,e.xc)}).then(function(t){var n=t.qc;return e.xc=t.readTime,n})}function Rc(t){return Object(M.b)(this,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){return[2,(e=ni(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Ra(t),n=yi.min();return e._i({index:Ha.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=ma(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.xc=t})]})})}function Uc(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){if(t.code!==ri.FAILED_PRECONDITION||t.message!==Vu)throw t;return Xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Lc=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Gu(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,e){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(n){switch(n.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():e&&e.code===ri.RESOURCE_EXHAUSTED?($r(e.toString()),$r("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===ri.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(e)];case 1:return n.sent(),[2]}})})},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then(function(e){t.Wc===n&&t.iu(e)},function(n){e(function(){var e=new ii(ri.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)})})},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return Object(M.b)(t,void 0,void 0,function(){return Object(M.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.ru=function(t){return Xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri(function(){return e.Wc===t?n():(Xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Mc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(M.c)(e,t),e.prototype.ou=function(t){return this.Qc.uu("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ti()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(ei(void 0===e||"string"==typeof e),Ci.fromBase64String(e||"")):(ei(void 0===e||e instanceof Uint8Array),Ci.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?ri.UNKNOWN:Ui(t.code);return new ii(e,t.message||"")}(s);n=new oo(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=Yo(t,a.document.name),h=zo(a.document.updateTime),f=new Ws({mapValue:{fields:a.document.fields}}),l=new Xs(c,h,f,{});n=new ro(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=Yo(t,p.document),v=p.readTime?zo(p.readTime):yi.min(),y=new $s(d,v);n=new ro([],p.removedTargetIds||[],y.key,y)}else if("documentRemove"in e){var b=e.documentRemove,g=Yo(t,b.document);n=new ro([],b.removedTargetIds||[],g,null)}else{if(!("filter"in e))return ti();var m=e.filter,w=new Pi(m.count||0);n=new io(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return yi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?yi.min():e.readTime?zo(e.readTime):yi.min()}(t);return this.listener.au(e,n)},e.prototype.hu=function(t){var e={};e.database=Xo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=ki(r)?{documents:es(t,r)}:{query:ns(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=Fo(t,e.resumeToken):e.ft.F(yi.min())>0&&(n.readTime=qo(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ti()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Zc(e)},e.prototype.lu=function(t){var e={};e.database=Xo(this.serializer),e.removeTarget=t,this.Zc(e)},e}(Lc),Vc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s._u=!1,s}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.eu=function(){this._u&&this.du([])},e.prototype.ou=function(t){return this.Qc.uu("Write",t)},e.prototype.onMessage=function(t){if(ei(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(ei(void 0!==e),t.map(function(t){return function(t,e){var n=zo(t.updateTime?t.updateTime:e);n.isEqual(yi.min())&&(n=zo(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ks(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=zo(t.commitTime);return this.listener.wu(n,e)}return ei(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},e.prototype.Tu=function(){var t={};t.database=Xo(this.serializer),this.Zc(t)},e.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Zo(e.serializer,t)})};this.Zc(n)},e}(Lc),qc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return Object(M.c)(e,t),e.prototype.mu=function(){if(this.Iu)throw new ii(ri.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Au(t,e,n,i)}).catch(function(t){throw t.code===ri.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Ru(t,e,n,i)}).catch(function(t){throw t.code===ri.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.terminate=function(){this.Iu=!1},e}(function(){}),Fc=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?($r(e),this.Vu=!1):Xr("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),Bc=function(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return Object(M.b)(o,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return $c(this)?(Xr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(M.b)(this,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){switch(n.label){case 0:return(e=ni(t)).Mu.add(4),[4,Gc(e)];case 1:return n.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,zc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new Fc(n,r)};function zc(t){return Object(M.b)(this,void 0,void 0,function(){var e,n;return Object(M.d)(this,function(r){switch(r.label){case 0:if(!$c(t))return[3,4];e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Gc(t){return Object(M.b)(this,void 0,void 0,function(){var e,n;return Object(M.d)(this,function(r){switch(r.label){case 0:e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Kc(t,e){var n=ni(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),Xc(n)?Qc(n):lh(n).zc()&&Yc(n,e))}function Wc(t,e){var n=ni(t),r=lh(n);n.Ou.delete(e),r.zc()&&Hc(n,e),0===n.Ou.size&&(r.zc()?r.Yc():$c(n)&&n.Bu.set("Unknown"))}function Yc(t,e){t.qu.De(e.targetId),lh(t).hu(e)}function Hc(t,e){t.qu.De(e),lh(t).lu(e)}function Qc(t){t.qu=new uo({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),lh(t).start(),t.Bu.pu()}function Xc(t){return $c(t)&&!lh(t).Gc()&&t.Ou.size>0}function $c(t){return 0===ni(t).Mu.size}function Jc(t){t.qu=void 0}function Zc(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){return t.Ou.forEach(function(e,n){Yc(t,e)}),[2]})})}function th(t,e){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(n){return Jc(t),Xc(t)?(t.Bu.Su(e),Qc(t)):t.Bu.set("Unknown"),[2]})})}function eh(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:if(t.Bu.set("Online"),!(e instanceof oo&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Ou.has(o=i[r])?[4,t.xu.Uu(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Ou.delete(o),t.qu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Xr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,nh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ro?t.qu.$e(e):e instanceof io?t.qu.je(e):t.qu.qe(e),n.isEqual(yi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Ac(t.Cu)];case 8:return i=s.sent(),n.F(i)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach(function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(Ci.lt,n.ft)),Hc(t,e);var r=new Si(n.target,e,1,n.sequenceNumber);Yc(t,r)}}),t.xu.Qu(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Xr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,nh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function nh(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r=this;return Object(M.d)(this,function(i){switch(i.label){case 0:if(!Hu(e))throw e;return t.Mu.add(1),[4,Gc(t)];case 1:return i.sent(),t.Bu.set("Offline"),n||(n=function(){return Ac(t.Cu)}),t.di.Mi(function(){return Object(M.b)(r,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return Xr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Mu.delete(1),[4,zc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function rh(t,e){return e().catch(function(n){return nh(t,n,e)})}function ih(t){return Object(M.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:e=ni(t),n=ph(e),r=e.Fu.length>0?e.Fu[e.Fu.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return $c(t)&&t.Fu.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,kc(e.Cu,r)];case 3:return null===(i=s.sent())?(0===e.Fu.length&&n.Yc(),[3,7]):(r=i.batchId,function(t,e){t.Fu.push(e);var n=ph(t);n.zc()&&n.fu&&n.du(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,nh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return oh(e)&&sh(e),[2]}})})}function oh(t){return $c(t)&&!ph(t).Gc()&&t.Fu.length>0}function sh(t){ph(t).start()}function uh(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){return ph(t).Tu(),[2]})})}function ah(t){return Object(M.b)(this,void 0,void 0,function(){var e,n,r;return Object(M.d)(this,function(i){for(e=ph(t),n=0,r=t.Fu;n<r.length;n++)e.du(r[n].mutations);return[2]})})}function ch(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:return r=t.Fu.shift(),i=Du.from(r,e,n),[4,rh(t,function(){return t.xu.Ku(i)})];case 1:return o.sent(),[4,ih(t)];case 2:return o.sent(),[2]}})})}function hh(t,e){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(n){switch(n.label){case 0:return e&&ph(t).fu?[4,function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r;return Object(M.d)(this,function(i){switch(i.label){case 0:return Ri(r=e.code)&&r!==ri.ABORTED?(n=t.Fu.shift(),ph(t).Jc(),[4,rh(t,function(){return t.xu.Wu(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,ih(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return oh(t)&&sh(t),[2]}})})}function fh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n;return Object(M.d)(this,function(r){switch(r.label){case 0:return n=ni(t),e?(n.Mu.delete(2),[4,zc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Mu.add(2),[4,Gc(n)]);case 3:r.sent(),n.Bu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function lh(t){var e=this;return t.ju||(t.ju=function(t,e,n){var r=ni(t);return r.mu(),new Mc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Zc.bind(null,t),nu:th.bind(null,t),au:eh.bind(null,t)}),t.ku.push(function(n){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return n?(t.ju.Jc(),Xc(t)?Qc(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),Jc(t),e.label=3;case 3:return[2]}})})})),t.ju}function ph(t){var e=this;return t.Gu||(t.Gu=function(t,e,n){var r=ni(t);return r.mu(),new Vc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:uh.bind(null,t),nu:hh.bind(null,t),Eu:ah.bind(null,t),wu:ch.bind(null,t)}),t.ku.push(function(n){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return n?(t.Gu.Jc(),[4,ih(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(Xr("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}})})})),t.Gu}var dh=function(){this.zu=void 0,this.listeners=[]},vh=function(){this.queries=new Su(function(t){return fu(t)},hu),this.onlineState="Unknown",this.Hu=new Set};function yh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(M.d)(this,function(c){switch(c.label){case 0:if(n=ni(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new dh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Ju(r)];case 2:return s.zu=c.sent(),[3,4];case 3:return u=c.sent(),a=ia(u,"Initialization of query '"+lu(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Yu(n.onlineState),o.zu&&e.Xu(o.zu)&&wh(n),[2]}})})}function bh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(M.d)(this,function(u){return n=ni(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Zu(r))]:[2]})})}function gh(t,e){for(var n=ni(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&wh(n)}function mh(t,e,n){var r=ni(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function wh(t){t.Hu.forEach(function(t){t.next()})}var Oh=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new to(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){return!t.fromCache||!(this.options.oa&&"Offline"!==e||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){return t.docChanges.length>0||!!(t.ne||this.na&&this.na.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=to.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),Ih=function(){function t(){this.ca=new qi(_h.ua),this.aa=new qi(_h.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new _h(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},t.prototype.No=function(t,e){this._a(new _h(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},t.prototype.da=function(t){var e=this,n=new Oi(new gi([])),r=new _h(n,t),i=new _h(n,t+1),o=[];return this.aa.Kt([r,i],function(t){e._a(t),o.push(t.key)}),o},t.prototype.wa=function(){var t=this;this.ca.forEach(function(e){return t._a(e)})},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new Oi(new gi([])),n=new _h(e,t),r=new _h(e,t+1),i=Qi();return this.aa.Kt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Qr=function(t){var e=new _h(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),_h=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return Oi.$(t.key,e.key)||li(t.Ta,e.Ta)},t.ha=function(t,e){return li(t.Ta,e.Ta)||Oi.$(t.key,e.key)},t}();function Eh(t,e){return"firestore_clients_"+t+"_"+e}function Th(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function jh(t,e){return"firestore_targets_"+t+"_"+e}var Ah=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new ii(i.error.code,i.error.message)),o?new t(e,n,i.state,s):($r("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Nh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new ii(r.error.code,r.error.message)),i?new t(e,r.state,o):($r("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),kh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=$i(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ei(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):($r("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Ch=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):($r("SharedClientState","Failed to parse online state: "+e),null)},t}(),xh=function(){function t(){this.activeTargetIds=$i()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Dh=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Li(li),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=Eh(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new xh),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(M.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(M.d)(this,function(f){switch(f.label){case 0:return[4,this.ga.Ic()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(Eh(this.persistenceKey,r)))&&(o=kh.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)this.Va(c[a]);return this.va=[],this.window.addEventListener("unload",function(){return h.fc()}),this.lr=!0,[2]}})})},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(jh(this.persistenceKey,t));if(n){var r=Nh.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(jh(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Xr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Xr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ba)return void $r("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return Object(M.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(M.d)(this,function(u){if(this.lr){if(null!==n.key)if(this.Da.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.uh(r)]}else if(this.Na.test(n.key)){if(null!==n.newValue&&(i=this.ah(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xa){if(null!==n.newValue&&(o=this.Ma(n.newValue)))return[2,this.ka(o)]}else if(n.key===this.Sa)(s=function(t){var e=zu.Ds;if(null!=t)try{var n=JSON.parse(t);ei("number"==typeof n),e=n}catch(t){$r("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==zu.Ds&&this.ps(s);else if(n.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new Ah(this.currentUser,t,e,n),i=Th(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=Th(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xa,JSON.stringify({clientId:this.Pa,onlineState:t}))},t.prototype.Ya=function(t,e,n){var r=jh(this.persistenceKey,t),i=new Nh(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return kh.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]);return Ah.Ia(new Yr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return Nh.Ia(r,e)},t.prototype.Ma=function(t){return Ch.Ia(t)},t.prototype.uh=function(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(Xr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=$i();return t.forEach(function(t,n){e=e.Gt(n.activeTargetIds)}),e},t}(),Sh=function(){function t(){this.wh=new xh,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new xh,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),Ph=function(t){this.key=t},Rh=function(t){this.key=t},Uh=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Qi(),this.ee=Qi(),this.Ah=du(t),this.Rh=new Ji(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new Zi,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,s=i,u=!1,a=nu(this.query)&&i.size===this.query.limit?i.last():null,c=ru(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt(function(t,e){var h=i.get(t),f=e instanceof Xs?e:null;f&&(f=pu(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Vh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),nu(this.query)||ru(this.query))for(;s.size>this.query.limit;){var h=nu(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,yh:r,ph:u,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ti()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var s=e?this.Sh():[],u=0===this.mh.size&&this.le?1:0,a=u!==this.Ih;return this.Ih=u,0!==o.length||a?{snapshot:new to(this.query,t.Rh,i,o,t.ee,0===u,a,!1),Dh:s}:{Dh:s}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Zi,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=Qi(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new Rh(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new Ph(t))}),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Qi();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return to.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),Lh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Mh=function(t){this.key=t,this.Fh=!1},Vh=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Su(function(t){return fu(t)},hu),this.qh=new Map,this.Uh=[],this.Qh=new Li(Oi.$),this.Kh=new Map,this.Wh=new Ih,this.jh={},this.Gh=new Map,this.zh=hc._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function qh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:return n=yf(t),(i=n.Bh.get(e))?(n.kh.Wa(i.targetId),r=i.view.xh(),[3,4]):[3,1];case 1:return[4,Cc(n.Cu,au(e))];case 2:return o=u.sent(),s=n.kh.Wa(o.targetId),[4,Fh(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.Jh&&Kc(n.Oh,o),u.label=4;case 4:return[2,r]}})})}function Fh(t,e,n,r){return Object(M.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(M.d)(this,function(h){switch(h.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return Object(M.b)(this,void 0,void 0,function(){var i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:return(i=e.view.gh(n)).ph?[4,Dc(t.Cu,e.query,!1).then(function(t){return e.view.gh(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.re.get(e.targetId),s=e.view.Zn(i,t.Jh,o),[2,(tf(t,e.targetId,s.Dh),s.snapshot)]}})})}(t,e,n,r)},[4,Dc(t.Cu,e,!0)];case 1:return i=h.sent(),o=new Uh(e,i.Bc),s=o.gh(i.documents),u=no.he(n,r&&"Offline"!==t.onlineState),a=o.Zn(s,t.Jh,u),tf(t,n,a.Dh),c=new Lh(e,n,o),[2,(t.Bh.set(e,c),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),a.snapshot)]}})})}function Bh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:return n=ni(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter(function(t){return!hu(t,e)})),void n.Bh.delete(e))]:n.Jh?(n.kh.Ga(r.targetId),n.kh.Ba(r.targetId)?[3,2]:[4,xc(n.Cu,r.targetId,!1).then(function(){n.kh.Ha(r.targetId),Wc(n.Oh,r.targetId),Jh(n,r.targetId)}).catch(Uc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Jh(n,r.targetId),[4,xc(n.Cu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function zh(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:r=bf(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=ni(t),i=vi.now(),o=e.reduce(function(t,e){return t.add(e.key)},Qi());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Oc._s(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Rs(c,n.get(c.key));null!=h&&s.push(new Vs(c.key,h,Hs(h.proto.mapValue),Cs.exists(!0)))}return r.rs.Sr(t,i,s,e)})}).then(function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}})}(r.Cu,e)];case 2:return i=u.sent(),r.kh.qa(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new Li(li)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(r,i.batchId,n),[4,rf(r,i.Qn)];case 3:return u.sent(),[4,ih(r.Oh)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=ia(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Gh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r;return Object(M.d)(this,function(i){switch(i.label){case 0:n=ni(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Nc(n.Cu,e)];case 2:return r=i.sent(),e.re.forEach(function(t,e){var r=n.Kh.get(e);r&&(ei(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?ei(r.Fh):t.de.size>0&&(ei(r.Fh),r.Fh=!1))}),[4,rf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Uc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Kh(t,e,n){var r=ni(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=ni(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)}),r&&wh(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function Wh(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(M.d)(this,function(c){switch(c.label){case 0:return(r=ni(t)).kh.Ja(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(s=(s=new Li(Oi.$)).Tt(o,new $s(o,yi.min())),u=Qi().add(o),a=new eo(yi.min(),new Map,new qi(li),s,u),[4,Gh(r,a)]):[3,2];case 1:return c.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),nf(r),[3,4];case 2:return[4,xc(r.Cu,e,!1).then(function(){return Jh(r,e,n)}).catch(Uc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Yh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:n=ni(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,jc(n.Cu,e)];case 2:return i=o.sent(),$h(n,r,null),Xh(n,r),n.kh.Qa(r,"acknowledged"),[4,rf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Uc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Hh(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:r=ni(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=ni(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.rs.Cr(t,e).next(function(e){return ei(null!==e),r=e.keys(),n.rs.$r(t,e)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}(r.Cu,e)];case 2:return i=o.sent(),$h(r,e,n),Xh(r,e),r.kh.Qa(e,"rejected",n),[4,rf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Uc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Qh(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:$c((n=ni(t)).Oh)||Xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=ni(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})}(n.Cu)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=u.sent(),s=ia(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Xh(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function $h(t,e,n){var r=ni(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function Jh(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach(function(e){t.Wh.Qr(e)||Zh(t,e)})}function Zh(t,e){var n=t.Qh.get(e);null!==n&&(Wc(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),nf(t))}function tf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ph?(t.Wh.Do(o.key,e),ef(t,o)):o instanceof Rh?(Xr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||Zh(t,o.key)):ti()}}function ef(t,e){var n=e.key;t.Qh.get(n)||(Xr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),nf(t))}function nf(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Mh(e)),t.Qh=t.Qh.Tt(e,n),Kc(t.Oh,new Si(au(eu(e.path)),n,2,zu.Ds))}}function rf(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:return r=ni(t),i=[],o=[],s=[],r.Bh.W()?[3,3]:(r.Bh.forEach(function(t,u){s.push(r.Yh(u,e,n).then(function(t){if(t){r.Jh&&r.kh.Ja(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Bu.Vs(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.Lh.au(i),[4,function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(M.d)(this,function(h){switch(h.label){case 0:n=ni(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Pu.forEach(e,function(e){return Pu.forEach(e.gs,function(r){return n.persistence.Vr.Do(t,e.targetId,r)}).next(function(){return Pu.forEach(e.ys,function(r){return n.persistence.Vr.No(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Hu(r=h.sent()))throw r;return Xr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.Cc.get(u),c=a.Et(a.ft),n.Cc=n.Cc.Tt(u,c));return[2]}})})}(r.Cu,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function of(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r;return Object(M.d)(this,function(i){switch(i.label){case 0:return(n=ni(t)).currentUser.isEqual(e)?[3,3]:(Xr("SyncEngine","User change. New user:",e.h()),[4,Tc(n.Cu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new ii(ri.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(n),n.kh.Xa(e,r.$c,r.Lc),[4,rf(n,r.kc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function sf(t,e){var n=ni(t),r=n.Kh.get(e);if(r&&r.Fh)return Qi().add(r.key);var i=Qi(),o=n.qh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Bh.get(u[s]);i=i.Gt(a.view.Ph)}return i}function uf(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:return[4,Dc((n=ni(t)).Cu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&tf(n,e.targetId,i.Dh),i)]}})})}function af(t){return Object(M.b)(this,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){return[2,Pc((e=ni(t)).Cu).then(function(t){return rf(e,t)})]})})}function cf(t,e,n,r){return Object(M.b)(this,void 0,void 0,function(){var i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=ni(t),r=ni(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Nr(t,e).next(function(e){return e?n.Oc._s(t,e):Pu.resolve(null)})})}((i=ni(t)).Cu,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,ih(i.Oh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?($h(i,e,r||null),Xh(i,e),function(t,e){ni(ni(t).rs).Br(e)}(i.Cu,e)):ti(),s.label=4;case 4:return[4,rf(i,o)];case 5:return s.sent(),[3,7];case 6:Xr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function hf(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(M.d)(this,function(c){switch(c.label){case 0:return yf(n=ni(t)),bf(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$a(),[4,ff(n,r.H())]);case 1:return i=c.sent(),n.Hh=!0,[4,fh(n.Oh,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Kc(n.Oh,s[o]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(u=[],a=Promise.resolve(),n.qh.forEach(function(t,e){n.kh.za(e)?u.push(e):a=a.then(function(){return Jh(n,e),xc(n.Cu,e,!0)}),Wc(n.Oh,e)}),[4,a]);case 4:return c.sent(),[4,ff(n,u)];case 5:return c.sent(),function(t){var e=ni(t);e.Kh.forEach(function(t,n){Wc(e.Oh,n)}),e.Wh.wa(),e.Kh=new Map,e.Qh=new Li(Oi.$)}(n),n.Hh=!1,[4,fh(n.Oh,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function ff(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(M.d)(this,function(v){switch(v.label){case 0:n=ni(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.qh.get(u=s[o]))&&0!==c.length?[4,Cc(n.Cu,au(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Bh.get(f[h]),[4,uf(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Sc(n.Cu,u)];case 8:return d=v.sent(),[4,Cc(n.Cu,d)];case 9:return a=v.sent(),[4,Fh(n,lf(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.au(i),r)]}})})}function lf(t){return tu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function pf(t){var e=ni(t);return ni(ni(e.Cu).persistence).Ic()}function df(t,e,n,r){return Object(M.b)(this,void 0,void 0,function(){var i,o,s;return Object(M.d)(this,function(u){switch(u.label){case 0:return(i=ni(t)).Hh?(Xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Pc(i.Cu)];case 3:return o=u.sent(),s=eo.ae(e,"current"===n),[4,rf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,xc(i.Cu,e,!0)];case 6:return u.sent(),Jh(i,e,r),[3,8];case 7:ti(),u.label=8;case 8:return[2]}})})}function vf(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(M.d)(this,function(l){switch(l.label){case 0:if(!(r=yf(t)).Hh)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.qh.has(s=o[i])?(Xr("SyncEngine","Adding an already active target "+s),[3,5]):[4,Sc(r.Cu,s)]:[3,6];case 2:return u=l.sent(),[4,Cc(r.Cu,u)];case 3:return a=l.sent(),[4,Fh(r,lf(u),a.targetId,!1)];case 4:l.sent(),Kc(r.Oh,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(M.d)(this,function(e){switch(e.label){case 0:return r.qh.has(t)?[4,xc(r.Cu,t,!1).then(function(){Wc(r.Oh,t),Jh(r,t)}).catch(Uc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function yf(t){var e=ni(t);return e.Oh.xu.Qu=Gh.bind(null,e),e.Oh.xu.Xe=sf.bind(null,e),e.Oh.xu.Uu=Wh.bind(null,e),e.Lh.au=gh.bind(null,e.Mh),e.Lh.Xh=mh.bind(null,e.Mh),e}function bf(t){var e=ni(t);return e.Oh.xu.Ku=Yh.bind(null,e),e.Oh.xu.Wu=Hh.bind(null,e),e}var gf=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(yi.min())?this.tl(t,e):this.Zh._s(t,r).next(function(o){var s=i.el(e,o);return(nu(e)||ru(e))&&i.ph(e.limitType,s,r,n)?i.tl(t,e):(Qr()<=q.a.DEBUG&&Xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),lu(e)),i.Zh.ws(t,e,n).next(function(t){return s.forEach(function(e){t=t.Tt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new qi(du(t));return e.forEach(function(e,r){r instanceof Xs&&pu(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return Qr()<=q.a.DEBUG&&Xr("IndexFreeQueryEngine","Using full collection scan to execute query:",lu(e)),this.Zh.ws(t,e,yi.min())},t}(),mf=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new qi(_h.ua)}return t.prototype.br=function(t){return Pu.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new xu(i,e,n,r);this.rs.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new _h(a.key,i)),this.os.Dr(t,a.key.path.q())}return Pu.resolve(o)},t.prototype.Cr=function(t,e){return Pu.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return Pu.resolve(this.rs.length>r?this.rs[r]:null)},t.prototype.Or=function(){return Pu.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return Pu.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new _h(e,0),i=new _h(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],function(t){var e=n.il(t.Ta);o.push(e)}),Pu.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new qi(li);return e.forEach(function(t){var e=new _h(t,0),i=new _h(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],function(t){r=r.add(t.Ta)})}),Pu.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;Oi.ot(i)||(i=i.child(""));var o=new _h(new Oi(i),0),s=new qi(li);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(s=s.add(t.Ta)),!0)},o),Pu.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.$r=function(t,e){var n=this;ei(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return Pu.forEach(e.mutations,function(i){var o=new _h(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)}).next(function(){n.sl=r})},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new _h(e,0),r=this.sl.jt(n);return Pu.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return Pu.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),wf=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new Li(Oi.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:s,readTime:n}),this.size+=s-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return Pu.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=Gi();return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),Pu.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=Wi(),i=new Oi(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.value,a=u.zn,c=u.readTime;if(!e.path.j(s.key.path))break;c.F(n)<=0||a instanceof Xs&&pu(e,a)&&(r=r.Tt(a.key,a))}return Pu.resolve(r)},t.prototype.al=function(t,e){return Pu.forEach(this.docs,function(t){return e(t)})},t.prototype.Xr=function(t){return new Of(this)},t.prototype.eo=function(t){return Pu.resolve(this.size)},t}(),Of=function(t){function e(e){var n=this;return(n=t.call(this)||this).no=e,n}return Object(M.c)(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach(function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)}),Pu.qn(n)},e.prototype.Yn=function(t,e){return this.no.Jn(t,e)},e.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},e}(Ru),If=function(){function t(t){this.persistence=t,this.hl=new Su(function(t){return Ai(t)},Ni),this.lastRemoteSnapshotVersion=yi.min(),this.highestTargetId=0,this.ll=0,this._l=new Ih,this.targetCount=0,this.fl=hc.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),Pu.resolve()},t.prototype.To=function(t){return Pu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return Pu.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),Pu.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Pu.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new hc(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,Pu.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),Pu.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,Pu.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.po(t,u.targetId)),i++)}),Pu.qn(o).next(function(){return i})},t.prototype.vo=function(t){return Pu.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return Pu.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),Pu.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach(function(e){i.push(r.qr(t,e))}),Pu.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),Pu.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return Pu.resolve(n)},t.prototype.Qr=function(t,e){return Pu.resolve(this._l.Qr(e))},t}(),_f=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return Pu.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:zo(n.createTime)}),Pu.resolve()},t.prototype.co=function(t,e){return Pu.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:Ta(n.bundledQuery),readTime:zo(n.readTime)}),Pu.resolve()},t}(),Ef=function(){function t(t,e){var n=this;this.El={},this.ko=new zu(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new If(this),this.os=new Ma,this.ss=function(t,e){return new wf(t,function(t){return n.Vr.Tl(t)})}(this.os),this.serializer=new va(e),this.Go=new _f(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new mf(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;Xr("MemoryPersistence","Starting transaction:",t);var i=new Tf(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},t.prototype.Al=function(t,e){return Pu.Un(Object.values(this.El).map(function(n){return function(){return n.Qr(t,e)}}))},t}(),Tf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return Object(M.c)(e,t),e}(qu),jf=function(){function t(t){this.persistence=t,this.Rl=new Ih,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw ti()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),Pu.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),Pu.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),Pu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return Pu.forEach(this.yl,function(r){var i=Oi.st(r);return e.Vl(t,i).next(function(t){t||n.Hn(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return Pu.Un([function(){return Pu.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),Af=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),Nf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kf=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(M.c)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise(function(i,o){var s=new zr;s.listenOnce(qr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Vr.NO_ERROR:var e=s.getResponseJson();Xr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Vr.TIMEOUT:Xr("Connection",'RPC "'+t+'" timed out'),o(new ii(ri.DEADLINE_EXCEEDED,"Request time out"));break;case Vr.HTTP_ERROR:var n=s.getStatus();if(Xr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(ri).indexOf(e)>=0?e:ri.UNKNOWN}(r.status);o(new ii(u,r.message))}else o(new ii(ri.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ii(ri.UNAVAILABLE,"Connection failed."));break;default:ti()}}finally{Xr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Pr,i=Ue(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(o.initMessageHeaders,e),Object(F.l)()||Object(F.n)()||Object(F.j)()||Object(F.k)()||Object(F.o)()||Object(F.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Xr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Af({pl:function(t){c?Xr("Connection","Not sending because WebChannel is closed:",t):(a||(Xr("Connection","Opening WebChannel transport."),u.open(),a=!0),Xr("Connection","WebChannel sending:",t),u.send(t))},vl:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Br.EventType.OPEN,function(){c||Xr("Connection","WebChannel transport opened.")}),f(u,Br.EventType.CLOSE,function(){c||(c=!0,Xr("Connection","WebChannel transport closed"),h.Nl())}),f(u,Br.EventType.ERROR,function(t){c||(c=!0,Jr("Connection","WebChannel transport errored:",t),h.Nl(new ii(ri.UNAVAILABLE,"The operation could not be completed")))}),f(u,Br.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];ei(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Xr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=xi[t];if(void 0!==e)return Ui(e)}(i),s=r.message;void 0===o&&(o=ri.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new ii(o,s)),u.close()}else Xr("Connection","WebChannel received:",n),h.xl(n)}}),f(i,Fr.STAT_EVENT,function(t){10===t.stat?Xr("Connection","Detected buffering proxy"):11===t.stat&&Xr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Cl()},0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);Xr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return Xr("RestConnection","Received: ",t),t},function(e){throw Jr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+Nf[t]},t}()),Cf=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){Xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){Xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),xf=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),Df=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return this.serializer=Lu(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Ec(this.persistence,new gf,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new Ef(jf.gl,this.serializer)},t.prototype.jl=function(t){return new Sh},t.prototype.terminate=function(){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},t}(),Sf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(M.c)(e,t),e.prototype.initialize=function(e){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Rc(this.Cu)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,bf(this.Xl.ga)];case 4:return n.sent(),[4,ih(this.Xl.Oh)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return Ec(this.persistence,new gf,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new ca(this.persistence.Vr.cr,t.di)},e.prototype.Gl=function(t){var e=Ic(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?aa.er(this.cacheSizeBytes):aa.ir;return new bc(this.synchronizeTabs,e,t.clientId,n,t.di,ta(),ea(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new Sh},e}(Df),Pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(M.c)(e,t),e.prototype.initialize=function(e){return Object(M.b)(this,void 0,void 0,function(){var n,r=this;return Object(M.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.ga,this.kh instanceof Dh?(this.kh.ga={_h:cf.bind(null,n),fh:df.bind(null,n),dh:vf.bind(null,n),Ic:pf.bind(null,n),lh:af.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Zo(function(t){return Object(M.b)(r,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,hf(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=ta();if(!Dh.Gs(e))throw new ii(ri.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ic(t.Fl.t,t.Fl.persistenceKey);return new Dh(e,t.di,n,t.clientId,t.Yl)},e}(Sf),Rf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n=this;return Object(M.d)(this,function(r){switch(r.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.ga=this.n_(e,!t.synchronizeTabs),this.kh.Pu=function(t){return Kh(n.ga,t,1)},this.Oh.xu.s_=of.bind(null,this.ga),[4,fh(this.Oh,this.ga.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new vh},t.prototype.Zl=function(t){var e=Lu(t.Fl.t),n=new kf(t.Fl);return function(t,e,n){return new qc(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return Kh(s.ga,t,0)},o=Cf.Gs()?new Cf:new xf,new Bc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Vh(t,e,n,r,i,o);return s&&(u.Hh=!0),u}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return Object(M.b)(this,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){switch(n.label){case 0:return e=ni(t),Xr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,Gc(e)];case 1:return n.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},t}(),Uf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Lf=function(t){this.o_=t};function Mf(t,e,n){if(!n)throw new ii(ri.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Vf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ii(ri.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function qf(t,e,n,r){if(!0===e&&!0===r)throw new ii(ri.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ff(t){if(!Oi.ot(t))throw new ii(ri.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Bf(t){if(Oi.ot(t))throw new ii(ri.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function zf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ti()}function Gf(t,e){if(t instanceof Lf&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new ii(ri.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=zf(t);throw new ii(ri.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Kf(t,e){if(e<=0)throw new ii(ri.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Wf=function(t){this.c_=t},Yf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.u_=function(t){if(2!==t.a_)throw t.h_(1===t.a_?this.c_+"() can only appear at the top level of your update data":this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Wf);function Hf(t,e,n){return new $l({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.u_=function(t){return new Ns(t.path,new ms)},e.prototype.isEqual=function(t){return t instanceof e},e}(Wf),Xf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(M.c)(e,t),e.prototype.u_=function(t){var e=Hf(this,t,!0),n=this.f_.map(function(t){return rp(t,e)}),r=new ws(n);return new Ns(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Wf),$f=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(M.c)(e,t),e.prototype.u_=function(t){var e=Hf(this,t,!0),n=this.f_.map(function(t){return rp(t,e)}),r=new Is(n);return new Ns(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Wf),Jf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return Object(M.c)(e,t),e.prototype.u_=function(t){var e=new Es(t.serializer,Vo(t.serializer,this.d_));return new Ns(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Wf),Zf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ii(ri.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ii(ri.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return li(this.w_,t.w_)||li(this.E_,t.E_)},t}(),tl=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(Ci.fromBase64String(e))}catch(e){throw new ii(ri.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ci.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),el=new Map,nl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ii(ri.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ii(ri.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),rl=function(){function t(t,e){this.I_="(lite)",this.m_=new nl({}),this.A_=!1,t instanceof Wr?(this.R_=t,this.P_=new si):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ii(ri.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wr(t.options.projectId)}(t),this.P_=new ui(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new ii(ri.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new ii(ri.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new nl(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new si;switch(t.type){case"gapi":var e=t.client;return ei(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ci(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new ii(ri.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return function(t){var e=el.get(t);e&&(Xr("ComponentProvider","Removing Datastore"),el.delete(t),e.terminate())}(this),Promise.resolve()},t}();function il(){if("undefined"==typeof Uint8Array)throw new ii(ri.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ol(){if("undefined"==typeof atob)throw new ii(ri.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var sl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.fromBase64String=function(t){return ol(),new e(tl.fromBase64String(t))},e.fromUint8Array=function(t){return il(),new e(tl.fromUint8Array(t))},e.prototype.toBase64=function(){return ol(),this.o_.toBase64()},e.prototype.toUint8Array=function(){return il(),this.o_.toUint8Array()},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Lf),ul=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return jo(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Ao(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw ti()}},t.prototype.L_=function(t,e){var n=this,r={};return fo(t.fields||{},function(t,i){r[t]=n.C_(i,e)}),r},t.prototype.M_=function(t){return new Zf(jo(t.latitude),jo(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},t.prototype.x_=function(t,e){switch(e){case"previous":var n=vo(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(yo(t));default:return null}},t.prototype.N_=function(t){var e=To(t);return new vi(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=gi.Y(t);ei(ds(n));var r=new Wr(n.get(1),n.get(3)),i=new Oi(n.B(5));return r.isEqual(e)||$r("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),al=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(M.c)(e,t),e.prototype.F_=function(t){return new sl(new tl(t))},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return Rp.q_(e,this.firestore,null)},e}(ul),cl=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new jl(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new hl(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(fl("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),hl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(cl);function fl(t,e){return"string"==typeof e?cp(t,e):e instanceof Lf?e.o_.G_:e.G_}var ll=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new ii(ri.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new wi(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),pl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new ra,r.I_="name"in e?e.name:"[DEFAULT]",r}return Object(M.c)(e,t),e.prototype.D_=function(){return this.H_||Dp(this),this.H_.terminate()},e}(rl);function dl(t,e,n){var r=this,i=new Uu;return t.di.enqueue(function(){return Object(M.b)(r,void 0,void 0,function(){var r;return Object(M.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,vp(t,n)];case 1:return o.sent(),[4,yp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===ri.FAILED_PRECONDITION||t.code===ri.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function vl(t){if(t.y_||t.V_)throw new ii(ri.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var yl=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).U_=e,u.J_=e,u.metadata=o,u}return Object(M.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new bl(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(fl("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},e}(cl),bl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(yl),gl=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Vp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach(function(r){t.call(e,new bl(n.U_,n.Q_,r.key,r,new Vp(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new ii(ri.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map(function(e){return{type:"added",doc:new bl(t.U_,t.Q_,e.doc.key,e.doc,new Vp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),oldIndex:-1,newIndex:n++}})}var r=t.Y_.te;return t.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new bl(t.U_,t.Q_,e.doc.key,e.doc,new Vp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:ml(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Z_=e),this.X_},t}();function ml(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ti()}}function wl(t,e){return t instanceof yl&&e instanceof yl?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof gl&&e instanceof gl&&t.U_===e.U_&&Kl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Ol=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(M.c)(e,t),e.prototype.F_=function(t){return new tl(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new jl(this.firestore,null,e)},e}(ul);function Il(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Gf(t.firestore,pl),s=Wl(o);return e instanceof Lf&&(e=e.o_),El(o,("string"==typeof e||e instanceof ll?ep(s,"updateDoc",t.K_,e,n,r):tp(s,"updateDoc",t.K_,e)).ef(t.K_,Cs.exists(!0)))}function _l(t){for(var e,n,r,i=this,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];var u={includeMetadataChanges:!1},a=0;"object"!=typeof o[a]||Mu(o[a])||(u=o[a],a++);var c,h,f,l={includeMetadataChanges:u.includeMetadataChanges};if(Mu(o[a])){var p=o[a];o[a]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[a+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[a+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof jl)h=Gf(t.firestore,pl),f=eu(t.K_.path),c={next:function(e){o[a]&&o[a](Tl(h,t,e))},error:o[a+1],complete:o[a+2]};else{h=Gf(t.firestore,pl),f=t.tf;var d=new Ol(h);c={next:function(e){o[a]&&o[a](new gl(h,d,t,e))},error:o[a+1],complete:o[a+2]},Vl(t.tf)}var v=xp(h),y=new Uf(c),b=new Oh(f,y,l);return h.z_.Ri(function(){return Object(M.b)(i,void 0,void 0,function(){var t;return Object(M.d)(this,function(e){switch(e.label){case 0:return t=yh,[4,_p(v)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}})})}),function(){y.r_(),h.z_.Ri(function(){return Object(M.b)(i,void 0,void 0,function(){var t;return Object(M.d)(this,function(e){switch(e.label){case 0:return t=bh,[4,_p(v)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}})})})}}function El(t,e){return function(t,e){var n=this,r=new Uu;return t.di.Ri(function(){return Object(M.b)(n,void 0,void 0,function(){var n;return Object(M.d)(this,function(i){switch(i.label){case 0:return n=zh,[4,Ip(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(xp(t),e)}function Tl(t,e,n){var r=n.docs.get(e.K_),i=new Ol(t);return new yl(t,i,e.K_,r,new Vp(n.hasPendingWrites,n.fromCache),e.j_)}var jl=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ql(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),Al=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),Nl=function(){};function kl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.sf(t)}return t}var Cl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return Object(M.c)(e,t),e.prototype.sf=function(t){var e=Wl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new ii(ri.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Ll(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Ul(r,t,h[c]));u={arrayValue:{values:a}}}else u=Ul(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Ll(s,o),u=np(n,"where",s,"in"===o||"not-in"===o);var f=vu.create(i,o,u);return function(t,e){if(e.An()){var n=ou(t);if(null!==n&&!n.isEqual(e.field))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=iu(t);null!==r&&Ml(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new ii(ri.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Al(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new Zs(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},e}(Nl),xl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return Object(M.c)(e,t),e.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new ii(ri.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ii(ri.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Nu(e,n);return function(t,e){if(null===iu(t)){var n=ou(t);null!==n&&Ml(0,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new Al(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new Zs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},e}(Nl),Dl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return Object(M.c)(e,t),e.prototype.sf=function(t){return new Al(t.firestore,t.j_,cu(t.tf,this.hf,this.lf))},e}(Nl),Sl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(M.c)(e,t),e.prototype.sf=function(t){var e=Rl(t,this.type,this._f,this.ff);return new Al(t.firestore,t.j_,function(t,e){return new Zs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},e}(Nl),Pl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(M.c)(e,t),e.prototype.sf=function(t){var e=Rl(t,this.type,this._f,this.ff);return new Al(t.firestore,t.j_,function(t,e){return new Zs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},e}(Nl);function Rl(t,e,n,r){if(n[0]instanceof Lf&&(n[0]=n[0].o_),n[0]instanceof cl)return function(t,e,n,r,i){if(!r)throw new ii(ri.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=uu(t);s<u.length;s++){var a=u[s];if(a.field.tt())o.push(No(e,r.key));else{var c=r.field(a.field);if(po(c))throw new ii(ri.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new ii(ri.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Eu(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=Wl(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new ii(ri.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new ii(ri.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!su(t)&&-1!==c.indexOf("/"))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(gi.Y(c));if(!Oi.ot(h))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Oi(h);u.push(No(e,f))}else{var l=np(n,r,c);u.push(l)}}return new Eu(u,o)}(t.tf,t.firestore.R_,i,e,n,r)}function Ul(t,e,n){if(n instanceof Lf&&(n=n.o_),"string"==typeof n){if(""===n)throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!su(e)&&-1!==n.indexOf("/"))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(gi.Y(n));if(!Oi.ot(r))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return No(t,new Oi(r))}if(n instanceof jl)return No(t,n.K_);throw new ii(ri.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zf(n)+".")}function Ll(t,e){if(!Array.isArray(t)||0===t.length)throw new ii(ri.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ii(ri.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ml(t,e,n){if(!n.isEqual(e))throw new ii(ri.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Vl(t){if(ru(t)&&0===t.Tn.length)throw new ii(ri.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,eu(r))||this).firestore=e,i.nf=r,i.type="collection",i}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new jl(this.firestore,null,new Oi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.nf)},e}(Al);function Fl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Mf("collection","path",e),t instanceof rl){var i=gi.Y.apply(gi,Object(M.g)([e],n));return Bf(i),new ql(t,null,i)}if(!(t instanceof jl||t instanceof ql))throw new ii(ri.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=gi.Y.apply(gi,Object(M.g)([t.path],n)).child(gi.Y(e));return Bf(o),new ql(t.firestore,null,o)}function Bl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=fi.D()),Mf("doc","path",e),t instanceof rl){var i=gi.Y.apply(gi,Object(M.g)([e],n));return Ff(i),new jl(t,null,new Oi(i))}if(!(t instanceof jl||t instanceof ql))throw new ii(ri.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.nf.child(gi.Y.apply(gi,Object(M.g)([e],n)));return Ff(o),new jl(t.firestore,t instanceof ql?t.j_:null,new Oi(o))}var zl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(M.c)(e,t),e.prototype.F_=function(t){return new tl(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new jl(this.firestore,null,e)},e}(ul);function Gl(t,e){return(t instanceof jl||t instanceof ql)&&(e instanceof jl||e instanceof ql)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function Kl(t,e){return t instanceof Al&&e instanceof Al&&t.firestore===e.firestore&&hu(t.tf,e.tf)&&t.j_===e.j_}function Wl(t){var e=t.S_(),n=Lu(t.R_);return new Jl(t.R_,!!e.ignoreUndefinedProperties,n)}var Yl=/^__.*__$/,Hl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return n.push(null!==this.en?new Vs(t,this.data,this.en,e):new Ms(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Fs(t,this.fieldTransforms)),n},t}(),Ql=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new Vs(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new Fs(t,this.fieldTransforms)),n},t}();function Xl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ti()}}var $l=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return hp(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find(function(e){return t.j(e)})||void 0!==this.fieldTransforms.find(function(e){return t.j(e.field)})},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Xl(this.a_)&&Yl.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),Jl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Lu(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new $l({a_:t,methodName:e,l_:n,path:wi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Zl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);sp("Data must be an object, but it was:",s,r);var u,a,c=ip(r,s);if(o.merge)u=new As(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=up(e,l[f],n);if(!s.contains(p))throw new ii(ri.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");fp(h,p)||h.push(p)}u=new As(h),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new Hl(new Ws(c),u,a)}function tp(t,e,n,r){var i=t.Rf(1,e,n);sp("Data must be an object, but it was:",i,r);var o=[],s=new Ys;fo(r,function(t,r){var u=cp(e,t,n);r instanceof Lf&&(r=r.o_);var a=i.If(u);if(r instanceof Yf)o.push(u);else{var c=rp(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new As(o);return new Ql(s.hn(),u,i.fieldTransforms)}function ep(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[up(e,r,n)],a=[i];if(o.length%2!=0)throw new ii(ri.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(up(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ys,l=u.length-1;l>=0;--l)if(!fp(h,u[l])){var p=u[l],d=a[l];d instanceof Lf&&(d=d.o_);var v=s.If(p);if(d instanceof Yf)h.push(p);else{var y=rp(d,v);null!=y&&(h.push(p),f.set(p,y))}}var b=new As(h);return new Ql(f.hn(),b,s.fieldTransforms)}function np(t,e,n,r){return void 0===r&&(r=!1),rp(n,t.Rf(r?4:3,e))}function rp(t,e){if(t instanceof Lf&&(t=t.o_),op(t))return sp("Unsupported field value:",e,t),ip(t,e);if(t instanceof Wf)return function(t,e){if(!Xl(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=rp(o[i],e.mf(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Lf&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=vi.fromDate(t);return{timestampValue:qo(e.serializer,n)}}if(t instanceof vi){var r=new vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:qo(e.serializer,r)}}if(t instanceof Zf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof tl)return{bytesValue:Fo(e.serializer,t.T_)};if(t instanceof jl){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Go(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+zf(t))}(t,e)}function ip(t,e){var n={};return lo(t)?e.path&&e.path.length>0&&e.en.push(e.path):fo(t,function(t,r){var i=rp(r,e.Ef(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function op(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof vi||t instanceof Zf||t instanceof tl||t instanceof jl||t instanceof Wf)}function sp(t,e,n){if(!op(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=zf(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function up(t,e,n){if(e instanceof Lf&&(e=e.o_),e instanceof ll)return e.G_;if("string"==typeof e)return cp(t,e);throw hp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var ap=new RegExp("[~\\*/\\[\\]]");function cp(t,e,n){if(e.search(ap)>=0)throw hp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ll.bind.apply(ll,Object(M.g)([void 0],e.split("."))))).G_}catch(r){throw hp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function hp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new ii(ri.INVALID_ARGUMENT,(u+=". ")+t+a)}function fp(t,e){return t.some(function(t){return t.isEqual(e)})}var lp=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return Object(M.b)(this,void 0,void 0,function(){var e,n=this;return Object(M.d)(this,function(r){switch(r.label){case 0:if(this.vf(),this.mutations.length>0)throw new ii(ri.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(M.d)(this,function(a){switch(a.label){case 0:return n=ni(t),r=Xo(n.serializer)+"/documents",i={documents:e.map(function(t){return Wo(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){ei(!!e.found);var n=Yo(t,e.found.name),r=zo(e.found.updateTime),i=new Ws({mapValue:{fields:e.found.fields}});return new Xs(n,r,i,{})}(t,e):"missing"in e?function(t,e){ei(!!e.missing),ei(!!e.readTime);var n=Yo(t,e.missing),r=zo(e.readTime);return new $s(n,r)}(t,e):ti()}(n.serializer,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());ei(!!e),u.push(e)}),u)]}})})}(this.Nu,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof $s||t instanceof Xs?n.bf(t):ti()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new Gs(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return Object(M.b)(this,void 0,void 0,function(){var t,e=this;return Object(M.d)(this,function(n){switch(n.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Oi.st(n);e.mutations.push(new Ks(r,e.rn(r)))}),[4,function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r,i;return Object(M.d)(this,function(o){switch(o.label){case 0:return n=ni(t),r=Xo(n.serializer)+"/documents",i={writes:e.map(function(t){return Zo(n.serializer,t)})},[4,n.Au("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return n.sent(),this.gf=!0,[2]}})})},t.prototype.bf=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof $s))throw ti();e=yi.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ii(ri.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Cs.updateTime(e):Cs.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(yi.min()))throw new ii(ri.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cs.updateTime(e)}return Cs.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),pp=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Gu(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return Object(M.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(M.d)(this,function(r){return t=new lp(this.Nu),(e=this.Nf(t))&&e.then(function(e){n.di.Ri(function(){return t.commit().then(function(){n.Ti.resolve(e)}).catch(function(t){n.xf(t)})})}).catch(function(t){n.xf(t)}),[2]})})})},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!Ii(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ri(e)}return!1},t}(),dp=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Yr.UNAUTHENTICATED,this.clientId=fi.D(),this.Of=function(){},this.g=new Uu,this.credentials.A(function(t){Xr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}return t.prototype.getConfiguration=function(){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},t.prototype.kf=function(){if(this.di.Ci)throw new ii(ri.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new Uu;return this.di.Ni(function(){return Object(M.b)(t,void 0,void 0,function(){var t,n;return Object(M.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ia(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function vp(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r=this;return Object(M.d)(this,function(i){switch(i.label){case 0:return t.di.Li(),Xr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return Object(M.b)(r,void 0,void 0,function(){return Object(M.d)(this,function(t){switch(t.label){case 0:return[4,Tc(e.Cu,n)];case 1:return t.sent(),[2]}})})})}),e.persistence.tc(function(){return t.terminate()}),t.Lf=e,[2]}})})}function yp(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r;return Object(M.d)(this,function(i){switch(i.label){case 0:return t.di.Li(),[4,bp(t)];case 1:return n=i.sent(),Xr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return function(t,e){return Object(M.b)(this,void 0,void 0,function(){var n,r;return Object(M.d)(this,function(i){switch(i.label){case 0:return(n=ni(t)).di.Li(),Xr("RemoteStore","RemoteStore received new credentials"),r=$c(n),n.Mu.add(3),[4,Gc(n)];case 1:return i.sent(),r&&n.Bu.set("Unknown"),[4,n.xu.s_(e)];case 2:return i.sent(),n.Mu.delete(3),[4,zc(n)];case 3:return i.sent(),[2]}})})}(e.Oh,n)})}),t.$f=e,[2]}})})}function bp(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return t.Lf?[3,2]:(Xr("FirestoreClient","Using default OfflineComponentProvider"),[4,vp(t,new Df)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}})})}function gp(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return t.$f?[3,2]:(Xr("FirestoreClient","Using default OnlineComponentProvider"),[4,yp(t,new Rf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}})})}function mp(t){return bp(t).then(function(t){return t.persistence})}function wp(t){return bp(t).then(function(t){return t.Cu})}function Op(t){return gp(t).then(function(t){return t.Oh})}function Ip(t){return gp(t).then(function(t){return t.ga})}function _p(t){return Object(M.b)(this,void 0,void 0,function(){var e,n;return Object(M.d)(this,function(r){switch(r.label){case 0:return[4,gp(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ju=qh.bind(null,e.ga),n.Zu=Bh.bind(null,e.ga),n)]}})})}function Ep(t,e,n,r,i){var o=new Uf({next:function(o){e.Ri(function(){return bh(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new ii(ri.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new ii(ri.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Oh(eu(n.path),o,{includeMetadataChanges:!0,oa:!0});return yh(t,s)}function Tp(t,e,n,r,i){var o=new Uf({next:function(n){e.Ri(function(){return bh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new ii(ri.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Oh(n,o,{includeMetadataChanges:!0,oa:!0});return yh(t,s)}var jp=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=Wl(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=Ap(t,this.U_),i=Yp(r.j_,e,n),o=Zl(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,Cs.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,s=Ap(t,this.U_);return e instanceof Lf&&(e=e.o_),o="string"==typeof e||e instanceof ll?ep(this.Qf,"WriteBatch.update",s.K_,e,n,r):tp(this.Qf,"WriteBatch.update",s.K_,e),this.qf=this.qf.concat(o.ef(s.K_,Cs.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=Ap(t,this.U_);return this.qf=this.qf.concat(new Gs(e.K_,Cs.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new ii(ri.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Ap(t,e){if(t instanceof Lf&&(t=t.o_),t.firestore!==e)throw new ii(ri.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Np=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return Object(M.c)(e,t),e.prototype.get=function(e){var n=this,r=Ap(e,this.U_),i=new Ol(this.U_);return t.prototype.get.call(this,e).then(function(t){return new yl(n.U_,i,r.K_,t.W_,new Vp(!1,!1),r.j_)})},e}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=Wl(t)}return t.prototype.get=function(t){var e=this,n=Ap(t,this.U_),r=new zl(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return ti();var i=t[0];if(i instanceof $s)return new cl(e.U_,r,n.K_,null,n.j_);if(i instanceof Xs)return new cl(e.U_,r,i.key,i,n.j_);throw ti()})},t.prototype.set=function(t,e,n){var r=Ap(t,this.U_),i=Yp(r.j_,e,n),o=Zl(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Ap(t,this.U_);return e instanceof Lf&&(e=e.o_),o="string"==typeof e||e instanceof ll?ep(this.Qf,"Transaction.update",s.K_,e,n,r):tp(this.Qf,"Transaction.update",s.K_,e),this.Wf.update(s.K_,o),this},t.prototype.delete=function(t){var e=Ap(t,this.U_);return this.Wf.delete(e.K_),this},t}()),kp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){vl(t);var n=xp(t),r=t.S_(),i=new Rf;return dl(n,i,new Sf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){vl(t);var e=xp(t),n=t.S_(),r=new Rf;return dl(e,r,new Pf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.y_&&!t.V_)throw new ii(ri.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Uu;return t.z_.Ni(function(){return Object(M.b)(e,void 0,void 0,function(){var e;return Object(M.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(M.b)(this,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return Ku.Gs()?[4,Ku.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Ic(t.R_,t.I_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.o_)},t}(),Cp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Wr||(i.Gf=e),i}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Jr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(M.b)(e,void 0,void 0,function(){var e,n;return Object(M.d)(this,function(r){switch(r.label){case 0:return[4,mp(t)];case 1:return e=r.sent(),[4,Op(t)];case 2:return n=r.sent(),[2,(e.ec(!0),function(t){var e=ni(t);return e.Mu.delete(0),zc(e)}(n))]}})})})}(xp(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(M.b)(e,void 0,void 0,function(){var e,n;return Object(M.d)(this,function(r){switch(r.label){case 0:return[4,mp(t)];case 1:return e=r.sent(),[4,Op(t)];case 2:return n=r.sent(),[2,(e.ec(!1),function(t){return Object(M.b)(this,void 0,void 0,function(){var e;return Object(M.d)(this,function(n){switch(n.label){case 0:return(e=ni(t)).Mu.add(0),[4,Gc(e)];case 1:return n.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(xp(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&qf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Uu;return t.di.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){var e;return Object(M.d)(this,function(r){switch(r.label){case 0:return e=Qh,[4,Ip(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(xp(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=xp(t),i=Mu(e)?e:{next:e},o=new Uf(i);return t.z_.Ri(function(){return Object(M.b)(n,void 0,void 0,function(){var t;return Object(M.d)(this,function(e){switch(e.label){case 0:return t=function(t,e){ni(t).Hu.add(e),e.next()},[4,_p(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})}),function(){o.r_(),t.z_.Ri(function(){return Object(M.b)(n,void 0,void 0,function(){var t;return Object(M.d)(this,function(e){switch(e.label){case 0:return t=function(t,e){ni(t).Hu.delete(e)},[4,_p(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})})}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Gf)throw new ii(ri.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Kp(this,Fl(this.o_,t))}catch(t){throw Up(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Rp(this,Bl(this.o_,t))}catch(t){throw Up(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Bp(this,function(t,e){if(Mf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ii(ri.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Al(t,null,function(t){return new Zs(gi.X(),t)}(e))}(this.o_,t))}catch(t){throw Up(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Uu;return t.di.Ri(function(){return Object(M.b)(n,void 0,void 0,function(){var n;return Object(M.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return gp(t).then(function(t){return t.Nu})}(t)];case 1:return n=i.sent(),new pp(t.di,n,e,r).run(),[2]}})})}),r.promise}(xp(t),function(n){return e(new Np(t,n))})}(this.o_,function(n){return t(new Sp(e,n))})},e.prototype.batch=function(){var t=this;return xp(this.o_),new Pp(new jp(this.o_,function(e){return El(t.o_,e)}))},e}(Lf);function xp(t){return t.H_||Dp(t),t.H_.kf(),t.H_}function Dp(t){var e=t.S_(),n=function(t,e,n){return new Kr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new dp(t.P_,t.z_,n)}var Sp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(M.c)(e,t),e.prototype.get=function(t){var e=this,n=Wp(t);return this.o_.get(n).then(function(t){return new qp(e.U_,t)})},e.prototype.set=function(t,e,n){var r=Wp(t);return n?(Vf("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Wp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(M.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Wp(t);return this.o_.delete(e),this},e}(Lf),Pp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.set=function(t,e,n){var r=Wp(t);return n?(Vf("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Wp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(M.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Wp(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(Lf),Rp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new al(e),r}return Object(M.c)(e,t),e.zf=function(t,n,r){if(t.length%2!=0)throw new ii(ri.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new jl(n.o_,r,new Oi(t)))},e.q_=function(t,n,r){return new e(n,new jl(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Kp(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Kp(this.firestore,Fl(this.o_,t))}catch(t){throw Up(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Lf&&(t=t.o_),t instanceof jl&&Gl(this.o_,t)},e.prototype.set=function(t,e){e=Vf("DocumentReference.set",e);try{return function(t,e,n){var r=Gf(t.firestore,pl),i=Yp(t.j_,e,n);return El(r,Zl(Wl(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,Cs.on()))}(this.o_,t,e)}catch(t){throw Up(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Il(this.o_,t):Il.apply(void 0,Object(M.g)([this.o_,t,e],n))}catch(t){throw Up(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return El(Gf((t=this.o_).firestore,pl),[new Gs(t.K_,Cs.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Lp(e),i=Mp(e,function(e){return new qp(t.firestore,new yl(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))});return _l(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Ol(n),o=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,wp(r)];case 1:return[4,function(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o;return Object(M.d)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=ni(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)})}(t,e)];case 1:return(r=s.sent())instanceof Xs?n.resolve(r):r instanceof $s?n.resolve(null):n.reject(new ii(ri.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=ia(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}(e.sent(),t.K_,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new yl(n,i,t.K_,e,new Vp(e instanceof Xs&&e.an,!0),t.j_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,_p(r)];case 1:return[4,Ep(e.sent(),n.z_,t.K_,{source:"server"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return Tl(n,t,e)})}(this.o_):function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,_p(r)];case 1:return[4,Ep(e.sent(),n.z_,t.K_,{source:"default"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return Tl(n,t,e)})}(this.o_)).then(function(t){return new qp(e.firestore,new yl(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Lf);function Up(t,e,n){return t.message=t.message.replace(e,n),t}function Lp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Mu(r))return r}return{}}function Mp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Mu(t[0])?t[0]:Mu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Vp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),qp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Rp(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return wl(this.o_,t.o_)},e}(Lf),Fp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(qp),Bp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return Object(M.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,kl(this.o_,function(t,e,n){var r=e,i=fl("where",t);return new Cl(i,r,n)}(t,n,r)))}catch(t){throw Up(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,kl(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=fl("orderBy",t);return new xl(r,n)}(t,n)))}catch(t){throw Up(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,kl(this.o_,function(t){return Kf("limit",t),new Dl("limit",t,"F")}(t)))}catch(t){throw Up(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,kl(this.o_,function(t){return Kf("limitToLast",t),new Dl("limitToLast",t,"L")}(t)))}catch(t){throw Up(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sl("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw Up(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sl("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw Up(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pl("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw Up(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,kl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pl("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw Up(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Kl(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Ol(n),o=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,wp(r)];case 1:return[4,function(t,e,n){return Object(M.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(M.d)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,Dc(t,e,!0)];case 1:return r=c.sent(),i=new Uh(e,r.Bc),o=i.gh(r.documents),s=i.Zn(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=c.sent(),a=ia(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})}(e.sent(),t.tf,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new gl(n,i,t,e)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Ol(n),o=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,_p(r)];case 1:return[4,Tp(e.sent(),n.z_,t.tf,{source:"server"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new gl(n,i,t,e)})}(this.o_):function(t){var e=this,n=Gf(t.firestore,pl),r=xp(n),i=new Ol(n);Vl(t.tf);var o=new Uu;return n.z_.Ri(function(){return Object(M.b)(e,void 0,void 0,function(){return Object(M.d)(this,function(e){switch(e.label){case 0:return[4,_p(r)];case 1:return[4,Tp(e.sent(),n.z_,t.tf,{source:"default"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new gl(n,i,t,e)})}(this.o_)).then(function(t){return new Gp(e.firestore,t)})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Lp(e),i=Mp(e,function(e){return new Gp(t.firestore,e)});return _l(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Lf),zp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Fp(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(Lf),Gp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Bp(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new Fp(t.U_,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new zp(e.U_,t)})},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new Fp(n.U_,r))})},e.prototype.isEqual=function(t){return wl(this.o_,t.o_)},e}(Lf),Kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return Object(M.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Rp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Rp(this.firestore,void 0===t?Bl(this.o_):Bl(this.o_,t))}catch(t){throw Up(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Gf(t.firestore,pl),r=Bl(t),i=Yp(t.j_,e);return El(n,Zl(Wl(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,Cs.exists(!1))).then(function(){return r})}(this.o_,t).then(function(t){return new Rp(e.firestore,t)})},e.prototype.isEqual=function(t){return Gl(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Bp);function Wp(t){return t instanceof Lf&&(t=t.o_),Gf(t,jl)}function Yp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Hp,Qp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(ll.bind.apply(ll,Object(M.g)([void 0],e))))||this}return Object(M.c)(e,t),e.documentId=function(){return new e(wi.et().J())},e.prototype.isEqual=function(t){return t instanceof Lf&&(t=t.o_),t instanceof ll&&this.o_.G_.isEqual(t.G_)},e}(Lf),Xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.c)(e,t),e.serverTimestamp=function(){var t=new Qf("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Yf("deleteField");return t.c_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xf("arrayUnion",t)}).apply(void 0,t);return r.c_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $f("arrayRemove",t)}).apply(void 0,t);return r.c_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Jf("increment",t)}(t);return n.c_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(Lf),$p={Firestore:Cp,GeoPoint:Zf,Timestamp:vi,Blob:sl,Transaction:Sp,WriteBatch:Pp,DocumentReference:Rp,DocumentSnapshot:qp,Query:Bp,QueryDocumentSnapshot:Fp,QuerySnapshot:Gp,CollectionReference:Kp,FieldPath:Qp,FieldValue:Xp,setLogLevel:function(t){Hr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Gr.a("firestore",function(t){return function(t,e){return new Cp(t,new pl(t,e),new kp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},$p)))})(Hp=V.a),Hp.registerVersion("@firebase/firestore","2.0.4");var Jp=n("Jgta"),Zp=n("VRyK"),td=n("eIep"),ed=n("UXun"),nd=n("SxV6");const rd=new u.s("angularfire2.auth.use-emulator"),id=new u.s("angularfire2.auth.settings"),od=new u.s("angularfire2.auth.tenant-id"),sd=new u.s("angularfire2.auth.langugage-code"),ud=new u.s("angularfire2.auth.use-device-language"),ad=new u.s("angularfire.auth.persistence");let cd=(()=>{class t{constructor(t,e,i,s,u,a,c,h,f,l){const p=new L.d(s),d=Object(L.h)(p),v=new o.a,y=Object(D.a)(void 0).pipe(Object(U.b)(p.outsideAngular),Object(td.a)(()=>s.runOutsideAngular(()=>n.e(5).then(n.bind(null,"6nsN")))),Object(S.a)(()=>Object(L.g)(t,s,e)),Object(S.a)(t=>s.runOutsideAngular(()=>{const e=u,n=a;return Object(L.f)(t.name+".auth","AngularFireAuth",t,()=>{const r=s.runOutsideAngular(()=>t.auth());return e&&r.useEmulator("http://"+e.join(":")),c&&(r.tenantId=c),r.languageCode=h,f&&r.useDeviceLanguage(),n&&(r.settings=n),l&&r.setPersistence(l),r},[e,c,h,f,n,l])})),Object(ed.a)({bufferSize:1,refCount:!1}));return Object(r.u)(i)?this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(D.a)(null):(y.pipe(Object(nd.a)()).subscribe(),this.authState=y.pipe(Object(td.a)(t=>t.getRedirectResult().then(()=>t,()=>t)),Object(td.a)(t=>s.runOutsideAngular(()=>new C.a(t.onAuthStateChanged.bind(t)))),d,Object(ed.a)(1)),this.user=y.pipe(Object(td.a)(t=>t.getRedirectResult().then(()=>t,()=>t)),Object(td.a)(t=>s.runOutsideAngular(()=>new C.a(t.onIdTokenChanged.bind(t)))),d,Object(ed.a)(1)),this.idToken=this.user.pipe(Object(td.a)(t=>t?Object(x.a)(t.getIdToken()):Object(D.a)(null))),this.idTokenResult=this.user.pipe(Object(td.a)(t=>t?Object(x.a)(t.getIdTokenResult()):Object(D.a)(null))),this.credential=y.pipe(Object(td.a)(t=>Object(Zp.a)(t.getRedirectResult().then(t=>t,()=>null),v,this.authState.pipe(Object(R.a)(t=>!t)))),Object(S.a)(t=>(null==t?void 0:t.user)?t:null),d,Object(ed.a)(1))),Object(L.i)(this,y,s,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>v.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(L.c),u.Yb(L.b,8),u.Yb(u.D),u.Yb(u.B),u.Yb(rd,8),u.Yb(id,8),u.Yb(od,8),u.Yb(sd,8),u.Yb(ud,8),u.Yb(ad,8))},t.\u0275prov=Object(u.Kb)({factory:function(){return new t(Object(u.Yb)(L.c),Object(u.Yb)(L.b,8),Object(u.Yb)(u.D),Object(u.Yb)(u.B),Object(u.Yb)(rd,8),Object(u.Yb)(id,8),Object(u.Yb)(od,8),Object(u.Yb)(sd,8),Object(u.Yb)(ud,8),Object(u.Yb)(ad,8))},token:t,providedIn:"any"}),t})();function hd(t,e){return function(t,e=k.b){return new C.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function fd(t,e){return hd(t,e).pipe(Object(S.a)(t=>({payload:t,type:"query"})))}function ld(t,e){return fd(t,e).pipe(Object(S.a)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function pd(t,e,n){return fd(t,n).pipe(Object(S.a)(t=>t.payload.docChanges()),Object(P.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),Object(S.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function dd(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}Object(L.e)(cd,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);class vd{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?ld(this.query,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(R.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):ld(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(P.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=dd(t);return pd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return fd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(x.a)(this.query.get(t)).pipe(Object(U.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new yd(this.ref.doc(t),this.afs)}}class yd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=Id(n,e);return new vd(r,i,this.afs)}snapshotChanges(){return hd(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(S.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(x.a)(this.ref.get(t)).pipe(Object(U.b)(this.afs.schedulers.insideAngular))}}class bd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?ld(this.query,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(R.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):ld(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(P.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=dd(t);return pd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return fd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(x.a)(this.query.get(t)).pipe(Object(U.b)(this.afs.schedulers.insideAngular))}}const gd=new u.s("angularfire2.enableFirestorePersistence"),md=new u.s("angularfire2.firestore.persistenceSettings"),wd=new u.s("angularfire2.firestore.settings"),Od=new u.s("angularfire2.firestore.use-emulator");function Id(t,e=(t=>t)){return{query:e(t),ref:t}}let _d=(()=>{class t{constructor(t,e,n,i,o,s,u,a,c){this.schedulers=new L.d(s),this.keepUnstableUntilFirst=Object(L.h)(this.schedulers);const h=Object(L.g)(t,s,e);!Jp.a.auth&&c&&Object(L.j)();const f=a;[this.firestore,this.persistenceEnabled$]=Object(L.f)(h.name+".firestore","AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),f&&t.useEmulator(...f),n&&!Object(r.u)(o)){const e=()=>{try{return Object(x.a)(t.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(e){return"undefined"!=typeof console&&console.warn(e),Object(D.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(D.a)(!1)]},[i,f,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=Id(n,e),o=this.schedulers.ngZone.run(()=>r);return new vd(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new bd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new yd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(L.c),u.Yb(L.b,8),u.Yb(gd,8),u.Yb(wd,8),u.Yb(u.D),u.Yb(u.B),u.Yb(md,8),u.Yb(Od,8),u.Yb(rd,8))},t.\u0275prov=Object(u.Kb)({factory:function(){return new t(Object(u.Yb)(L.c),Object(u.Yb)(L.b,8),Object(u.Yb)(gd,8),Object(u.Yb)(wd,8),Object(u.Yb)(u.D),Object(u.Yb)(u.B),Object(u.Yb)(md,8),Object(u.Yb)(Od,8),Object(u.Yb)(rd,8))},token:t,providedIn:"any"}),t})(),Ed=(()=>{class t{constructor(t,e){this.afs=t,this.store=e}createDocument(t,e){return this.afs.doc(e).set(t)}createDocId(){return this.afs.createId()}updatePartialDocument(t,e){return this.afs.doc(e).update(t.changes)}readCollections(t){return this.afs.collection(t).ref.orderBy("dateCreated").get()}addNewIssue(t,e){this.store.dispatch(p({data:t,url:e}))}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(_d),u.Yb(h.h))},t.\u0275prov=u.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Td=n("Wp6s"),jd=n("ihCf"),Ad=n("QibW");function Nd(t,e){if(1&t&&(u.Ub(0,"mat-radio-button",17),u.Ub(1,"span",18),u.Bc(2),u.Tb(),u.Tb()),2&t){const t=e.$implicit;u.kc("value",t),u.Cb(2),u.Cc(t.display)}}function kd(t,e){if(1&t){const t=u.Vb();u.Ub(0,"button",19),u.bc("click",function(){return u.rc(t),u.fc().onFormReset()}),u.Bc(1,"Reset"),u.Tb()}}let Cd=(()=>{class t{constructor(t,e,n,r){this.fb=t,this.cs=e,this.router=n,this.route=r,this.priorityList=N,this.issueFg=new T.g({}),this.formInitValue={id:"testId",title:"Test Title",description:"Test Desc",priority:{id:j.Low,display:"Low"},created:!1,loading:!1}}ngOnInit(){this.createIssueFg(this.formInitValue)}createIssueFg(t){if(this.issueFg=this.fb.group({id:A(null,!1),title:A(null,!1,[T.q.required]),description:A(null,!1,[T.q.required]),dateCreated:A(null,!1),lastEdited:A(null,!1),priority:A(this.priorityList[1],!1,[T.q.required]),author:A("Tester",!1),reactions:A(null,!1)}),t){const e=this.priorityList.find(e=>{var n;return e.id===(null===(n=t.priority)||void 0===n?void 0:n.id)});this.issueFg.patchValue(Object.assign(Object.assign({},t),{priority:e}))}}onFormReset(){this.createIssueFg(this.formInitValue)}onSubmit(){if(this.issueFg.valid){const t=this.createFullIssueObject(this.issueFg.value);this.cs.addNewIssue(t,"issues/"+t.id)}}createFullIssueObject(t){return Object.assign(Object.assign({},t),{dateCreated:(new Date).getTime(),id:this.cs.createDocId(),created:!1,loading:!0})}onIssueCancel(){this.router.navigate(["./"])}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(u.Ob(T.d),u.Ob(Ed),u.Ob(i.f),u.Ob(i.a))},t.\u0275cmp=u.Ib({type:t,selectors:[["app-core-issue-creator"]],decls:29,vars:7,consts:[[1,"creator-card"],["mat-card-avatar","",1,"creator-header-image"],[1,"if","f-w-700"],[1,"title-parent"],["mat-stroked-button","",3,"click"],[1,"mt-2"],[1,"issue-form",3,"formGroup"],[1,"full-w"],["matInput","","placeholder","Add NgRx to app...","formControlName","title"],["align","end"],[1,"full-w","mb-2"],["matInput","","placeholder","Install latest NgRx...","cdkTextareaAutosize","","formControlName","description",3,"cdkTextareaAutosize","cdkAutosizeMinRows"],["formControlName","priority",1,"priority-radio"],["color","primary",3,"value",4,"ngFor","ngForOf"],[1,"actions"],["mat-flat-button","","color","primary",1,"neko","fs-18",3,"disabled","click"],["mat-stroked-button","","class","neko fs-18",3,"click",4,"ngIf"],["color","primary",3,"value"],[1,"priority-val"],["mat-stroked-button","",1,"neko","fs-18",3,"click"]],template:function(t,e){1&t&&(u.Ub(0,"mat-card",0),u.Ub(1,"mat-card-header"),u.Pb(2,"div",1),u.Ub(3,"mat-card-title",2),u.Ub(4,"div",3),u.Ub(5,"div"),u.Bc(6),u.Tb(),u.Ub(7,"div"),u.Ub(8,"button",4),u.bc("click",function(){return e.onIssueCancel()}),u.Bc(9,"Cancel"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(10,"mat-card-content",5),u.Ub(11,"div"),u.Ub(12,"form",6),u.Ub(13,"mat-form-field",7),u.Ub(14,"mat-label"),u.Bc(15,"Title"),u.Tb(),u.Pb(16,"input",8),u.Ub(17,"mat-hint",9),u.Bc(18,"0 / 256"),u.Tb(),u.Tb(),u.Ub(19,"mat-form-field",10),u.Ub(20,"mat-label"),u.Bc(21,"Description"),u.Tb(),u.Pb(22,"textarea",11),u.Tb(),u.Ub(23,"mat-radio-group",12),u.Ac(24,Nd,3,2,"mat-radio-button",13),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(25,"mat-card-actions",14),u.Ub(26,"button",15),u.bc("click",function(){return e.onSubmit()}),u.Bc(27,"Submit new issue"),u.Tb(),u.Ac(28,kd,2,0,"button",16),u.Tb(),u.Tb()),2&t&&(u.Cb(6),u.Dc(" Add Issue ",e.issueFg.pristine?"":"*"," "),u.Cb(6),u.kc("formGroup",e.issueFg),u.Cb(10),u.kc("cdkTextareaAutosize",!0)("cdkAutosizeMinRows",3),u.Cb(2),u.kc("ngForOf",e.priorityList),u.Cb(2),u.kc("disabled",e.issueFg.invalid),u.Cb(2),u.kc("ngIf",!e.issueFg.pristine))},directives:[Td.a,Td.e,Td.c,Td.g,I.a,Td.d,T.r,T.n,T.h,w.b,w.f,O.b,T.c,T.m,T.f,w.e,jd.b,Ad.b,r.j,Td.b,r.k,Ad.a],styles:[".creator-card[_ngcontent-%COMP%]{max-width:700px}.creator-header-image[_ngcontent-%COMP%]{background-image:url(/assets/banner/resolved.png);background-size:95%;background-repeat:no-repeat}.issue-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.mat-radio-button[_ngcontent-%COMP%] ~ .mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.priority-val[_ngcontent-%COMP%]{font-family:Nerko One,cursive;font-size:19px;color:#999}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:19px}.title-parent[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),t})();function xd(t,e){1&t&&u.Pb(0,"app-core-issue-creator")}const Dd=[{path:"",component:(()=>{class t{constructor(t,e,n){this.cs=t,this.router=e,this.route=n,this.compDest$=new o.a,this.showIssueCreatePane=!1}ngOnInit(){this.cs.getQueryParamById$.pipe(Object(s.a)(this.compDest$)).subscribe(t=>{this.showIssueCreatePane=!!t})}onSearch(){}onNewIssue(){this.router.navigate(["./"],{queryParams:{newIssuePane:"open"}})}ngOnDestroy(){this.compDest$.next(),this.compDest$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Ob(m),u.Ob(i.f),u.Ob(i.a))},t.\u0275cmp=u.Ib({type:t,selectors:[["app-core"]],decls:19,vars:1,consts:[[1,"container","mb-3"],[1,"row","my-3","py-1"],[1,"col-sm-12","actions"],[1,"input-parent"],["matInput","","placeholder","NgRx upgrade"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"],[1,"btn-parent"],["mat-flat-button","",1,"issue",3,"click"],[1,"row","mb-3"],[1,"col-sm-12"],[4,"ngIf"]],template:function(t,e){1&t&&(u.Ub(0,"div",0),u.Ub(1,"div",1),u.Ub(2,"div",2),u.Ub(3,"div",3),u.Ub(4,"mat-form-field"),u.Ub(5,"mat-label"),u.Bc(6,"Search issues.."),u.Tb(),u.Pb(7,"input",4),u.Ub(8,"button",5),u.bc("click",function(){return e.onSearch()}),u.Ub(9,"mat-icon"),u.Bc(10,"search"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(11,"div",6),u.Ub(12,"div"),u.Ub(13,"button",7),u.bc("click",function(){return e.onNewIssue()}),u.Bc(14,"New issue"),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(15,"div",8),u.Ub(16,"div",9),u.Ac(17,xd,1,0,"app-core-issue-creator",10),u.Tb(),u.Tb(),u.Pb(18,"app-core-issue-display"),u.Tb()),2&t&&(u.Cb(17),u.kc("ngIf",e.showIssueCreatePane))},directives:[w.b,w.f,O.b,I.a,w.g,_.a,r.k,E,Cd],styles:[".row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.actions[_ngcontent-%COMP%]   .btn-parent[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-form-field[_ngcontent-%COMP%]{width:100%}.input-parent[_ngcontent-%COMP%]{min-width:500px}button.issue[_ngcontent-%COMP%]{background-color:#2ea44f;color:#fff}"]}),t})()}];let Sd=(()=>{class t{}return t.\u0275mod=u.Mb({type:t}),t.\u0275inj=u.Lb({factory:function(e){return new(e||t)},imports:[[i.i.forChild(Dd)],i.i]}),t})();var Pd=n("oJm8");const Rd={EntitiesOnly:0,Both:1,None:2};function Ud(t){return function(e,n){const r={ids:[...n.ids],entities:Object.assign({},n.entities)},i=t(e,r);return i===Rd.Both?Object.assign({},n,r):i===Rd.EntitiesOnly?Object.assign(Object.assign({},n),{entities:r.entities}):n}}function Ld(t,e){const n=e(t);return Object(u.Y)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),n}function Md(t){function e(e,n){const r=Ld(e,t);return r in n.entities?Rd.None:(n.ids.push(r),n.entities[r]=e,Rd.Both)}function n(t,n){let r=!1;for(const i of t)r=e(i,n)!==Rd.None||r;return r?Rd.Both:Rd.None}function r(t,e){return e.ids=[],e.entities={},n(t,e),Rd.Both}function i(t,e){const n=(t instanceof Array?t:e.ids.filter(n=>t(e.entities[n]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return n&&(e.ids=e.ids.filter(t=>t in e.entities)),n?Rd.Both:Rd.None}function o(t,e){return s([t],e)}function s(e,n){const r={};return(e=e.filter(t=>t.id in n.entities)).length>0?e.filter(e=>function(e,n,r){const i=Object.assign({},r.entities[n.id],n.changes),o=Ld(i,t),s=o!==n.id;return s&&(e[n.id]=o,delete r.entities[n.id]),r.entities[o]=i,s}(r,e,n)).length>0?(n.ids=n.ids.map(t=>r[t]||t),Rd.Both):Rd.EntitiesOnly:Rd.None}function u(e,r){const i=[],o=[];for(const n of e){const e=Ld(n,t);e in r.entities?o.push({id:e,changes:n}):i.push(n)}const u=s(o,r),a=n(i,r);switch(!0){case a===Rd.None&&u===Rd.None:return Rd.None;case a===Rd.Both||u===Rd.Both:return Rd.Both;default:return Rd.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:Ud(e),addMany:Ud(n),addAll:Ud(r),setAll:Ud(r),setOne:Ud(function(e,n){const r=Ld(e,t);return r in n.entities?(n.entities[r]=e,Rd.EntitiesOnly):(n.ids.push(r),n.entities[r]=e,Rd.Both)}),updateOne:Ud(o),updateMany:Ud(s),upsertOne:Ud(function(t,e){return u([t],e)}),upsertMany:Ud(u),removeOne:Ud(function(t,e){return i([t],e)}),removeMany:Ud(i),map:Ud(function(t,e){return s(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]).filter(({id:t})=>t in e.entities),e)}),mapOne:Ud(function({map:t,id:e},n){const r=n.entities[e];return r?o({id:e,changes:t(r)},n):Rd.None})}}Rd[Rd.EntitiesOnly]="EntitiesOnly",Rd[Rd.Both]="Both",Rd[Rd.None]="None";const Vd=function(t={}){const{selectId:e,sortComparer:n}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),r={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},i={getSelectors:function(t){const e=t=>t.ids,n=t=>t.entities,r=Object(h.q)(e,n,(t,e)=>t.map(t=>e[t])),i=Object(h.q)(e,t=>t.length);return t?{selectIds:Object(h.q)(t,e),selectEntities:Object(h.q)(t,n),selectAll:Object(h.q)(t,r),selectTotal:Object(h.q)(t,i)}:{selectIds:e,selectEntities:n,selectAll:r,selectTotal:i}}},o=n?function(t,e){const{removeOne:n,removeMany:r,removeAll:i}=Md(t);function o(t,e){return s([t],e)}function s(e,n){const r=e.filter(e=>!(Ld(e,t)in n.entities));return 0===r.length?Rd.None:(f(r,n),Rd.Both)}function u(t,e){return e.entities={},e.ids=[],s(t,e),Rd.Both}function a(t,e){return c([t],e)}function c(e,n){const r=[],i=e.filter(e=>function(e,n,r){if(!(n.id in r.entities))return!1;const i=Object.assign({},r.entities[n.id],n.changes),o=Ld(i,t);return delete r.entities[n.id],e.push(i),o!==n.id}(r,e,n)).length>0;if(0===r.length)return Rd.None;{const t=n.ids,e=[];return n.ids=n.ids.filter((t,r)=>t in n.entities||(e.push(r),!1)),f(r,n),!i&&e.every(e=>n.ids[e]===t[e])?Rd.EntitiesOnly:Rd.Both}}function h(e,n){const r=[],i=[];for(const s of e){const e=Ld(s,t);e in n.entities?i.push({id:e,changes:s}):r.push(s)}const o=c(i,n),u=s(r,n);switch(!0){case u===Rd.None&&o===Rd.None:return Rd.None;case u===Rd.Both||o===Rd.Both:return Rd.Both;default:return Rd.EntitiesOnly}}function f(n,r){n.sort(e);const i=[];let o=0,s=0;for(;o<n.length&&s<r.ids.length;){const u=n[o],a=Ld(u,t),c=r.ids[s];e(u,r.entities[c])<=0?(i.push(a),o++):(i.push(c),s++)}r.ids=i.concat(o<n.length?n.slice(o).map(t):r.ids.slice(s)),n.forEach((e,n)=>{r.entities[t(e)]=e})}return{removeOne:n,removeMany:r,removeAll:i,addOne:Ud(o),updateOne:Ud(a),upsertOne:Ud(function(t,e){return h([t],e)}),addAll:Ud(u),setAll:Ud(u),setOne:Ud(function(e,n){const r=Ld(e,t);return r in n.entities?(n.ids=n.ids.filter(t=>t!==r),f([e],n),Rd.Both):o(e,n)}),addMany:Ud(s),updateMany:Ud(c),upsertMany:Ud(h),map:Ud(function(t,e){return c(e.ids.reduce((n,r)=>{const i=t(e.entities[r]);return i!==e.entities[r]&&n.push({id:r,changes:i}),n},[]),e)}),mapOne:Ud(function({map:t,id:e},n){const r=n.entities[e];return r?a({id:e,changes:t(r)},n):Rd.None})}}(e,n):Md(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:n},r),i),o)}({selectId:function(t){return t.id},sortComparer:function(t,e){return t.dateCreated&&e.dateCreated?t.dateCreated>e.dateCreated?1:-1:1}}),qd=Vd.getInitialState({loading:!1,fbError:!1}),Fd=Object(h.p)(qd,Object(h.r)(p,(t,{data:e})=>Vd.addOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(h.r)(d,(t,{data:e})=>Vd.updateOne(e,Object.assign(Object.assign({},t),{loading:!0,fbError:!1,fbErrorMsg:null}))),Object(h.r)(v,(t,{data:e,errMsg:n})=>Vd.removeOne(e.id,Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:n}))),Object(h.r)(y,t=>Object.assign(Object.assign({},t),{loading:!1,fbError:!1,fbErrorMsg:null})),Object(h.r)(b,(t,{errorMsg:e})=>Object.assign(Object.assign({},t),{loading:!1,fbError:!0,fbErrorMsg:e})));function Bd(t,e){return Fd(t,e)}var zd=n("9jGm"),Gd=n("5+tZ"),Kd=n("vkgz");function Wd(t){return t?function(t){let e="Server error occured.";switch(t.code){case"auth/email-already-in-use":e="Email already exists.";break;case"auth/invalid-email":e="Email is invalid.";break;case"auth/operation-not-allowed":e="This operation is currently not allowed.";break;case"auth/weak-password":e="Password is too weak, try 6+ characters.";break;case"auth/user-not-found":e="User does not exist.";break;case"auth/wrong-password":e="Invalid password.";break;case"permission-denied":e="You do not have the permission to take this action.";break;case"":e="BLAH."}return e+" "+t.message}(t):"Server error occured, but could not get a detailed message from backend."}var Yd=n("5eHb"),Hd=n("dNgK");let Qd=(()=>{class t{constructor(t,e){this.ts=t,this._snackBar=e,this.horizontalPosition="start",this.verticalPosition="bottom"}getSuccess(t,e,n){n&&this.clearAll(),this.ts.success(t,"Success")}getError(t){this.ts.error(t,"Error occured")}getInfo(t){this.ts.info(t,"Info")}getSnackbar(t,e){"."!==t.slice(-1)&&(t+="."),this.openSnackBar(t,e)}clearAll(){this.ts.clear()}openSnackBar(t,e=3e3){this._snackBar.open(t,"",{duration:e,panelClass:"app-snackbar",horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(Yd.b),u.Yb(Hd.a))},t.\u0275prov=u.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Xd=[(()=>{class t{constructor(t,e,n){this.actions$=t,this.ts=e,this.cs=n,this.onAddIssue$=Object(zd.c)(()=>this.actions$.pipe(Object(zd.d)(p),Object(Gd.a)(t=>{const e=t.data,n=t.url;return this.cs.createDocument(e,n).then(t=>{const r=(new Date).getTime();return d({data:{id:e.id,changes:{created:!0,loading:!1}},dateFinished:r,url:n})},t=>{console.log("err: ",t);const n=Wd(t);return v({errMsg:n,data:e})})}))),this.onSuccessfullyIssueAdded$=Object(zd.c)(()=>this.actions$.pipe(Object(zd.d)(d),Object(Gd.a)(t=>this.cs.updatePartialDocument(t.data,t.url).then(t=>y(),t=>{const e=Wd(t);return b({errorMsg:e})})))),this.loadAllIssues$=Object(zd.c)(()=>this.actions$.pipe(Object(zd.d)(g),Object(S.a)(t=>this.cs.readCollections(t.url).then(t=>{console.log(t.docs),t.docs.forEach(t=>{console.log(t.data())})},t=>{}))),{dispatch:!1}),this.onSuccessfullyCleanup$=Object(zd.c)(()=>this.actions$.pipe(Object(zd.d)(y),Object(Kd.a)(()=>{this.ts.getSnackbar("Issue created successfully!")})),{dispatch:!1}),this.onFailedCleanup$=Object(zd.c)(()=>this.actions$.pipe(Object(zd.d)(b),Object(Kd.a)(()=>{this.ts.getSnackbar("Error occured creating the issue!")})),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(u.Yb(zd.a),u.Yb(Qd),u.Yb(Ed))},t.\u0275prov=u.Kb({token:t,factory:t.\u0275fac}),t})()];let $d=(()=>{class t{}return t.\u0275mod=u.Mb({type:t}),t.\u0275inj=u.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c,T.p,T.i,Sd,Pd.a,h.j.forFeature("issues",Bd),zd.b.forFeature(Xd)]]}),t})()}}]);