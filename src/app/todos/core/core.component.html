<div fxLayout="column" fxLayoutGap="15px" fxLayoutAlign="start start" class="mt-3">
  <div class="title">
    Todo List with optimistic state update
  </div>

  <div class="w-100">
    <ng-container *ngIf="((this.ts.isLoading$ | async) === false); else isLoading">
      <ng-container *ngIf="(this.ts.allTodoItems$ | async) as todoItems">
        <mat-selection-list #todoList (selectionChange)="onSelectionChange($event)">

          <div fxLayout="row" fxLayoutGap="15px" fxLayoutAlign="start center" class="action-row">
            <div class="toggle-all">
              <mat-checkbox [color]="'accent'"
                [checked]="!!(this.ts.isToggleAllChecked$ | async)"
                [indeterminate]="(this.ts.isToggleIndeterminate$ | async)"
                (change)="onToggleAllChange($event)">
              </mat-checkbox>
            </div>

            <button mat-button>Refresh</button>
            <button mat-button>Mark as done</button>
            <button mat-button>Delete</button>
          </div>

          <hr>

          <ng-container *ngFor="let item of todoItems; trackBy: trackByFn">
            <div fxLayout="row" fxLayoutAlign="start center" class="mb-2">
              <mat-list-option [selected]="((this.ts.isItemSelectedById(item.id)) | async)"
                [checkboxPosition]="'before'" [color]="'primary'" [value]="item">
              </mat-list-option>
              <div fxLayout="column" fxLayoutAlign="center start">
                <div>
                  {{item.title}}
                </div>
                <div class="text-muted">
                  {{item.dateCreated}}
                </div>
              </div>
            </div>
          </ng-container>

        </mat-selection-list>
      </ng-container>
    </ng-container>
  </div>
</div>

<ng-template #isLoading>
  <div class="my-5">
    <app-shared-loading></app-shared-loading>
  </div>
</ng-template>
